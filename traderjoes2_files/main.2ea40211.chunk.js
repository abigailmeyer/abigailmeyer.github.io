(this["webpackJsonpfrictionless-web"]=this["webpackJsonpfrictionless-web"]||[]).push([[0],{189:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,i,o=n(83),s=w(n(15)),l=w(n(31)),c=w(n(35)),u=n(54),d=w(n(14)),h=w(n(0)),f=n(55);function p(e){return(p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){return e&&e.__esModule?e:{default:e}}var x={"cs-CZ":w(n(96)).default,"da-DK":w(n(97)).default,"de-DE":w(n(98)).default,"en-US":w(n(99)).default,"es-ES":w(n(100)).default,"fi-FI":w(n(101)).default,"fr-FR":w(n(102)).default,"hu-HU":w(n(103)).default,"it-IT":w(n(104)).default,"ja-JP":w(n(105)).default,"ko-KR":w(n(106)).default,"nb-NO":w(n(107)).default,"nl-NL":w(n(108)).default,"pl-PL":w(n(109)).default,"pt-BR":w(n(110)).default,"ru-RU":w(n(111)).default,"sv-SE":w(n(112)).default,"tr-TR":w(n(113)).default,"uk-UA":w(n(114)).default,"zh-CN":w(n(115)).default,"zh-TW":w(n(116)).default};n(168),n(536),n(169),n(537),n(170);(0,u.messageFormatter)(x);var k=(0,l.default)((i=r=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=g(t).call(this,e),n=!r||"object"!==p(r)&&"function"!==typeof r?b(a):r,E(b(n),"state",{startValueS:null,startValueV:null,draggingHandle:null,focusedHandle:null,channelMin:0,channelMax:100,channelStepSize:1}),E(b(n),"onPointerDown",(function(e,t){t?e.stopPropagation():t="startHandleS";var a=n.keyControlInput;a&&a.focus(),e.persist(),n.setState({sliderHandle:null,isMouseUp:!1,draggingHandle:t},(function(){return n.onPointerMove(e)})),window.addEventListener("pointerup",n.onPointerUp),window.addEventListener("pointermove",n.onPointerMove),document.body.classList.add(n.isDraggedBodyClassName)})),E(b(n),"onPointerUp",(function(e){var t=n.state.draggingHandle,a=t&&n[t+"Input"];a&&a.blur(),a=n.keyControlInput,n.setState({isMouseUp:!0,draggingHandle:null},(function(){a&&a.focus()})),n.props.onChangeEnd&&n.props.onChangeEnd(n.state.startValueS,n.state.startValueV),window.removeEventListener("pointerup",n.onPointerUp),window.removeEventListener("pointermove",n.onPointerMove),document.body.classList.remove(n.isDraggedBodyClassName)})),E(b(n),"calculateHandlePosition",(function(e,t){var a=n.props,r=n.state.channelMin,i=n.state.channelMax,s=a.step,l=n.dom.getBoundingClientRect(),c=t?l.top:l.left,u=((t?e.clientY:e.clientX)-c)/(t?l.height:l.width);u=(0,o.clamp)(u,0,1),t&&(u=1-u);var d=r+(i-r)*u;return t&&(d=i-d),s&&(d=Math.round(d/s)*s),d})),E(b(n),"onPointerMove",(function(e){e.preventDefault();var t=n.calculateHandlePosition(e,!1),a=n.calculateHandlePosition(e,!0);n.updateValues(t,a,"startHandle")})),E(b(n),"updateValues",(function(e,t){var a=n.props,r=n.state.channelMin,i=n.state.channelMax,s=n.state.channelStepSize,l=a.onChange;if(null!=e&&(e=(0,o.snapValueToStep)(e,r,i,s)),null!=t&&(t=i-(0,o.snapValueToStep)(t,r,i,s)),l&&(e!==n.state.startValueS||t!==n.state.startValueV)){var c=null!=e&&e!==n.state.startValueS?e:n.state.startValueS,u=null!=t&&t!==n.state.startValueV?t:n.state.startValueV;l(c,u)}})),E(b(n),"onChange",(function(e,t){var a=n.props,r=(a.step,a.variant,n.state),i=r.startValueS,o=r.startValueV,s="startHandle"===t,l=+e.target.value;s&&l!==i?n.updateValues(l,null,t):s||l===o||n.updateValues(null,l,t)})),E(b(n),"onKeyDown",(function(e,t){n.props;var a,r,i=n.state.channelMin,s=n.state.channelMax,l=n.state.channelStepSize;switch(e.keyCode){case 37:if(e.preventDefault(),n.state.startValueS==i)return;a=(0,o.snapValueToStep)(this.state.startValueS-l,i,s,l),n.updateValues(a);break;case 39:if(e.preventDefault(),n.state.startValueS==s)return;a=(0,o.snapValueToStep)(this.state.startValueS+l,i,s,l),n.updateValues(a);break;case 38:case 36:case 33:if(e.preventDefault(),n.state.startValueV==s)return;r=s-(0,o.snapValueToStep)(this.state.startValueV+l,i,s,l),n.updateValues(null,r,null);break;case 40:case 34:case 35:if(e.preventDefault(),n.state.startValueV==i)return;r=s-(0,o.snapValueToStep)(this.state.startValueV-l,i,s,l),n.updateValues(null,r,null)}})),E(b(n),"onFocus",(function(e,t){n.setState({focusedHandle:n.state.isMouseUp?null:"keyControl",topHandle:t,isMouseUp:!1})})),E(b(n),"onBlur",(function(e,t){n.setState({focusedHandle:null})})),E(b(n),"getAriaLabelledby",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=n.props,a=t.label,r=t["aria-labelledby"],i=t["aria-label"],o=[];return r&&o.push(r),(a||i)&&o.push(n.getLabelId()),e&&o.push(n.getSliderHandleInputId(e)),o.join(" ")})),E(b(n),"renderSliderHandle",(function(){var e=n.props,t=e.disabled,a=(e.variant,e["aria-label"]),r=e["aria-describedby"],i=e.getAriaValueText,o=(e.hsvSaturation,n.state),l=o.draggingHandle,c=(o.focusedHandle,o.topHandle),u=o.startValueS,d=o.startValueV,f=o.channelMin,p=o.channelMax,m=o.channelStepSize,v=(u-f)/(p-f),g=1-(d-f)/(p-f),b="startHandleS"===l,y="startHandleS"===l,E="startHandleS"===c;return h.default.createElement("div",{id:"handle",className:(0,s.default)("spectrum-ColorHandle spectrum-ColorArea-handle",{"is-dragged":b,"is-focused":y,"is-tophandle":E}),style:{left:100*v+"%",top:100*g+"%"},"touch-action":"none",role:"button"},h.default.createElement("div",{id:"custom-colorHandle",className:"spectrum-ColorHandle-color",style:{backgroundColor:this.getBackgroundColor(u,d)}},h.default.createElement("input",{id:n.getSliderHandleInputId("startHandleS"),ref:function(e){return n.startHandleSInput=e},type:"range",className:"spectrum-Slider-input",step:m,max:p,min:f,disabled:t,"aria-label":a||null,"aria-labelledby":n.getAriaLabelledby(null),"aria-describedby":r,"aria-valuemin":null,"aria-valuemax":null,"aria-valuetext":i(u),defaultValue:void 0,value:u,onChange:t?null:function(e){return n.onChange(e,"startHandleS")},onFocus:t?null:function(e){return n.onFocus(e,"startHandleS")},onBlur:t?null:function(e){return n.onBlur(e,"startHandleS")}}),h.default.createElement("input",{id:n.getSliderHandleInputId("valueVHandle"),ref:function(e){return n.startHandleVInput=e},type:"range",className:"spectrum-Slider-input",step:m,max:p,min:f,disabled:t,"aria-label":a||null,"aria-labelledby":n.getAriaLabelledby(null),"aria-describedby":r,"aria-valuemin":null,"aria-valuemax":null,"aria-valuetext":i(d),defaultValue:void 0,value:d,onChange:t?null:function(e){return n.onChange(e,"startHandleV")},onFocus:t?null:function(e){return n.onFocus(e,"startHandleV")},onBlur:t?null:function(e){return n.onBlur(e,"startHandleV")}}),h.default.createElement("input",{id:"keyControl",ref:function(e){return n.keyControlInput=e},type:"text",className:"spectrum-Slider-input",disabled:t,onKeyDown:function(e){return n.onKeyDown(e)}})))})),E(b(n),"setDOMReference",(function(e){return n.dom=e})),n.sliderId=(0,c.default)(),n}var n,a,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),n=t,(a=[{key:"UNSAFE_componentWillMount",value:function(){this.UNSAFE_componentWillReceiveProps(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t,n;null!==e.hsvSaturation&&(t=Math.min(e.hsvSaturation,this.state.channelMax)),null!==e.hsvValue&&(n=Math.min(e.hsvValue,this.state.channelMax)),null!=t&&this.setState({startValueS:t}),null!=n&&this.setState({startValueV:n}),this.isDraggedBodyClassName="u-isGrabbing"}},{key:"getLabelId",value:function(){return this.sliderId+"-label"}},{key:"getBackgroundGradient",value:function(){return"\n           linear-gradient(to top, black 0%, rgba(0, 0, 0, 0) 100%),\n           linear-gradient(to right, white 0%, rgba(0, 0, 0, 0) 100%),\n           hsl(".concat(this.props.hsvHue,",100%,50%)\n        ")}},{key:"getBackgroundColor",value:function(e,t){return f.fromRatio({h:this.props.hsvHue/360,s:e/100,v:t/100}).toHexString()}},{key:"getSliderHandleInputId",value:function(e){var t=this.props.id,n=void 0===t?this.sliderId:t;return"sliderHandleS"===e?n:n+"-"+e+"Input"}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,a=t.disabled,r=t.id,i=(void 0===r&&this.sliderId,t.label,t.renderLabel,t.variant,t["aria-label"],t.getAriaValueText),o=(m(t,["children","disabled","id","label","renderLabel","variant","aria-label","getAriaValueText","hsvHue","hsvSaturation","hsvValue"]),this.state.startValueS),l=(0,s.default)("spectrum-ColorArea",this.props.className,{"is-disabled":a}),c=this.getAriaLabelledby();return i(f({h:o,s:1,v:1,a:1}).toHexString()),h.default.createElement("div",{className:l,ref:this.setDOMReference,role:"presentation","aria-labelledby":c,onPointerDown:a?null:function(t){return e.onPointerDown(t)}},h.default.createElement("div",{className:"spectrum-ColorArea-gradient",role:"presentation",style:{background:this.getBackgroundGradient()}},n,this.renderSliderHandle()))}}])&&v(n.prototype,a),r&&v(n,r),t}(h.default.Component),E(r,"propTypes",{disabled:d.default.bool,renderLabel:d.default.bool,label:d.default.node,variant:d.default.oneOf([null,"h","r","g","b","a"]),size:d.default.oneOf([null,"S","L"]),hsvHue:d.default.number,hsvSaturation:d.default.number,hsvValue:d.default.number,onChange:d.default.func,getAriaValueText:d.default.func}),E(r,"defaultProps",{disabled:!1,renderLabel:!1,label:null,variant:null,size:null,hsvHue:0,hsvSaturation:100,hsvValue:100,onChange:function(){},getAriaValueText:function(e){return e}}),a=i))||a;t.default=k},190:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,i,o=n(83),s=w(n(15)),l=w(n(31)),c=w(n(35)),u=n(54),d=w(n(14)),h=w(n(0)),f=n(55);function p(e){return(p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){return e&&e.__esModule?e:{default:e}}var x={"cs-CZ":w(n(96)).default,"da-DK":w(n(97)).default,"de-DE":w(n(98)).default,"en-US":w(n(99)).default,"es-ES":w(n(100)).default,"fi-FI":w(n(101)).default,"fr-FR":w(n(102)).default,"hu-HU":w(n(103)).default,"it-IT":w(n(104)).default,"ja-JP":w(n(105)).default,"ko-KR":w(n(106)).default,"nb-NO":w(n(107)).default,"nl-NL":w(n(108)).default,"pl-PL":w(n(109)).default,"pt-BR":w(n(110)).default,"ru-RU":w(n(111)).default,"sv-SE":w(n(112)).default,"tr-TR":w(n(113)).default,"uk-UA":w(n(114)).default,"zh-CN":w(n(115)).default,"zh-TW":w(n(116)).default};n(168),n(538),n(169),n(539),n(170),n(540);var k=(0,u.messageFormatter)(x),S={FILL:{horizontal:"width",vertical:"height"},OFFSET:{horizontal:"left",vertical:"top"},OPPOSITE_OFFSET:{horizontal:"right",vertical:"top"}},C=(0,l.default)((i=r=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=g(t).call(this,e),n=!r||"object"!==p(r)&&"function"!==typeof r?b(a):r,E(b(n),"state",{startValue:null,draggingHandle:null,focusedHandle:null,channelMode:"h",channelMin:0,channelMax:359,channelName:"hue",channelStepSize:1,channelUnit:null}),E(b(n),"onPointerDown",(function(e,t){t?e.stopPropagation():t="startHandle";var a=n[t+"Input"];a&&a.focus(),e.persist(),n.setState({sliderHandle:null,isMouseUp:!1,draggingHandle:t},(function(){return n.onPointerMove(e)})),window.addEventListener("pointerup",n.onPointerUp),window.addEventListener("pointermove",n.onPointerMove),document.body.classList.add(n.isDraggedBodyClassName)})),E(b(n),"onPointerUp",(function(e){var t=n.state.draggingHandle,a=t&&n[t+"Input"];if(a&&a.blur(),n.setState({isMouseUp:!0,draggingHandle:null},(function(){a&&a.focus()})),n.props.onChangeEnd){n.getExportValue(n.state.startValue);n.props.onChangeEnd(expo,"a"==n.state.channelMode?1-startValue:startValue)}window.removeEventListener("pointerup",n.onPointerUp),window.removeEventListener("pointermove",n.onPointerMove),document.body.classList.remove(n.isDraggedBodyClassName)})),E(b(n),"calculateHandlePosition",(function(e){var t=n.props,a=n.state.channelMin,r=n.state.channelMax,i=t.orientation,s=t.step,l="vertical"===i,c=n.dom.getBoundingClientRect(),u=l?c.top:c.left,d=((l?e.clientY:e.clientX)-u)/(l?c.height:c.width);d=(0,o.clamp)(d,0,1),l&&(d=1-d);var h=a+(r-a)*d;return l&&(h=r-h),s&&(h=Math.round(h/s)*s),h})),E(b(n),"onPointerMove",(function(e){e.preventDefault();var t=n.calculateHandlePosition(e);n.updateValues(t,null,"startHandle")})),E(b(n),"updateValues",(function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=n.props,r=n.state.channelMin,i=n.state.channelMax,s=n.state.channelStepSize,l=a.onChange;if(e=(0,o.snapValueToStep)(e,r,i,s),l&&e!==n.state.startValue){var c=n.getExportValue(e);l(c,"a"==n.state.channelMode?1-e:e)}null==n.props.value&&n.setState({startValue:"a"==n.state.channelMode?1-e:e,focusedHandle:n.state.isMouseUp?null:t})})),E(b(n),"onKeyDown",(function(e,t){n.props;var a,r,i=n.state.channelMin,s=n.state.channelMax,l=n.state.channelStepSize,c="vertical"==n.props.orientation,u="a"==n.state.channelMode;switch(e.keyCode){case 37:if(c)return;if(e.preventDefault(),n.state.startValue==i)return;a=u?(0,o.snapValueToStep)(s-this.state.startValue-l,i,s,l):(0,o.snapValueToStep)(this.state.startValue-l,i,s,l),n.updateValues(a);break;case 39:if(c)return;if(e.preventDefault(),n.state.startValue==s)return;a=u?(0,o.snapValueToStep)(s-this.state.startValue+l,i,s,l):(0,o.snapValueToStep)(this.state.startValue+l,i,s,l),n.updateValues(a);break;case 38:case 36:case 33:if(!c)return;if(e.preventDefault(),n.state.startValue==s)return;r=u?(0,o.snapValueToStep)(s-this.state.startValue-l,i,s,l):(0,o.snapValueToStep)(this.state.startValue-l,i,s,l),n.updateValues(r);break;case 40:case 34:case 35:if(!c)return;if(e.preventDefault(),n.state.startValue==i)return;r=u?(0,o.snapValueToStep)(s-this.state.startValue+l,i,s,l):(0,o.snapValueToStep)(this.state.startValue+l,i,s,l),n.updateValues(r)}})),E(b(n),"onFocus",(function(e,t){n.setState({focusedHandle:n.state.isMouseUp?null:t,topHandle:t,isMouseUp:!1})})),E(b(n),"onBlur",(function(e,t){n.setState({focusedHandle:null})})),E(b(n),"onClickSliderValue",(function(e){window.getSelection();n.startHandleInput.focus()})),E(b(n),"getAriaLabelledby",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=n.props,a=t.label,r=t["aria-labelledby"],i=t["aria-label"],o=[];return r&&o.push(r),(a||i)&&o.push(n.getLabelId()),e&&o.push(n.getSliderHandleInputId(e)),o.join(" ")})),E(b(n),"renderSliderHandle",(function(e){var t=n.props,a=t.disabled,r=t.orientation,i=(t.variant,t["aria-label"]),o=t["aria-describedby"],l=t.getAriaValueText,c=t.colorValue,u=n.state,d=u.draggingHandle,p=(u.focusedHandle,u.topHandle),m=u.startValue,v=u.channelMin,g=u.channelMax,b=u.channelStepSize,y="startHandle"===e,w=m,x=(w-v)/(g-v);if(c)switch(n.state.channelMode){case"h":w=Math.min(f(c).toHsv().h,g);break;case"a":w=Math.min(1-f(c).getAlpha(),g),x=1-x;break;case"r":w=Math.min(f(c).toRgb().r,g);break;case"g":w=Math.min(f(c).toRgb().g,g);break;case"b":w=Math.min(f(c).toRgb().b,g)}var C="vertical"===r,O=d===e,P=d===e,T=p===e,M=S.OFFSET[r];k(y?"minimum":"maximum");return h.default.createElement("div",{className:(0,s.default)("spectrum-ColorHandle spectrum-ColorSlider-handle",{"is-dragged":O,"is-focused":P,"is-tophandle":T}),style:E({},M,100*x+"%"),"touch-action":"none",role:"presentation"},h.default.createElement("div",{id:"custom-colorHandle",className:"spectrum-ColorHandle-color",style:{backgroundColor:n.getBackgroundColor(),opacity:"a"==n.state.channelMode?f(c).getAlpha():1}},h.default.createElement("input",{id:n.getSliderHandleInputId(e),ref:function(t){return n[e+"Input"]=t},type:"range",className:"spectrum-Slider-input",step:b,max:g,min:v,disabled:a,"aria-orientation":C?r:null,"aria-label":i||null,"aria-labelledby":n.getAriaLabelledby(null),"aria-describedby":o,"aria-valuemin":null,"aria-valuemax":null,"aria-valuetext":l(w),defaultValue:void 0,value:w,onChange:a?null:function(e){},onKeyDown:a?null:function(e){return n.onKeyDown(e)},onFocus:a?null:function(t){return n.onFocus(t,e)},onBlur:a?null:function(t){return n.onBlur(t,e)}})))})),E(b(n),"setDOMReference",(function(e){return n.dom=e})),n.sliderId=(0,c.default)(),n}var n,a,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),n=t,(a=[{key:"UNSAFE_componentWillMount",value:function(){this.UNSAFE_componentWillReceiveProps(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=null==e.variant?"h":e.variant,n=359,a=1;"r"==t||"g"==t||"b"==t?n=255:"a"==t&&(a=.01,n=1),this.setState({channelMode:t,channelMax:n,channelStepSize:a});var r=e.value;if(null==r&&null!==e.colorValue)switch(t){case"h":r=Math.min(f(e.colorValue).toHsv().h,n);break;case"a":r=Math.min(f(e.colorValue).getAlpha(),n);break;case"r":r=Math.min(f("props.colorValue").toRgb().r,n);break;case"g":r=Math.min(f(e.colorValue).toRgb().g,n);break;case"b":r=Math.min(f(e.colorValue).toRgb().b,n)}null!=r&&this.setState({startValue:r}),this.isDraggedBodyClassName="u-isGrabbing"}},{key:"getLabelId",value:function(){return this.sliderId+"-label"}},{key:"getBackgroundGradient",value:function(e){var t,n,a="vertical"===e?"bottom":"right",r=f(this.props.colorValue?this.props.colorValue:"00000000");switch(this.state.channelMode){case"a":t=r.clone().setAlpha(1),n=r.clone().setAlpha(0);break;case"r":t=f({r:0,g:r.toRgb().g,b:r.toRgb().b}),n=f({r:255,g:r.toRgb().g,b:r.toRgb().b});break;case"g":t=f({r:r.toRgb().r,g:0,b:r.toRgb().b}),n=f({r:r.toRgb().r,g:255,b:r.toRgb().b});break;case"b":t=f({r:r.toRgb().r,g:r.toRgb().g,b:0}),n=f({r:r.toRgb().r,g:r.toRgb().g,b:255})}switch(this.state.channelMode){case"h":return"linear-gradient(to ".concat(a,", rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%)");default:return"linear-gradient(to ".concat(a,", ").concat(t.toRgbString()," 0%, ").concat(n.toRgbString()," 100%)")}}},{key:"getBackgroundColor",value:function(){var e=f(this.props.colorValue?this.props.colorValue:"00000000");switch(this.state.channelMode){case"a":return e.setAlpha(this.state.startColor),e.toRgbString();case"r":return f({r:this.state.startColor,g:e.toRgb().g,b:e.toRgb().b}).toRgbString();case"g":return f({r:e.toRgb().r,g:this.state.startColor,b:e.toRgb().b}).toRgbString();case"b":return f({r:e.toRgb().r,g:e.toRgb().g,b:this.state.startColor}).toRgbString();default:return f({h:this.state.startValue,s:1,v:1,a:1}).toRgbString()}}},{key:"getExportValue",value:function(e){var t,n,a=f(this.props.colorValue);switch(this.state.channelMode){case"a":return a.setAlpha(1-e),a.toHex8();case"r":n=a.toRgb(),t=f({r:e,g:n.g,b:n.b,a:n.a});break;case"g":n=a.toRgb(),t=f({r:a.r,g:e,b:a.b,a:a.a});break;case"b":n=a.toRgb(),t=f({r:a.r,g:a.g,b:e,a:a.a});break;default:t=f({h:e,s:1,v:1,a:a.getAlpha()})}return this.props.useAlpha?t.toHex8():t.toHex()}},{key:"getSliderHandleInputId",value:function(e){var t=this.props.id,n=void 0===t?this.sliderId:t;return"startHandle"===e?n:n+"-"+e+"Input"}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,a=t.disabled,r=t.id,i=void 0===r?this.sliderId:r,o=t.label,l=t.orientation,c=t.renderLabel,u=(t.variant,t["aria-label"]),d=t.getAriaValueText,p=(t.colorValue,m(t,["children","disabled","id","label","orientation","renderLabel","variant","aria-label","getAriaValueText","colorValue","useAlpha"])),v=this.state.startValue,g="vertical"===l,b=(0,s.default)("spectrum-ColorSlider",this.props.className,{"spectrum-ColorSlider--vertical":g,"is-disabled":a}),y=c&&o,E=this.getAriaLabelledby(),w=d(f({h:v,s:1,v:1,a:1}).toHexString());return h.default.createElement("div",{className:b,ref:this.setDOMReference,"aria-labelledby":E},(y||o&&E||u)&&h.default.createElement("div",{className:"spectrum-Slider-labelContainer"},h.default.createElement("label",{id:this.getLabelId(),className:"spectrum-Slider-label",htmlFor:i,hidden:!y||null,"aria-label":p["aria-labelledby"]?null:u},o),y&&h.default.createElement("div",{className:"spectrum-Slider-value",style:{outline:0},role:"textbox",tabIndex:-1,"aria-readonly":"true","aria-labelledby":E,onClick:a?null:function(t){return e.onClickSliderValue(t)}},w)),h.default.createElement("div",{className:"spectrum-ColorSlider-checkerboard",role:"presentation",onPointerDown:a?null:function(t){return e.onPointerDown(t)}},h.default.createElement("div",{className:"spectrum-Slider-custom-controls spectrum-ColorSlider-gradient",style:{background:this.getBackgroundGradient(l)}},n,this.renderSliderHandle("startHandle"))))}}])&&v(n.prototype,a),r&&v(n,r),t}(h.default.Component),E(r,"propTypes",{disabled:d.default.bool,orientation:d.default.oneOf(["horizontal","vertical"]),renderLabel:d.default.bool,label:d.default.node,variant:d.default.oneOf([null,"h","r","g","b","a"]),size:d.default.oneOf([null,"S","L"]),colorValue:d.default.node,useAlpha:d.default.bool,onChange:d.default.func,getAriaValueText:d.default.func}),E(r,"defaultProps",{disabled:!1,orientation:"horizontal",renderLabel:!1,label:null,variant:null,size:null,colorValue:"ff000000",useAlpha:!1,onChange:function(){},getAriaValueText:function(e){return e}}),a=i))||a;t.default=C},203:function(e,t,n){e.exports=n(641)},231:function(e,t){},29:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,i,o=n(83),s=w(n(15)),l=w(n(31)),c=w(n(35)),u=n(54),d=w(n(14)),h=w(n(0));function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],a=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(l){r=!0,i=l}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){return e&&e.__esModule?e:{default:e}}var x={"cs-CZ":w(n(96)).default,"da-DK":w(n(97)).default,"de-DE":w(n(98)).default,"en-US":w(n(99)).default,"es-ES":w(n(100)).default,"fi-FI":w(n(101)).default,"fr-FR":w(n(102)).default,"hu-HU":w(n(103)).default,"it-IT":w(n(104)).default,"ja-JP":w(n(105)).default,"ko-KR":w(n(106)).default,"nb-NO":w(n(107)).default,"nl-NL":w(n(108)).default,"pl-PL":w(n(109)).default,"pt-BR":w(n(110)).default,"ru-RU":w(n(111)).default,"sv-SE":w(n(112)).default,"tr-TR":w(n(113)).default,"uk-UA":w(n(114)).default,"zh-CN":w(n(115)).default,"zh-TW":w(n(116)).default};n(410),n(411),n(412);var k=(0,u.messageFormatter)(x),S={FILL:{horizontal:"width",vertical:"height"},OFFSET:{horizontal:"left",vertical:"bottom"},OPPOSITE_OFFSET:{horizontal:"right",vertical:"top"}},C=(0,l.default)((i=r=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=g(t).call(this,e),n=!r||"object"!==f(r)&&"function"!==typeof r?b(a):r,E(b(n),"state",{startValue:null,endValue:null,draggingHandle:null,focusedHandle:null}),E(b(n),"findNearestHandle",(function(e,t){var a=1/0,r="startHandle";return"range"!==n.props.variant||["startHandle","endHandle"].forEach((function(i){var o=n[i+"Input"].getBoundingClientRect(),s=o.top+window.pageYOffset,l=o.left+window.pageXOffset,c=Math.floor(Math.sqrt(Math.pow(e-(l+o.width/2),2)+Math.pow(t-(s+o.height/2),2)));c<a&&(a=c,r=i)})),r})),E(b(n),"onPointerDown",(function(e,t){t?e.stopPropagation():t=n.findNearestHandle(e.pageX,e.pageY);var a=n[t+"Input"];a&&a.focus(),e.persist(),n.setState({sliderHandle:null,isMouseUp:!1,draggingHandle:t},(function(){return n.onPointerMove(e)})),window.addEventListener("pointerup",n.onPointerUp),window.addEventListener("pointermove",n.onPointerMove),document.body.classList.add(n.isDraggedBodyClassName)})),E(b(n),"onPointerUp",(function(e){var t=n.state.draggingHandle,a=t&&n[t+"Input"];a&&a.blur(),n.setState({isMouseUp:!0,draggingHandle:null},(function(){a&&a.focus()})),n.props.onChangeEnd&&("range"===n.props.variant?n.props.onChangeEnd(n.state.startValue,n.state.endValue):n.props.onChangeEnd(n.state.startValue)),window.removeEventListener("pointerup",n.onPointerUp),window.removeEventListener("pointermove",n.onPointerMove),document.body.classList.remove(n.isDraggedBodyClassName)})),E(b(n),"calculateHandlePosition",(function(e){var t=n.props,a=t.min,r=t.max,i=t.orientation,s=t.step,l="vertical"===i,c=n.dom.getBoundingClientRect(),u=l?c.top:c.left,d=((l?e.clientY:e.clientX)-u)/(l?c.height:c.width);d=(0,o.clamp)(d,0,1),l&&(d=1-d);var h=a+(r-a)*d;return s&&(h=Math.round(h/s)*s),h})),E(b(n),"getHandleValues",(function(e,t){var a=n.state,r=a.draggingHandle,i=a.startValue,o=a.endValue;return"startHandle"===r&&(i=e),"endHandle"===r&&(o=e),+i+(t=t||1)>o?[n.state.startValue,n.state.endValue]:[i,o]})),E(b(n),"onPointerMove",(function(e){e.preventDefault();var t=n.calculateHandlePosition(e);if("range"===n.props.variant){var a=m(n.getHandleValues(t,n.props.step),2),r=a[0],i=a[1];n.updateValues(r,i,n.state.draggingHandle)}else n.updateValues(t,null,"startHandle")})),E(b(n),"updateValues",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=n.props,i=r.min,s=r.max,l=r.step,c=r.variant,u=r.onChange;e=(0,o.snapValueToStep)(e,i,s,l),"range"===c?(t=(0,o.snapValueToStep)(t,i,s,l),!u||e===n.state.startValue&&t===n.state.endValue||u(e,t),null==n.props.startValue&&null==n.props.endValue&&n.setState({startValue:e,endValue:t,focusedHandle:n.state.isMouseUp?null:a})):(u&&e!==n.state.startValue&&u(e),null==n.props.value&&n.setState({startValue:e,focusedHandle:n.state.isMouseUp?null:a}))})),E(b(n),"onChange",(function(e,t){var a=n.props,r=a.step,i=a.variant,o=n.state,s=o.startValue,l=o.endValue,c="startHandle"===t?s:l,u=+e.target.value;u!==c&&("range"===i?n.setState({draggingHandle:t},(function(){var e=m(n.getHandleValues(u,r),2),a=e[0],i=e[1];n.updateValues(a,i,t),n.setState({draggingHandle:null})})):n.updateValues(u,null,t))})),E(b(n),"onFocus",(function(e,t){n.setState({focusedHandle:n.state.isMouseUp?null:t,topHandle:t,isMouseUp:!1})})),E(b(n),"onBlur",(function(e,t){n.setState({focusedHandle:null})})),E(b(n),"onClickSliderValue",(function(e){var t=window.getSelection(),a="startHandle";"range"===n.props.variant&&t.focusOffset>e.target.textContent.indexOf("\u2013")&&(a="endHandle"),n[a+"Input"].focus()})),E(b(n),"getAriaLabelledby",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=n.props,a=t.label,r=t["aria-labelledby"],i=t["aria-label"],o=[];return r&&o.push(r),(a||i)&&o.push(n.getLabelId()),e&&o.push(n.getSliderHandleInputId(e)),o.join(" ")})),E(b(n),"renderSliderHandle",(function(e){var t=n.props,a=t.disabled,r=t.max,i=t.min,o=t.orientation,l=t.step,c=t.variant,u=t["aria-label"],d=t["aria-describedby"],f=t.getAriaValueText,p=n.state,m=p.draggingHandle,v=p.focusedHandle,g=p.topHandle,b=p.startValue,y=p.endValue,w="startHandle"===e,x=w?b:y,C=(x-i)/(r-i),O="range"===c,P="vertical"===o,T=m===e,M=v===e,I=g===e,A=S.OFFSET[o],R=k(w?"minimum":"maximum"),D=null,j=null;return O&&(u=R,D=w?i:b,j=w?y:r),h.default.createElement("div",{className:(0,s.default)("spectrum-Slider-handle",{"is-dragged":T,"is-focused":M,"is-tophandle":I}),onPointerDown:!a&&O?function(t){return n.onPointerDown(t,e)}:null,style:E({},A,100*C+"%"),"touch-action":"none",role:"presentation"},h.default.createElement("input",{id:n.getSliderHandleInputId(e),ref:function(t){return n[e+"Input"]=t},type:"range",className:"spectrum-Slider-input",step:l,max:r,min:i,disabled:a,"aria-orientation":P?o:null,"aria-label":u||null,"aria-labelledby":n.getAriaLabelledby(O?e:null),"aria-describedby":d,"aria-valuemin":D,"aria-valuemax":j,"aria-valuetext":f(x),defaultValue:void 0,value:x,onChange:a?null:function(t){return n.onChange(t,e)},onFocus:a?null:function(t){return n.onFocus(t,e)},onBlur:a?null:function(t){return n.onBlur(t,e)}}))})),E(b(n),"setDOMReference",(function(e){return n.dom=e})),n.sliderId=(0,c.default)(),n}var n,a,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),n=t,(a=[{key:"UNSAFE_componentWillMount",value:function(){this.UNSAFE_componentWillReceiveProps(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if("range"===e.variant){var t=null==e.startValue?e.defaultStartValue:e.startValue,n=null==e.endValue?e.defaultEndValue:e.endValue;null!=t||null!=this.state.startValue&&this.props.min===e.min||(t=e.min),null!=n||null!=this.state.endValue&&this.props.max===e.max||(n=e.max),null!=t&&null!=n&&this.setState({startValue:t,endValue:n})}else{var a=null==e.value?e.defaultValue:e.value;null!=a||null!=this.state.startValue&&this.props.max===e.max&&this.props.min===e.min||(a=e.min+(e.max-e.min)/2),null!=a&&this.setState({startValue:a})}this.isDraggedBodyClassName="u-isGrabbing"}},{key:"getLabelId",value:function(){return this.sliderId+"-label"}},{key:"getSliderHandleInputId",value:function(e){var t=this.props.id,n=void 0===t?this.sliderId:t;return"startHandle"===e?n:n+"-"+e+"Input"}},{key:"render",value:function(){var e,t,n=this,a=this.props,r=a.children,i=a.disabled,o=a.filled,l=a.fillOffset,c=a.id,u=void 0===c?this.sliderId:c,d=a.label,f=a.max,m=a.min,v=a.orientation,g=a.renderLabel,b=a.variant,y=a["aria-label"],w=a.getAriaValueText,x=p(a,["children","disabled","filled","fillOffset","id","label","max","min","orientation","renderLabel","variant","aria-label","getAriaValueText"]),k=this.state,C=k.startValue,O=k.endValue,P="ramp"===b,T="range"===b,M="vertical"===v,I=(0,s.default)("spectrum-Slider",this.props.className,{"spectrum-Slider--vertical":M,"spectrum-Slider--ramp":P,"spectrum-Slider--range":T,"spectrum-Slider--filled":o&&!l,"is-disabled":i}),A=g&&d,R=this.getAriaLabelledby(),D=T?"".concat(w(C),"\u2013").concat(w(O)):w(C),j=(T?O-C:C-m)/(f-m),_=S.FILL[v],L=S.OFFSET[v],N=S.OPPOSITE_OFFSET[v],V=(C-m)/(f-m),F=(O-m)/(f-m),U=(l-m)/(f-m),B=Math.min(V,U),H=Math.max(V,U);return P&&(r=null),T&&!o&&(o=!0),h.default.createElement("div",{className:I,ref:this.setDOMReference,role:T?"group":"presentation","aria-labelledby":T?R:null},(A||d&&R||y)&&h.default.createElement("div",{className:"spectrum-Slider-labelContainer"},h.default.createElement("label",{id:this.getLabelId(),className:"spectrum-Slider-label",htmlFor:u,hidden:!A||null,"aria-label":x["aria-labelledby"]?null:y},d),A&&h.default.createElement("div",{className:"spectrum-Slider-value",style:{outline:0},role:"textbox",tabIndex:-1,"aria-readonly":"true","aria-labelledby":R,onClick:i?null:function(e){return n.onClickSliderValue(e)}},D)),h.default.createElement("div",{className:"spectrum-Slider-controls",role:"presentation",onPointerDown:i?null:function(e){return n.onPointerDown(e)}},h.default.createElement("div",{className:"spectrum-Slider-background",role:"presentation"}),!P&&h.default.createElement("div",{className:"spectrum-Slider-track",role:"presentation",style:E({},_,100*(T?V:j)+"%")}),P&&h.default.createElement("div",{className:"spectrum-Slider-ramp"},h.default.createElement("svg",{width:"100%",viewBox:"0 0 240 16",preserveAspectRatio:"none","aria-hidden":"true",focusable:"false"},h.default.createElement("path",{d:"M240,4v8c0,2.3-1.9,4.1-4.2,4L1,9C0.4,9,0,8.5,0,8c0-0.5,0.4-1,1-1l234.8-7C238.1-0.1,240,1.7,240,4z"}))),r,this.renderSliderHandle("startHandle"),T&&h.default.createElement("div",{className:"spectrum-Slider-track",role:"presentation",style:(e={},E(e,L,100*V+"%"),E(e,N,100*(1-F)+"%"),e)}),T?this.renderSliderHandle("endHandle"):null,!P&&h.default.createElement("div",{className:"spectrum-Slider-track",role:"presentation",style:E({},_,100*(1-(T?F:j))+"%")}),o&&l?h.default.createElement("div",{className:(0,s.default)("spectrum-Slider-fill",{"spectrum-Slider-fill--right":V>U}),role:"presentation",style:(t={},E(t,L,100*B+"%"),E(t,_,100*(H-B)+"%"),t)}):null))}}])&&v(n.prototype,a),r&&v(n,r),t}(h.default.Component),E(r,"propTypes",{min:d.default.number,max:d.default.number,step:d.default.number,disabled:d.default.bool,orientation:d.default.oneOf(["horizontal","vertical"]),renderLabel:d.default.bool,label:d.default.node,filled:d.default.bool,fillOffset:d.default.number,variant:d.default.oneOf([null,"ramp","range"]),size:d.default.oneOf([null,"S","L"]),onChange:d.default.func,getAriaValueText:d.default.func}),E(r,"defaultProps",{min:0,max:100,step:0,disabled:!1,orientation:"horizontal",renderLabel:!1,label:null,filled:!1,fillOffset:0,variant:null,size:null,onChange:function(){},getAriaValueText:function(e){return e}}),a=i))||a;t.default=C},307:function(e,t,n){},318:function(e,t,n){},413:function(e,t,n){},420:function(e,t,n){},421:function(e,t,n){},431:function(e,t,n){},438:function(e,t,n){},439:function(e,t,n){},440:function(e,t,n){},441:function(e,t,n){},481:function(e,t,n){},524:function(e,t,n){},525:function(e,t,n){},528:function(e,t,n){},529:function(e,t,n){},530:function(e,t,n){},531:function(e,t,n){},540:function(e,t,n){},541:function(e,t,n){},546:function(e,t,n){},547:function(e,t,n){},548:function(e,t,n){},549:function(e,t,n){},597:function(e,t,n){},598:function(e,t,n){},599:function(e,t,n){},600:function(e,t,n){},608:function(e,t,n){},619:function(e,t,n){},622:function(e,t,n){},625:function(e,t,n){},626:function(e,t,n){},633:function(e,t,n){},634:function(e,t,n){},635:function(e,t,n){},636:function(e,t){window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function a(n){if(!t[n]){var r=t[n]={exports:{}};e[n][0].call(r.exports,(function(t){return a(e[n][1][t]||t)}),r,r.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var r=0;r<n.length;r++)a(n[r]);return a}({1:[function(e,t,n){function a(e){try{s.console&&console.log(e)}catch(t){}}var r,i=e("ee"),o=e(25),s={};try{r=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(s.console=!0,-1!==r.indexOf("dev")&&(s.dev=!0),-1!==r.indexOf("nr_dev")&&(s.nrDev=!0))}catch(l){}s.nrDev&&i.on("internal-error",(function(e){a(e.stack)})),s.dev&&i.on("fn-err",(function(e,t,n){a(n.stack)})),s.dev&&(a("NR AGENT IN DEVELOPMENT MODE"),a("flags: "+o(s,(function(e,t){return e})).join(", ")))},{}],2:[function(e,t,n){function a(e,t,n){this.message=e||"Uncaught error with no additional information",this.sourceURL=t,this.line=n}function r(e,t){var n=t?null:l.now();i("err",[e,n])}var i=e("handle"),o=e(26),s=e("ee"),l=e("loader"),c=e("gos"),u=window.onerror,d=!1,h="nr@seenError",f=0;l.features.err=!0,e(1),window.onerror=function(e,t,n,s,h){try{f?f-=1:r(h||new a(e,t,n),!0)}catch(c){try{i("ierr",[c,l.now(),!0])}catch(d){}}return"function"==typeof u&&u.apply(this,o(arguments))};try{throw new Error}catch(p){"stack"in p&&(e(13),e(12),"addEventListener"in window&&e(6),l.xhrWrappable&&e(14),d=!0)}s.on("fn-start",(function(e,t,n){d&&(f+=1)})),s.on("fn-err",(function(e,t,n){d&&!n[h]&&(c(n,h,(function(){return!0})),this.thrown=!0,r(n))})),s.on("fn-end",(function(){d&&!this.thrown&&f>0&&(f-=1)})),s.on("internal-error",(function(e){i("ierr",[e,l.now(),!0])}))},{}],3:[function(e,t,n){e("loader").features.ins=!0},{}],4:[function(e,t,n){function a(){A++,I=b.hash,this[u]=y.now()}function r(){A--,b.hash!==I&&i(0,!0);var e=y.now();this[p]=~~this[p]+e-this[u],this[d]=e}function i(e,t){x.emit("newURL",[""+b,t])}function o(e,t){e.on(t,(function(){this[t]=y.now()}))}var s="-start",l="-end",c="-body",u="fn"+s,d="fn"+l,h="cb"+s,f="cb"+l,p="jsTime",m="fetch",v="addEventListener",g=window,b=g.location,y=e("loader");if(g[v]&&y.xhrWrappable){var E=e(10),w=e(11),x=e(8),k=e(6),S=e(13),C=e(7),O=e(14),P=e(9),T=e("ee"),M=T.get("tracer");e(16),y.features.spa=!0;var I,A=0;T.on(u,a),T.on(h,a),T.on(d,r),T.on(f,r),T.buffer([u,d,"xhr-done","xhr-resolved"]),k.buffer([u]),S.buffer(["setTimeout"+l,"clearTimeout"+s,u]),O.buffer([u,"new-xhr","send-xhr"+s]),C.buffer([m+s,m+"-done",m+c+s,m+c+l]),x.buffer(["newURL"]),E.buffer([u]),w.buffer(["propagate",h,f,"executor-err","resolve"+s]),M.buffer([u,"no-"+u]),P.buffer(["new-jsonp","cb-start","jsonp-error","jsonp-end"]),o(O,"send-xhr"+s),o(T,"xhr-resolved"),o(T,"xhr-done"),o(C,m+s),o(C,m+"-done"),o(P,"new-jsonp"),o(P,"jsonp-end"),o(P,"cb-start"),x.on("pushState-end",i),x.on("replaceState-end",i),g[v]("hashchange",i,!0),g[v]("load",i,!0),g[v]("popstate",(function(){i(0,A>1)}),!0)}},{}],5:[function(e,t,n){function a(e){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var r=e("ee"),i=e("handle"),o=e(13),s=e(12),l="learResourceTimings",c="addEventListener",u="resourcetimingbufferfull",d="bstResource",h="resource",f="-start",p="-end",m="fn"+f,v="fn"+p,g="bstTimer",b="pushState",y=e("loader");y.features.stn=!0,e(8),"addEventListener"in window&&e(6);var E=NREUM.o.EV;r.on(m,(function(e,t){e[0]instanceof E&&(this.bstStart=y.now())})),r.on(v,(function(e,t){var n=e[0];n instanceof E&&i("bst",[n,t,this.bstStart,y.now()])})),o.on(m,(function(e,t,n){this.bstStart=y.now(),this.bstType=n})),o.on(v,(function(e,t){i(g,[t,this.bstStart,y.now(),this.bstType])})),s.on(m,(function(){this.bstStart=y.now()})),s.on(v,(function(e,t){i(g,[t,this.bstStart,y.now(),"requestAnimationFrame"])})),r.on(b+f,(function(e){this.time=y.now(),this.startPath=location.pathname+location.hash})),r.on(b+p,(function(e){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])})),c in window.performance&&(window.performance["c"+l]?window.performance[c](u,(function(e){i(d,[window.performance.getEntriesByType(h)]),window.performance["c"+l]()}),!1):window.performance[c]("webkit"+u,(function(e){i(d,[window.performance.getEntriesByType(h)]),window.performance["webkitC"+l]()}),!1)),document[c]("scroll",a,{passive:!0}),document[c]("keypress",a,!1),document[c]("click",a,!1)}},{}],6:[function(e,t,n){function a(e){for(var t=e;t&&!t.hasOwnProperty(u);)t=Object.getPrototypeOf(t);t&&r(t)}function r(e){s.inPlace(e,[u,d],"-",i)}function i(e,t){return e[1]}var o=e("ee").get("events"),s=e("wrap-function")(o,!0),l=e("gos"),c=XMLHttpRequest,u="addEventListener",d="removeEventListener";t.exports=o,"getPrototypeOf"in Object?(a(document),a(window),a(c.prototype)):c.prototype.hasOwnProperty(u)&&(r(window),r(c.prototype)),o.on(u+"-start",(function(e,t){var n=e[1],a=l(n,"nr@wrapped",(function(){var e={object:function(){if("function"==typeof n.handleEvent)return n.handleEvent.apply(n,arguments)},function:n}[typeof n];return e?s(e,"fn-",null,e.name||"anonymous"):n}));this.wrapped=e[1]=a})),o.on(d+"-start",(function(e){e[1]=this.wrapped||e[1]}))},{}],7:[function(e,t,n){function a(e,t,n){var a=e[t];"function"==typeof a&&(e[t]=function(){var e,t=i(arguments),o={};r.emit(n+"before-start",[t],o),o[p]&&o[p].dt&&(e=o[p].dt);var s=a.apply(this,t);return r.emit(n+"start",[t,e],s),s.then((function(e){return r.emit(n+"end",[null,e],s),e}),(function(e){throw r.emit(n+"end",[e],s),e}))})}var r=e("ee").get("fetch"),i=e(26),o=e(25);t.exports=r;var s=window,l="fetch-",c=l+"body-",u=s.Request,d=s.Response,h=s.fetch,f="prototype",p="nr@context";u&&d&&h&&(o(["arrayBuffer","blob","json","text","formData"],(function(e,t){a(u[f],t,c),a(d[f],t,c)})),a(s,"fetch",l),r.on(l+"end",(function(e,t){var n=this;if(t){var a=t.headers.get("content-length");null!==a&&(n.rxSize=a),r.emit(l+"done",[null,t],n)}else r.emit(l+"done",[e],n)})))},{}],8:[function(e,t,n){var a=e("ee").get("history"),r=e("wrap-function")(a);t.exports=a;var i=window.history&&window.history.constructor&&window.history.constructor.prototype,o=window.history;i&&i.pushState&&i.replaceState&&(o=i),r.inPlace(o,["pushState","replaceState"],"-")},{}],9:[function(e,t,n){function a(e){var t=e.match(l);return t?t[1]:null}function r(e,t){var n=e.match(u),a=n[1],i=n[3];return i?r(i,t[a]):t[a]}function i(e){var t=e.match(c);return t&&t.length>=3?{key:t[2],parent:r(t[1],window)}:{key:e,parent:window}}var o=e("ee").get("jsonp"),s=e("wrap-function")(o);if(t.exports=o,"addEventListener"in window){var l=/[?&](?:callback|cb)=([^&#]+)/,c=/(.*)\.([^.]+)/,u=/^(\w+)(\.|$)(.*)$/,d=["appendChild","insertBefore","replaceChild"];Node&&Node.prototype&&Node.prototype.appendChild?s.inPlace(Node.prototype,d,"dom-"):(s.inPlace(HTMLElement.prototype,d,"dom-"),s.inPlace(HTMLHeadElement.prototype,d,"dom-"),s.inPlace(HTMLBodyElement.prototype,d,"dom-")),o.on("dom-start",(function(e){!function(e){function t(){o.emit("jsonp-end",[],c),e.removeEventListener("load",t,!1),e.removeEventListener("error",n,!1)}function n(){o.emit("jsonp-error",[],c),o.emit("jsonp-end",[],c),e.removeEventListener("load",t,!1),e.removeEventListener("error",n,!1)}if(e&&"string"==typeof e.nodeName&&"script"===e.nodeName.toLowerCase()&&"function"==typeof e.addEventListener){var r=a(e.src);if(r){var l=i(r);if("function"==typeof l.parent[l.key]){var c={};s.inPlace(l.parent,[l.key],"cb-",c),e.addEventListener("load",t,!1),e.addEventListener("error",n,!1),o.emit("new-jsonp",[e.src],c)}}}}(e[0])}))}},{}],10:[function(e,t,n){var a=e("ee").get("mutation"),r=e("wrap-function")(a),i=NREUM.o.MO;t.exports=a,i&&(window.MutationObserver=function(e){return this instanceof i?new i(r(e,"fn-")):i.apply(this,arguments)},MutationObserver.prototype=i.prototype)},{}],11:[function(e,t,n){function a(e){var t=i.context(),n=o(e,"executor-",t),a=new l(n);return i.context(a).getCtx=function(){return t},i.emit("new-promise",[a,t],t),a}var r=e("wrap-function"),i=e("ee").get("promise"),o=r(i),s=e(25),l=NREUM.o.PR;t.exports=i,l&&(window.Promise=a,["all","race"].forEach((function(e){var t=l[e];l[e]=function(n){function a(e){return function(){i.emit("propagate",[null,!r],o),r=r||!e}}var r=!1;s(n,(function(t,n){Promise.resolve(n).then(a("all"===e),a(!1))}));var o=t.apply(l,arguments),c=l.resolve(o);return c}})),["resolve","reject"].forEach((function(e){var t=l[e];l[e]=function(e){var n=t.apply(l,arguments);return e!==n&&i.emit("propagate",[e,!0],n),n}})),l.prototype.catch=function(e){return this.then(null,e)},l.prototype=Object.create(l.prototype,{constructor:{value:a}}),s(Object.getOwnPropertyNames(l),(function(e,t){try{a[t]=l[t]}catch(n){}})),i.on("executor-start",(function(e){e[0]=o(e[0],"resolve-",this),e[1]=o(e[1],"resolve-",this)})),i.on("executor-err",(function(e,t,n){e[1](n)})),o.inPlace(l.prototype,["then"],"then-",(function(e,t){return t})),i.on("then-start",(function(e,t){this.promise=t,e[0]=o(e[0],"cb-",this),e[1]=o(e[1],"cb-",this)})),i.on("then-end",(function(e,t,n){this.nextPromise=n;var a=this.promise;i.emit("propagate",[a,!0],n)})),i.on("cb-end",(function(e,t,n){i.emit("propagate",[n,!0],this.nextPromise)})),i.on("propagate",(function(e,t,n){this.getCtx&&!t||(this.getCtx=function(){if(e instanceof Promise)var t=i.context(e);return t&&t.getCtx?t.getCtx():this})})),a.toString=function(){return""+l})},{}],12:[function(e,t,n){var a=e("ee").get("raf"),r=e("wrap-function")(a),i="equestAnimationFrame";t.exports=a,r.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),a.on("raf-start",(function(e){e[0]=r(e[0],"fn-")}))},{}],13:[function(e,t,n){var a=e("ee").get("timer"),r=e("wrap-function")(a),i="setTimeout",o="setInterval",s="clearTimeout",l="-start";t.exports=a,r.inPlace(window,[i,"setImmediate"],i+"-"),r.inPlace(window,[o],o+"-"),r.inPlace(window,[s,"clearImmediate"],s+"-"),a.on(o+l,(function(e,t,n){e[0]=r(e[0],"fn-",null,n)})),a.on(i+l,(function(e,t,n){this.method=n,this.timerDuration=isNaN(e[1])?0:+e[1],e[0]=r(e[0],"fn-",this,n)}))},{}],14:[function(e,t,n){function a(e,t){c.inPlace(t,["onreadystatechange"],"fn-",o)}function r(){var e=this,t=l.context(e);e.readyState>3&&!t.resolved&&(t.resolved=!0,l.emit("xhr-resolved",[],e)),c.inPlace(e,v,"fn-",o)}function i(){for(var e=0;e<g.length;e++)a(0,g[e]);g.length&&(g=[])}function o(e,t){return t}e(6);var s=e("ee"),l=s.get("xhr"),c=e("wrap-function")(l),u=NREUM.o,d=u.XHR,h=u.MO,f=u.PR,p=u.SI,m="readystatechange",v=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],g=[];t.exports=l;var b=window.XMLHttpRequest=function(e){var t=new d(e);try{l.emit("new-xhr",[t],t),t.addEventListener(m,r,!1)}catch(n){try{l.emit("internal-error",[n])}catch(a){}}return t};if(function(e,t){for(var n in e)t[n]=e[n]}(d,b),b.prototype=d.prototype,c.inPlace(b.prototype,["open","send"],"-xhr-",o),l.on("send-xhr-start",(function(e,t){a(0,t),function(e){g.push(e),h&&(y?y.then(i):p?p(i):(E=-E,w.data=E))}(t)})),l.on("open-xhr-start",a),h){var y=f&&f.resolve();if(!p&&!f){var E=1,w=document.createTextNode(E);new h(i).observe(w,{characterData:!0})}}else s.on("fn-end",(function(e){e[0]&&e[0].type===m||i()}))},{}],15:[function(e,t,n){function a(e){var t=!1,n=!1,a={};if("init"in NREUM&&"distributed_tracing"in NREUM.init&&(n=!!(a=NREUM.init.distributed_tracing).enabled),n)if(e.sameOrigin)t=!0;else if(a.allowed_origins instanceof Array)for(var r=0;r<a.allowed_origins.length;r++){var o=i(a.allowed_origins[r]);if(e.hostname===o.hostname&&e.protocol===o.protocol&&e.port===o.port){t=!0;break}}return n&&t}var r=e(23),i=e(17);t.exports={generateTracePayload:function(e){if(!a(e))return null;var t=window.NREUM;if(!t.loader_config)return null;var n=(t.loader_config.accountID||"").toString()||null,i=(t.loader_config.agentID||"").toString()||null,o=(t.loader_config.trustKey||"").toString()||null;if(!n||!i)return null;var s=r.generateCatId(),l=r.generateCatId(),c=Date.now();return{header:function(e,t,n,a,r,i){if(!("btoa"in window)||"function"!=typeof window.btoa)return null;var o={v:[0,1],d:{ty:"Browser",ac:a,ap:r,id:e,tr:t,ti:n}};return i&&a!==i&&(o.d.tk=i),btoa(JSON.stringify(o))}(s,l,c,n,i,o),guid:s,traceId:l,timestamp:c}},shouldGenerateTrace:a}},{}],16:[function(e,t,n){function a(e){var t=this.params,n=this.metrics;if(!this.ended){this.ended=!0;for(var a=0;a<d;a++)e.removeEventListener(u[a],this.listener,!1);t.aborted||(n.duration=i.now()-this.startTime,this.loadCaptureCalled||4!==e.readyState?null==t.status&&(t.status=0):r(this,e),n.cbTime=this.cbTime,c.emit("xhr-done",[e],e),o("xhr",[t,n,this.startTime]))}}function r(e,t){e.params.status=t.status;var n=m(t,e.lastSize);if(n&&(e.metrics.rxSize=n),e.sameOrigin){var a=t.getResponseHeader("X-NewRelic-App-Data");a&&(e.params.cat=a.split(", ").pop())}e.loadCaptureCalled=!0}var i=e("loader");if(i.xhrWrappable){var o=e("handle"),s=e(17),l=e(15).generateTracePayload,c=e("ee"),u=["load","error","abort","timeout"],d=u.length,h=e("id"),f=e(21),p=e(20),m=e(18),v=window.XMLHttpRequest;i.features.xhr=!0,e(14),e(7),c.on("new-xhr",(function(e){var t=this;t.totalCbs=0,t.called=0,t.cbTime=0,t.end=a,t.ended=!1,t.xhrGuids={},t.lastSize=null,t.loadCaptureCalled=!1,e.addEventListener("load",(function(n){r(t,e)}),!1),f&&(f>34||f<10)||window.opera||e.addEventListener("progress",(function(e){t.lastSize=e.loaded}),!1)})),c.on("open-xhr-start",(function(e){this.params={method:e[0]},function(e,t){var n=s(t),a=e.params;a.host=n.hostname+":"+n.port,a.pathname=n.pathname,e.parsedOrigin=s(t),e.sameOrigin=e.parsedOrigin.sameOrigin}(this,e[1]),this.metrics={}})),c.on("open-xhr-end",(function(e,t){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&t.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid);var n=l(this.parsedOrigin);n&&n.header&&(t.setRequestHeader("newrelic",n.header),this.dt=n)})),c.on("send-xhr-start",(function(e,t){var n=this.metrics,a=e[0],r=this;if(n&&a){var o=p(a);o&&(n.txSize=o)}this.startTime=i.now(),this.listener=function(e){try{"abort"!==e.type||r.loadCaptureCalled||(r.params.aborted=!0),("load"!==e.type||r.called===r.totalCbs&&(r.onloadCalled||"function"!=typeof t.onload))&&r.end(t)}catch(n){try{c.emit("internal-error",[n])}catch(a){}}};for(var s=0;s<d;s++)t.addEventListener(u[s],this.listener,!1)})),c.on("xhr-cb-time",(function(e,t,n){this.cbTime+=e,t?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)})),c.on("xhr-load-added",(function(e,t){var n=""+h(e)+!!t;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)})),c.on("xhr-load-removed",(function(e,t){var n=""+h(e)+!!t;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)})),c.on("addEventListener-end",(function(e,t){t instanceof v&&"load"===e[0]&&c.emit("xhr-load-added",[e[1],e[2]],t)})),c.on("removeEventListener-end",(function(e,t){t instanceof v&&"load"===e[0]&&c.emit("xhr-load-removed",[e[1],e[2]],t)})),c.on("fn-start",(function(e,t,n){t instanceof v&&("onload"===n&&(this.onload=!0),("load"===(e[0]&&e[0].type)||this.onload)&&(this.xhrCbStart=i.now()))})),c.on("fn-end",(function(e,t){this.xhrCbStart&&c.emit("xhr-cb-time",[i.now()-this.xhrCbStart,this.onload,t],t)})),c.on("fetch-before-start",(function(e){var t,n=e[1]||{};"string"==typeof e[0]?t=e[0]:e[0]&&e[0].url&&(t=e[0].url),t&&(this.parsedOrigin=s(t),this.sameOrigin=this.parsedOrigin.sameOrigin);var a=l(this.parsedOrigin);if(a&&a.header){var r=a.header;if("string"==typeof e[0]){var i={};for(var o in n)i[o]=n[o];i.headers=new Headers(n.headers||{}),i.headers.set("newrelic",r),this.dt=a,e.length>1?e[1]=i:e.push(i)}else e[0]&&e[0].headers&&(e[0].headers.append("newrelic",r),this.dt=a)}}))}},{}],17:[function(e,t,n){var a={};t.exports=function(e){if(e in a)return a[e];var t=document.createElement("a"),n=window.location,r={};t.href=e,r.port=t.port;var i=t.href.split("://");!r.port&&i[1]&&(r.port=i[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===i[0]?"443":"80"),r.hostname=t.hostname||n.hostname,r.pathname=t.pathname,r.protocol=i[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var o=!t.protocol||":"===t.protocol||t.protocol===n.protocol,s=t.hostname===document.domain&&t.port===n.port;return r.sameOrigin=o&&(!t.hostname||s),"/"===r.pathname&&(a[e]=r),r}},{}],18:[function(e,t,n){var a=e(20);t.exports=function(e,t){var n=e.responseType;return"json"===n&&null!==t?t:"arraybuffer"===n||"blob"===n||"json"===n?a(e.response):"text"===n||"document"===n||""===n||void 0===n?a(e.responseText):void 0}},{}],19:[function(e,t,n){function a(){}function r(e,t,n){return function(){return i(e,[c.now()].concat(s(arguments)),t?null:this,n),t?void 0:this}}var i=e("handle"),o=e(25),s=e(26),l=e("ee").get("tracer"),c=e("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d="api-",h=d+"ixn-";o(["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],(function(e,t){u[t]=r(d+t,!0,"api")})),u.addPageAction=r(d+"addPageAction",!0),u.setCurrentRouteName=r(d+"routeName",!0),t.exports=newrelic,u.interaction=function(){return(new a).get()};var f=a.prototype={createTracer:function(e,t){var n={},a=this,r="function"==typeof t;return i(h+"tracer",[c.now(),e,n],a),function(){if(l.emit((r?"":"no-")+"fn-start",[c.now(),a,r],n),r)try{return t.apply(this,arguments)}catch(e){throw l.emit("fn-err",[arguments,this,e],n),e}finally{l.emit("fn-end",[c.now()],n)}}}};o("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),(function(e,t){f[t]=r(h+t)})),newrelic.noticeError=function(e,t){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,t])}},{}],20:[function(e,t,n){t.exports=function(e){if("string"==typeof e&&e.length)return e.length;if("object"==typeof e){if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&e.byteLength)return e.byteLength;if("undefined"!=typeof Blob&&e instanceof Blob&&e.size)return e.size;if(!("undefined"!=typeof FormData&&e instanceof FormData))try{return JSON.stringify(e).length}catch(t){return}}}},{}],21:[function(e,t,n){var a=0,r=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);r&&(a=+r[1]),t.exports=a},{}],22:[function(e,t,n){function a(e){if(e instanceof l&&!c){var t,n=Math.round(e.timeStamp);t=n>1e12?Date.now()-n:s.now()-n,c=!0,o("timing",["fi",n,{type:e.type,fid:t}])}}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&!1===NREUM.init.page_view_timing.enabled)){var r,i,o=e("handle"),s=e("loader"),l=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){r=new PerformanceObserver((function(e,t){e.getEntries().forEach((function(e){"first-paint"===e.name?o("timing",["fp",Math.floor(e.startTime)]):"first-contentful-paint"===e.name&&o("timing",["fcp",Math.floor(e.startTime)])}))})),i=new PerformanceObserver((function(e,t){var n=e.getEntries();n.length>0&&o("lcp",[n[n.length-1]])}));try{r.observe({entryTypes:["paint"]}),i.observe({entryTypes:["largest-contentful-paint"]})}catch(u){}}if("addEventListener"in document){var c=!1;["click","keydown","mousedown","pointerdown","touchstart"].forEach((function(e){document.addEventListener(e,a,!1)}))}}},{}],23:[function(e,t,n){t.exports={generateUuid:function(){function e(){return t?15&t[n++]:16*Math.random()|0}var t=null,n=0,a=window.crypto||window.msCrypto;a&&a.getRandomValues&&(t=a.getRandomValues(new Uint8Array(31)));for(var r,i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="",s=0;s<i.length;s++)"x"===(r=i[s])?o+=e().toString(16):"y"===r?o+=(r=3&e()|8).toString(16):o+=r;return o},generateCatId:function(){var e=null,t=0,n=window.crypto||window.msCrypto;n&&n.getRandomValues&&Uint8Array&&(e=n.getRandomValues(new Uint8Array(31)));for(var a=[],r=0;r<16;r++)a.push((e?15&e[t++]:16*Math.random()|0).toString(16));return a.join("")}}},{}],24:[function(e,t,n){var a=null,r=null;if(navigator.userAgent){var i=navigator.userAgent,o=i.match(/Version\/(\S+)\s+Safari/);o&&-1===i.indexOf("Chrome")&&-1===i.indexOf("Chromium")&&(a="Safari",r=o[1])}t.exports={agent:a,version:r,match:function(e,t){if(!a)return!1;if(e!==a)return!1;if(!t)return!0;if(!r)return!1;for(var n=r.split("."),i=t.split("."),o=0;o<i.length;o++)if(i[o]!==n[o])return!1;return!0}}},{}],25:[function(e,t,n){var a=Object.prototype.hasOwnProperty;t.exports=function(e,t){var n=[],r="",i=0;for(r in e)a.call(e,r)&&(n[i]=t(r,e[r]),i+=1);return n}},{}],26:[function(e,t,n){t.exports=function(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var a=-1,r=n-t||0,i=Array(r<0?0:r);++a<r;)i[a]=e[t+a];return i}},{}],27:[function(e,t,n){t.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,t,n){function a(){}function r(){return new a}function i(){(c.api||c.feature)&&(d.aborted=!0,c=d.backlog={})}var o="nr@context",s=e("gos"),l=e(25),c={},u={},d=t.exports=function e(t){function n(e){return e&&e instanceof a?e:e?s(e,o,r):r()}function h(e,a,r,i){if(!d.aborted||i){t&&t(e,a,r);for(var o=n(r),s=p(e),l=s.length,u=0;u<l;u++)s[u].apply(o,a);var h=c[v[e]];return h&&h.push([g,e,a,o]),o}}function f(e,t){m[e]=p(e).concat(t)}function p(e){return m[e]||[]}var m={},v={},g={on:f,addEventListener:f,removeEventListener:function(e,t){var n=m[e];if(n)for(var a=0;a<n.length;a++)n[a]===t&&n.splice(a,1)},emit:h,get:function(t){return u[t]=u[t]||e(h)},listeners:p,context:n,buffer:function(e,t){l(e,(function(e,n){t=t||"feature",v[n]=t,t in c||(c[t]=[])}))},abort:i,aborted:!1};return g}();d.backlog=c},{}],gos:[function(e,t,n){var a=Object.prototype.hasOwnProperty;t.exports=function(e,t,n){if(a.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[t]=r,r}},{}],handle:[function(e,t,n){function a(e,t,n,a){r.buffer([e],a),r.emit(e,t,n)}var r=e("ee").get("handle");t.exports=a,a.ee=r},{}],id:[function(e,t,n){var a=1,r="nr@id",i=e("gos");t.exports=function(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:i(e,r,(function(){return a++}))}},{}],loader:[function(e,t,n){function a(){if(!w++){var e=E.info=NREUM.info,t=h.getElementsByTagName("script")[0];if(setTimeout(c.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return c.abort();l(b,(function(t,n){e[t]||(e[t]=n)})),s("mark",["onload",i()+E.offset],null,"api");var n=h.createElement("script");n.src="https://"+e.agent,t.parentNode.insertBefore(n,t)}}function r(){s("mark",["domContent",i()+E.offset],null,"api")}function i(){return x.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-E.offset}var o=(new Date).getTime(),s=e("handle"),l=e(25),c=e("ee"),u=e(24),d=window,h=d.document,f="addEventListener",p="attachEvent",m=d.XMLHttpRequest,v=m&&m.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var g=""+location,b={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-spa-1167.min.js"},y=m&&v&&v[f]&&!/CriOS/.test(navigator.userAgent),E=t.exports={offset:o,now:i,origin:g,features:{},xhrWrappable:y,userAgent:u};e(19),e(22),h[f]?(h[f]("DOMContentLoaded",r,!1),d[f]("load",a,!1)):(h[p]("onreadystatechange",(function(){"complete"===h.readyState&&r()})),d[p]("onload",a)),s("mark",["firstbyte",o],null,"api");var w=0,x=e(27)},{}],"wrap-function":[function(e,t,n){function a(e){return!(e&&e instanceof Function&&e.apply&&!e[o])}var r=e("ee"),i=e(26),o="nr@original",s=Object.prototype.hasOwnProperty,l=!1;t.exports=function(e,t){function n(e,t,n,r){function l(){var a,o,s,l;try{o=this,a=i(arguments),s="function"==typeof n?n(a,o):n||{}}catch(d){u([d,"",[a,o,r],s])}c(t+"start",[a,o,r],s);try{return l=e.apply(o,a)}catch(h){throw c(t+"err",[a,o,h],s),h}finally{c(t+"end",[a,o,l],s)}}return a(e)?e:(t||(t=""),l[o]=e,function(e,t){if(Object.defineProperty&&Object.keys)try{return Object.keys(e).forEach((function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){return e[n]=t,t}})})),t}catch(a){u([a])}for(var n in e)s.call(e,n)&&(t[n]=e[n])}(e,l),l)}function c(n,a,r){if(!l||t){var i=l;l=!0;try{e.emit(n,a,r,t)}catch(o){u([o,n,a,r])}l=i}}function u(t){try{e.emit("internal-error",t)}catch(n){}}return e||(e=r),n.inPlace=function(e,t,r,i){r||(r="");var o,s,l,c="-"===r.charAt(0);for(l=0;l<t.length;l++)a(o=e[s=t[l]])||(e[s]=n(o,c?s+r:r,i,s))},n.flag=o,n}},{}]},{},["loader",2,16,5,3,4]),NREUM.loader_config={accountID:"2617885",trustKey:"1322840",agentID:"635596742",licenseKey:"NRJS-ded7a5b2c46fbe94259",applicationID:"635596742"},NREUM.info={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",licenseKey:"NRJS-ded7a5b2c46fbe94259",applicationID:"635596742",sa:1}},637:function(e,t,n){},641:function(e,t,n){"use strict";n.r(t);n(204);var a,r,i=n(63),o=n(3),s=n.n(o),l=n(7),c=n(1),u=n(2),d=n(27),h=n(9),f=n(8),p=n(5),m=n(6),v=n(0),g=n.n(v),b=n(12),y=n.n(b),E=n(36);!function(e){e.JPG="jpg",e.PNG="png",e.SVG="svg"}(a||(a={})),function(e){e.JPG="jpg",e.PNG="png"}(r||(r={}));var w,x=n(87),k=n(195),S=n(40),C=n(72),O=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"loadScript",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.getElementById(t)){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return e.abrupt("return",new Promise((function(e,a){var r=document.createElement("script");r.src=n,r.id=t,r.onload=function(){e()},r.onerror=function(e){a(e)},document.body.appendChild(r)})));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadCSS",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.getElementById(t)){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return e.abrupt("return",new Promise((function(e,a){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.href=n,r.id=t;var i=document.getElementsByTagName("head")[0];r.onload=function(){e()},r.onerror=function(){a()},i.appendChild(r)})));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"cancelablePromise",value:function(e){var t=function(){};return{promise:new Promise((function(n,a){var r=!1,i=new Promise((function(e,n){t=function(){r||n()}}));i.catch((function(){return a(new Error("Canceled"))})),e((function(e){r=!0,n(e)}),(function(e){r=!0,a(e)}),(function(e){i.catch(e)}))})),cancel:t}}},{key:"waitUntilWithCancel",value:function(t){return e.cancelablePromise((function(e,n,a){var r=setInterval((function(){var n;try{n=t()}catch(a){}!0===n&&(clearInterval(r),e())}),10);a((function(){return clearInterval(r)}))}))}},{key:"waitUntilWithTimeout",value:function(t,n){var a=e.waitUntilWithCancel(n);return setTimeout(a.cancel,t),a.promise}},{key:"waitForPromiseWithTimeout",value:function(t,n){var a=e.cancelablePromise((function(e,t){n.then(e).catch(t)}));return setTimeout(a.cancel,t),a.promise}},{key:"deduper",value:function(){var e=new Map;return function(t,n){clearTimeout(e.get(t)),e.set(t,setTimeout(n,50))}}},{key:"openInNewTab",value:function(e){Object.assign(document.createElement("a"),{target:"_blank",href:e}).click()}},{key:"isLocalhost",value:function(){return Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))}},{key:"humanFileSize",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=n?1e3:1024;if(Math.abs(t)<a)return"".concat(t," B");var r=n?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=-1,o=t;do{o/=a,i+=1}while(Math.abs(o)>=a&&i<r.length-1);return"".concat((Math.round(10*o)/10).toLocaleString(e.getCurrentLanguage().replace("_","-"))," ").concat(r[i])}},{key:"getCurrentLanguage",value:function(){return C.a.language||localStorage.i18nextLng||"en"}},{key:"getNormalizedCurrentLocale",value:function(){return S.normalize(e.getCurrentLanguage())}},{key:"hasUSEnglish",value:function(){var t=e.parseCookies();return void 0!==t.international?"en-US"===S.normalize(t.international,"adobedotcom"):void 0!==t["creative-cloud-loc"]?"en-US"===S.normalize(t["creative-cloud-loc"],"cchome"):"en-US"===e.getNormalizedCurrentLocale()}},{key:"getLocalizedURL",value:function(t){var n=e.getNormalizedCurrentLocale();return S.getLocalizedURL(t,n)}},{key:"parseCookies",value:function(e){var t;return Object.assign.apply(Object,[{}].concat(Object(k.a)(null===(t=null!==e&&void 0!==e?e:document.cookie)||void 0===t?void 0:t.split(";").map((function(e){var t,n,a=null===(t=e.split("=")[0])||void 0===t?void 0:t.trim(),r=null===(n=e.split("=")[1])||void 0===n?void 0:n.trim();return Object(x.a)({},a,r)})))))}},{key:"getFileExt",value:function(e){return e.trim().toLowerCase().split(".").pop()}},{key:"hasSupportedFileExt",value:function(t){var n=e.getFileExt(t);return!!n&&null!==n.match(/^(jpe?g)?(png)?$/)}},{key:"isEnOrRunningInLocEnv",value:function(){return e.hasUSEnglish()||!1}},{key:"rgbToHex",value:function(e,t,n){return"#".concat(((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1))}},{key:"hexToRgb",value:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:void 0}},{key:"wait",value:function(e){return new Promise((function(t,n){return setTimeout(t,e)}))}}]),e}();!function(e){e[e.anonymous=0]="anonymous",e[e.free=1]="free",e[e.paid=2]="paid"}(w||(w={}));var P=function(){function e(){var t=this;Object(c.a)(this,e),this.imsReady=void 0,window.adobeid={locale:"en_US",client_id:"ps-frictionless-web",scope:"AdobeID,openid,creative_sdk",uses_redirect_mode:!0,onReady:function(){console.log("IMS lib initialized."),t.imsReady&&t.imsReady()}}}return Object(u.a)(e,null,[{key:"getInstance",value:function(){return e.instance}}]),Object(u.a)(e,[{key:"load",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:e.next=4;break;case 4:e.prev=4,O.loadScript("ims","https://static.adobelogin.com/imslib/imslib.min.js"),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(4),e.abrupt("return",Promise.reject(e.t0));case 11:return e.abrupt("return",new Promise((function(e){t.imsReady=e})));case 12:case"end":return e.stop()}}),e,null,[[4,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"getUserProfile",value:function(){var e,t=null===(e=window.adobeIMS)||void 0===e?void 0:e.getUserProfile();if(t)return t.created=1e3*parseInt(t.userId.substring(8,16),16),t}},{key:"loginUser",value:function(e){var t;this.isSignedInUser()||(null===(t=window.adobeIMS)||void 0===t||t.signIn({},{lastEditor:e}))}},{key:"logoutUser",value:function(){var e;this.isSignedInUser()&&(null===(e=window.adobeIMS)||void 0===e||e.signOut())}},{key:"signUpUser",value:function(e){var t;this.isSignedInUser()||(null===(t=window.adobeIMS)||void 0===t||t.signUp())}},{key:"isSignedInUser",value:function(){var e;return null===(e=window.adobeIMS)||void 0===e?void 0:e.isSignedInUser()}},{key:"getUserAccessToken",value:function(){var e,t=null===(e=window.adobeIMS)||void 0===e?void 0:e.getAccessToken();return t?"Bearer ".concat(t):void 0}},{key:"getUserPictureURL",value:function(){var e;return null===(e=window.adobeIMS)||void 0===e?void 0:e.getUserPictureURL()}},{key:"getUserAccessLevel",value:function(){var e=this.getUserProfile();return e?e.serviceAccounts.some((function(e){return"ACTIVE"===e.serviceStatus&&"CS_LVL_2"===e.serviceLevel&&"creative_cloud"===e.serviceCode}))?w.paid:w.free:w.anonymous}}]),e}();P.instance=new P;var T,M=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"createHTMLCanvasElementForSize",value:function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}},{key:"createHTMLCanvasElement",value:function(t){var n=e.createHTMLCanvasElementForSize(t.width,t.height),a=n.getContext("2d");return null!==a&&a.putImageData(t,0,0),n}},{key:"createBlob",value:function(){var t=Object(l.a)(s.a.mark((function t(n,a,r,i){var o,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.createHTMLCanvasElementForSize(n.width,n.height),t.abrupt("return",new Promise((function(t,s){var c=o.getContext("2d");if(c){var u;if(c.putImageData(n,0,0),i){var d=(l=e.createHTMLCanvasElementForSize(n.width,n.height)).getContext("2d");d&&(d.fillStyle=i,d.fillRect(0,0,o.width,o.height),d.drawImage(o,0,0))}e.toBlob(null!==(u=l)&&void 0!==u?u:o,(function(e){e?t(e):s(new Error("no blob"))}),a,r)}else s(new Error("no ctx"))})));case 2:case"end":return t.stop()}}),t)})));return function(e,n,a,r){return t.apply(this,arguments)}}()},{key:"createImageData",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new Image,r=window.URL||window.webkitURL;a.onload=function(){r.revokeObjectURL(a.src);var t=document.createElement("canvas");t.width=a.width,t.height=a.height;var i=t.getContext("2d");if(i){i.drawImage(a,0,0);var o=i.getImageData(0,0,a.width,a.height);e(o)}else n(new Error("no ctx"))},a.onerror=function(e){console.error(e),n(e)},a.src="string"===typeof t||t instanceof String?t:r.createObjectURL(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createDataUrl",value:function(t,n,a){return e.createHTMLCanvasElement(t).toDataURL(n,a)}},{key:"applyMask",value:function(e,t){if(e.data.length!==t.data.length)throw new Error("cannot apply mask of different size");for(var n=new ImageData(new Uint8ClampedArray(e.data),e.width,e.height),a=n.data,r=t.data,i=0;i<a.length;i+=4)a[i+3]=r[i];return n}},{key:"resizeImageDataMinSize",value:function(t,n){if(!t||n<1)return null;var a=t.width,r=t.height;return a<=r?(a=n,r=Math.floor(t.height*a/t.width)):(r=n,a=Math.floor(t.width*r/t.height)),e.resizeImageData(t,a,r)}},{key:"resizeImageDataMaxSize",value:function(t,n){if(!t||n<1)return null;var a=t.width,r=t.height;return a>=r?(a=n,r=Math.floor(t.height*a/t.width)):(r=n,a=Math.floor(t.width*r/t.height)),e.resizeImageData(t,a,r)}},{key:"resizeImageDataToWidth",value:function(t,n){if(!t||n<1)return null;var a=n,r=Math.floor(t.height*a/t.width);return e.resizeImageData(t,a,r)}},{key:"resizeImageDataToHeight",value:function(t,n){if(!t||n<1)return null;var a=n,r=Math.floor(t.width*a/t.height);return e.resizeImageData(t,r,a)}},{key:"resizeImageData",value:function(t,n,a){if(!t||n<1||a<1)return null;if(t.width===n&&t.height===a)return t;var r=e.createHTMLCanvasElementForSize(t.width,t.height),i=r.getContext("2d"),o=e.createHTMLCanvasElementForSize(n,a),s=o.getContext("2d");return i&&s?(i.putImageData(t,0,0),s.drawImage(r,0,0,t.width,t.height,0,0,o.width,o.height),s.getImageData(0,0,o.width,o.height)):null}},{key:"createBitmask",value:function(e){for(var t=new Int8Array(e.width*e.height),n=0,a=0;n<e.data.length;n+=4,a+=1){var r=e.data[n]+e.data[n+1]+e.data[n+2];t[a]=r>0?255:0}return t}},{key:"doesImageExceedMaxLength",value:function(e,t){return e&&(e.width>t||e.height>t)}},{key:"toBlob",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;setTimeout((function(){for(var r=atob(e.toDataURL(n,a).split(",")[1]),i=r.length,o=new Uint8Array(i),s=0;s<i;s+=1)o[s]=r.charCodeAt(s);t(new Blob([o],{type:n||"image/png"}))}))}},{key:"getMaxViewportDimsWebGl",value:function(){var e=document.createElement("canvas").getContext("webgl"),t=null===e||void 0===e?void 0:e.getParameter(null===e||void 0===e?void 0:e.MAX_VIEWPORT_DIMS);return t&&2===t.length?[Math.floor(t[0]/2),Math.floor(t[1]/2)]:null}},{key:"renderIntoImageData",value:function(t,n,a){if(n&&t&&t.width===n.width&&t.height===n.height){var r=e.createHTMLCanvasElementForSize(t.width,t.height),i=r.getContext("2d");if(i)return i.drawImage(t,0,0,r.width,r.height),i.globalAlpha=a,i.drawImage(n,0,0,n.width,n.height),i.getImageData(0,0,r.width,r.height)}}},{key:"hasAlpha",value:function(e){for(var t=3;t<e.data.length;t+=4)if(255!==e.data[t])return!0;return!1}},{key:"flipPixels",value:function(e,t,n){for(var a=Math.floor(n/2),r=Math.floor(4*t),i=new Uint8Array(4*t),o=0;o<a;o+=1){var s=o*r,l=(n-o-1)*r;i.set(e.subarray(s,s+r)),e.copyWithin(s,l,l+r),e.set(i,l)}}},{key:"createRgbMaskFromGreyBuffer",value:function(e){for(var t=new Uint8ClampedArray(4*e.length),n=0,a=0;a<e.length;a++)255===e[a]?(t[n++]=255,t[n++]=255,t[n++]=255,t[n++]=0):(t[n++]=e[a],t[n++]=e[a],t[n++]=e[a],t[n++]=255);return t}},{key:"getNonAlphaBoundingRect",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.width,a=0,r=e.height,i=0,o=0;o<e.height;o+=1)for(var s=0;s<e.width;s+=1)e.data[o*e.width*4+4*s+3]>t&&(s<n&&(n=s),s>a&&(a=s),o<r&&(r=o),o>i&&(i=o));if(!(n===e.width||0===a||r===e.height||0===i||n>=a||r>=i))return{x:n,y:r,width:a-n,height:i-r}}},{key:"copyImageData",value:function(t,n){if(n.width===t.width&&n.height===t.height)return t;if(!(n.x+n.width>t.width||n.y+n.height>t.height)){var a=e.createHTMLCanvasElement(t).getContext("2d");return a?a.getImageData(n.x,n.y,n.width,n.height):void 0}}},{key:"addAlphaBorder",value:function(t,n){var a=t.width+2*n,r=t.height+2*n,i=e.createHTMLCanvasElementForSize(a,r).getContext("2d");if(i)return i.drawImage(e.createHTMLCanvasElement(t),n,n,t.width,t.height),i.getImageData(0,0,a,r)}},{key:"calcUncompressedImageSize",value:function(e,t){return e*t*3}},{key:"isEmptyImage",value:function(e){for(var t=0;t<e.data.length;t++)if(0!==e.data[t])return!1;return!0}}]),e}(),I=parseInt("1",10),A=parseInt("31536000000",10),R=function(){function e(t){Object(c.a)(this,e),this.doc=void 0,this.doc=t}return Object(u.a)(e,[{key:"download",value:function(){var t=Object(l.a)(s.a.mark((function t(n,a,r){var i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.doc.getImageData(),t.next=3,e.downloadImageData(i,n,a,r);case 3:if(!this.doc.isFileSampleImage()&&(o=this.getQuota()))try{localStorage.setItem("fps_quota",JSON.stringify({timestamp:o.timestamp,count:o.count+1,last:P.getInstance().getUserAccessLevel()}))}catch(s){}case 4:case"end":return t.stop()}}),t,this)})));return function(e,n,a){return t.apply(this,arguments)}}()},{key:"canDownload",value:function(){return this.doc.isFileSampleImage()||0!==this.getNumberOfRemainingDownloads()}},{key:"getNumberOfRemainingDownloads",value:function(){var e=P.getInstance().getUserAccessLevel();if(e===w.paid||e===w.free)return-1;var t=this.getQuota(e);return t&&e===w.anonymous?Math.max(0,I-t.count):0}},{key:"getQuota",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=JSON.parse(localStorage.getItem("fps_quota")||"{}");if(!t.count)return{timestamp:Date.now(),count:0};var n=e||P.getInstance().getUserAccessLevel(),a=t.timestamp,r=t.count,i=t.last,o=Date.now();return n===w.anonymous&&o>a+A&&(a=o,r=0),{timestamp:a,count:r,last:i}}catch(s){return null}}}],[{key:"downloadImageData",value:function(){var t=Object(l.a)(s.a.mark((function t(n,a,i,o){var l,c,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=i,t.next=t.t0===r.PNG?3:t.t0===r.JPG?7:11;break;case 3:return t.next=5,M.createBlob(n,"image/png");case 5:return l=t.sent,t.abrupt("break",12);case 7:return t.next=9,M.createBlob(n,"image/jpeg",o,"white");case 9:return l=t.sent,t.abrupt("break",12);case 11:throw new Error("unknown format");case 12:c=a,e.hasCorrectFileExt(c,i)||(c+=e.getFileExt(i,!0)),u=document.createElement("a"),document.body.appendChild(u),u.download=c,u.href=window.URL.createObjectURL(l),u.click();case 19:case"end":return t.stop()}}),t)})));return function(e,n,a,r){return t.apply(this,arguments)}}()},{key:"getFileExt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?".":"";return e===r.JPG?n+="jpg":e===r.PNG&&(n+="png"),n}},{key:"hasCorrectFileExt",value:function(e,t){return t===r.PNG?"png"===O.getFileExt(e):t===r.JPG&&"jpg"===O.getFileExt(e)}}]),e}(),D=n(30),j=n.n(D),_=n(174),L=n.n(_),N=n(33),V=n.n(N),F=function(){function e(){Object(c.a)(this,e),this.container=void 0,this.view=void 0}return Object(u.a)(e,[{key:"createView",value:function(e){this.container=e}},{key:"destroyView",value:function(){this.container=void 0}},{key:"viewDidMount",value:function(e){this.view=e}},{key:"viewWillUnmount",value:function(e){this.view=void 0}},{key:"ensureHTMLElement",value:function(e){var t=document.getElementById(e);if(!t)throw new Error("missing element ".concat(e));return t}}]),e}();n(307);!function(e){e.crop="crop",e.spotheal="spotheal",e.resize="resize",e.adjust="adjust",e.cutout="cutout",e.effects="effects"}(T||(T={}));var U=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a){var r;return Object(c.a)(this,n),(r=t.call(this)).id=void 0,r.doc=void 0,r.alwaysPointerTracking=!1,r.id=e,r.doc=a,r}return Object(u.a)(n,[{key:"startEditor",value:function(e){this.doc.setLoading(!0),this.initStage(),this.createView(e)}},{key:"endEditor",value:function(){this.destroyView()}},{key:"viewDidMount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewDidMount",this).call(this,e),this.doc.setLoading(!1)}},{key:"getId",value:function(){return this.id}},{key:"isDirty",value:function(){return!1}},{key:"hasUndoStack",value:function(){return!1}},{key:"undo",value:function(){}},{key:"redo",value:function(){}},{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){}},{key:"initStage",value:function(){this.doc.getStage().ensure2DCanvas(),this.doc.getStage().setImageData(this.doc.getImageData())}},{key:"needsAlwaysPointerTracking",value:function(){return this.alwaysPointerTracking}},{key:"onPointerDown",value:function(e){}},{key:"onPointerMove",value:function(e){}},{key:"onPointerUp",value:function(e){}},{key:"onPointerEnter",value:function(e){}},{key:"onPointerOut",value:function(e){}},{key:"onPointerLeave",value:function(e){}},{key:"onGestureStart",value:function(e){}},{key:"onGestureChange",value:function(e){}},{key:"onGestureEnd",value:function(e){}},{key:"onZoomChange",value:function(e){}},{key:"onContainerSizeChanged",value:function(e,t){}},{key:"onPanModeStart",value:function(){}},{key:"onPanModeEnd",value:function(){}},{key:"onZoomModeStart",value:function(){}},{key:"onZoomModeEnd",value:function(){}},{key:"onStageTransformChanged",value:function(){}}]),n}(F),B=/^(color|creative|vintage|bw|vignette)$/,H=/^(styletransfer|psaction|custom)$/,z=/^(invertcolor|pixelate)$/,G=new RegExp("^(".concat(Object.values(a).join("|"),")$")),W=new RegExp("^(".concat(Object.values(r).join("|"),")$")),Z=new RegExp("^convert/(".concat(Object.values(r).join("|"),")$")),Y=new RegExp("^convert/(".concat(Object.values(a).join("|"),")/(").concat(Object.values(r).join("|"),")$")),K=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"getParams",value:function(){var t=sessionStorage.getItem(e.SESSION_STORAGE_KEY)||"{}";return JSON.parse(t)}},{key:"setParams",value:function(t){sessionStorage.setItem(e.SESSION_STORAGE_KEY,JSON.stringify(t))}},{key:"getParam",value:function(t){var n=e.getParams();if(n.queryString&&0!==n.queryString.length)return new URLSearchParams(n.queryString).get(t)||void 0}},{key:"parseParams",value:function(){var t={},n=new URLSearchParams(window.location.search);t.queryString=n.toString(),window.location.hash.length>0&&new URLSearchParams(window.location.hash).forEach((function(e,t){return n.append(t,e)})),n.forEach((function(e,n){switch(n){case"rctx":var a=JSON.parse(e.substring(0,e.indexOf("}")+1));a&&((t.ims=t.ims||{}).lastEditor=a.lastEditor);break;case"api":(t.ims=t.ims||{}).redirectAPI=e;break;case"prevent_interstitial":t.interstitial={preventInterstitial:"true"===e};break;case"uitest":t.globalAction=t.globalAction||{},t.globalAction.isUITest="true"===e;break;case"action":t.globalAction=t.globalAction||{},t.globalAction.action=e;break;case"sourceformat":e.match(G)&&(t.globalAction=t.globalAction||{},t.globalAction.sourceFormat=e);break;case"targetformat":e.match(W)&&(t.globalAction=t.globalAction||{},t.globalAction.targetFormat=e);break;case"bg_color":t.cutout={bgColor:e};break;case"bg_blur_intensity":t.cutout={blurRadius:e};break;case"group":e.match(B)&&(t.adjustments=t.adjustments||{},t.adjustments.group=e),e.match(H)&&(t.filters=t.filters||{},t.filters.group=e);break;case"presetid":t.adjustments=t.adjustments||{},t.adjustments.presetid=parseInt(e,10)||0;break;case"filter":t.filters=t.filters||{},t.filters.filter=e;break;case"enlarger":t.resize={enlarger:"true"===e};break;case"crop_shapes":t.crop={enableCropShapes:"true"===e}}}));var a=window.location.pathname.slice(1).split("/");"embed"===a[0]?(t.globalAction=t.globalAction||{},t.globalAction.isEmbed=!0,a.shift()):a[0]in T&&(t.editor=a.shift());var r=a.join("/");switch(r){case"background/replace":var i=n.get("color");i&&(t.editor=T.cutout,t.cutout={bgColor:i});break;case"background/blur":var o=n.get("intensity");o&&(t.editor=T.cutout,t.cutout={blurRadius:o});break;case"compress":t.globalAction=t.globalAction||{},t.globalAction.action="compress";break;case(r.match(Z)||{}).input:t.globalAction=t.globalAction||{},t.globalAction.action="convert",t.globalAction.targetFormat=a.pop();break;case(r.match(Y)||{}).input:t.globalAction=t.globalAction||{},t.globalAction.action="convert",t.globalAction.targetFormat=a.pop(),t.globalAction.sourceFormat=a.pop();break;case"enlarger":t.resize={enlarger:!0};break;case(r.match(B)||{}).input:t.editor===T.adjust&&(t.adjustments=t.adjustments||{},t.adjustments.group=r);break;case(r.match(/^\d{1,2}$/)||{}).input:t.editor===T.adjust&&(t.adjustments=t.adjustments||{},t.adjustments.presetid=parseInt(r||"0",10));break;case(r.match(H)||{}).input:t.editor===T.effects&&(t.filters=t.filters||{},t.filters.group=r);break;case(r.match(z)||{}).input:t.editor===T.effects&&(t.filters=t.filters||{},t.filters.filter=r)}e.setParams(t)}}]),e}();K.SESSION_STORAGE_KEY="fps_query_params";var X=n(34);function q(e){return new Promise((function(t){e(),t()}))}window.marketingtech={adobe:{launch:{property:"global",environment:"production"},analytics:{additionalAccounts:""},target:!0,audienceManager:!1,evidon:!0}},n(308);var J,Q,$="webApp:photoshop.adobe.com",ee=function(e){return"".concat($,":").concat(e)},te=function(e){return"".concat($,":").concat(e)};function ne(e,t){return Object.keys(t).forEach((function(n){void 0!==e[n]&&t[n]instanceof Object?e[n]=ne(e[n],t[n]):e[n]=t[n]})),e}function ae(e){var t=window.digitalData._snapshot();return{digitalData:e?ne(t,e):t}}function re(e){var t=e.action,n={},a=e;if("store"===t?localStorage.setItem("fps-track-doc",JSON.stringify(a)):"restore"===t&&(a=JSON.parse(localStorage.getItem("fps-track-doc")||"null")),a){var r,i,o,s,l,c={componentInfo:{componentID:"".concat((null===(r=a)||void 0===r?void 0:r.id)||""),componentType:"".concat((null===(i=a)||void 0===i?void 0:i.mimeType)||""),componentAction:(null===(o=a)||void 0===o?void 0:o.isSampleImage)?"stockImage":"uploadImage",componentPosition:"".concat((null===(s=a)||void 0===s?void 0:s.sampleImagePosition)||0),componentResolution:"".concat((null===(l=a)||void 0===l?void 0:l.resolution)||[0,0])}};"store"===t||"restore"===t?(console.debug("GlobalTracking: primaryComponent: KEEP: ",c.componentInfo),window.digitalData._set("primaryComponent",c)):(console.debug("GlobalTracking: primaryComponent: TRANSIENT: ",c.componentInfo),n={primaryComponent:c})}return n}function ie(e,t){return oe.apply(this,arguments)}function oe(){return(oe=Object(l.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=te(t),e.abrupt("return",q((function(){var e=(null===n||void 0===n?void 0:n.action)?{eventAction:null===n||void 0===n?void 0:n.action}:void 0,t={eventInfo:Object(X.a)({eventName:a},e)},r=(null===n||void 0===n?void 0:n.error)?{name:n.error}:void 0,i=(null===n||void 0===n?void 0:n.errorCode)?{code:n.errorCode}:void 0,o=r||i?{error:{client:{primary:{errorInfo:Object(X.a)(Object(X.a)({},r),i)}}}}:void 0,s=(null===n||void 0===n?void 0:n.doc)?re(null===n||void 0===n?void 0:n.doc):{},l=ae(Object(X.a)(Object(X.a)({primaryEvent:t},o),s));console.debug("GlobalTracking: trackEvent: ",a,l),window._satellite.track("event",l)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){return le.apply(this,arguments)}function le(){return(le=Object(l.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=de(t),a=ee(t),J!==a){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:return J=a,e.abrupt("return",q((function(){console.debug("GlobalTracking: trackView: ",a),window.digitalData._set("page.pageInfo.pageName","".concat(a)),n||(Q=a),window._satellite.track("state",ae())})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){return ue.apply(this,arguments)}function ue(){return(ue=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=de(t),e.abrupt("return",n&&Q?q((function(){console.debug("GlobalTracking: restored PageName after modal close: ",Q),window.digitalData._set("page.pageInfo.pageName","".concat(Q))})):Promise.resolve());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){return e.endsWith(":modal")||e.startsWith("modal")}window.digitalData._set("page.pageInfo.pageName","loading"),window.digitalData._set("page.pageInfo.siteSection",$),window.digitalData._set("page.pageInfo.language",function(){var e=O.parseCookies();return void 0!==e.international?S.normalize(e.international,"adobedotcom"):void 0!==e["creative-cloud-loc"]?S.normalize(e["creative-cloud-loc"],"cchome"):S.normalize(O.getCurrentLanguage())}());var he=n(37),fe=n.n(he),pe=(n(318),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.message;return g.a.createElement(fe.a,{cancelLabel:"No thanks",confirmLabel:"Continue",onConfirm:function(){return t.openSurvey()},onCancel:function(){return t.cancel()},className:"interstitial-dialog",keyboardConfirm:!0,role:"dialog"},g.a.createElement("span",null,n))}}]),n}(v.PureComponent)),me="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=1",ve="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=2",ge="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=3",be="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=4",ye="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=5",Ee=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n),(e=t.call(this)).dialogId=void 0,e.lastPopup=0,e.hasDownloaded=!1,e.url=void 0,e.sourceName=void 0;var a=JSON.parse(localStorage.getItem(n.EVENT_KEY)||"{}");return a.lastPopup&&(e.lastPopup=a.lastPopup),a.hasDownloaded&&(e.hasDownloaded=!!a.hasDownloaded),e}return Object(u.a)(n,[{key:"show",value:function(e){this.dialogId=j.a.show(g.a.createElement(pe,{controller:this,message:e})),se("userSurvey:".concat(this.sourceName,":modal"))}},{key:"cancel",value:function(){ie("userSurvey:".concat(this.sourceName,":cancel")),this.close()}},{key:"close",value:function(){this.dialogId&&(j.a.hide(this.dialogId),ce("userSurvey:".concat(this.sourceName,":modal")))}},{key:"showSurveyEditor",value:function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;var r=Date.now(),i=null!==(t=null===(n=K.getParams().interstitial)||void 0===n?void 0:n.preventInterstitial)&&void 0!==t&&t;if(!(!O.hasUSEnglish||this.lastPopup>r-2592e6||i)&&!(Math.random()<a)){switch(this.lastPopup=r,this.updateLocalStorage(),e){case"spotheal":this.url=me;break;case"crop":this.url=ve;break;case"resize":this.url=ge;break;case"adjust":this.url=be;break;case"cutout":this.url=ye;break;default:return}this.sourceName=e,this.show("Tell us how Photoshop Express performed! If you have time to answer 3 questions, please continue.")}}},{key:"showSurveyDownload",value:function(){var e,t;var n=Date.now(),a=null!==(e=null===(t=K.getParams().interstitial)||void 0===t?void 0:t.preventInterstitial)&&void 0!==e&&e;!O.hasUSEnglish||this.hasDownloaded||this.lastPopup>n-2592e6||a||(this.hasDownloaded=!0,this.lastPopup=n,this.updateLocalStorage(),this.sourceName="download",this.url="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200600?list=1&key=1",this.show("Tell us about your overall experience using Photoshop Express and be entered into a raffle for a $100 Amazon Gift Card!"))}},{key:"openSurvey",value:function(){this.url&&O.openInNewTab(this.url),ie("userSurvey:".concat(this.sourceName,":open")),this.close()}},{key:"updateLocalStorage",value:function(){try{localStorage.setItem(n.EVENT_KEY,JSON.stringify({lastPopup:this.lastPopup,hasDownloaded:this.hasDownloaded}))}catch(e){}}}]),n}(F);Ee.EVENT_KEY="fps_interstitial";var we=n(13),xe=n.n(we),ke=n(39),Se=n.n(ke),Ce=n(67),Oe=n.n(Ce),Pe=n(175),Te=n.n(Pe),Me=n(89),Ie=n.n(Me),Ae=n(176),Re=n.n(Ae),De=n(50),je=n.n(De),_e=n(57),Le=n(118),Ne=n.n(Le),Ve=n(68),Fe=n.n(Ve),Ue=n(29),Be=n.n(Ue),He=n(177),ze=n(178),Ge=n(73),We=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,[{key:"init",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(null===(t="cs,da,de,en,es,fi,fr,it,ja,ko,nb,nl,pl,pt,ru,sv,tr,zh_CN,zh_TW,zh_cn,zh_tw")?void 0:t.split(","))||["en"],(a=new He.a).addDetector({name:"fpsLanguageDetector",lookup:function(e){try{var t=O.parseCookies();if(t.international||t["creative-cloud-loc"]){var n=Object(S.normalize)(t.international||t["creative-cloud-loc"]);if(null===n||void 0===n?void 0:n.startsWith("zh-Hans"))return"zh_CN";if(null===n||void 0===n?void 0:n.startsWith("zh-Hant"))return"zh_TW";var a=Object(S.lang)(n);if(a)return a}}catch(r){}}}),e.abrupt("return",C.a.use(Ge.e).use(a).use(ze.a).init({fallbackLng:"en",whitelist:n,load:"languageOnly",debug:!1,initImmediate:!0,saveMissing:!1,keySeparator:".",interpolation:{escapeValue:!1},react:{useSuspense:!1},detection:{lookupCookie:"lang",cookieDomain:"*.adobe.com",order:["querystring","path","fpsLanguageDetector","cookie","localStorage","navigator","htmlTag","subdomain"],checkWhitelist:!0}}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"translate",value:function(e,t){return C.a.t(e,t)}}],[{key:"getInstance",value:function(){return e.instance}}]),e}();function Ze(e,t){return We.getInstance().translate(e,t)}We.instance=new We;n(413);var Ye,Ke=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n),(a=t.call(this,e)).imgRef=Object(v.createRef)(),a.formatIds=void 0;var i=a.props,o=i.saveInitMode,s=i.targetFormat,l=o===Ye.COMPRESS;a.formatIds=new Map,a.formatIds.set(0,r.JPG),a.formatIds.set(1,r.PNG);var u=a.getIdByFormat(null!==s&&void 0!==s?s:r.JPG);return o===Ye.COMPRESS&&(u=a.getIdByFormat(r.JPG)),a.state={quality:92,qualityString:Ze("SaveAs.JPG.GoodQuality","Good"),qualityClass:"quality-good",fileName:"filename",fileSize:"",fileTypeId:u,imageWidth:0,imageHeight:0,showTooltip:l},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),this.loadImageData(),se("modalDownloadAs")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),ce("modalDownloadAs")}},{key:"refresh",value:function(){}},{key:"getIdByFormat",value:function(e){var t=0;return this.formatIds.forEach((function(n,a){e===n&&(t=a)})),t}},{key:"handleFileFormatChange",value:function(e){var t=this,n=this.state.quality;this.setState({fileTypeId:e},(function(){switch(t.formatIds.get(e)){case r.JPG:t.setState({qualityString:t.getQualityString(n),qualityClass:t.getQualityClassname(n)}),ie("selectDownloadFileFormat",{action:"JPG"});break;case r.PNG:t.setState({qualityString:t.getQualityString(100),qualityClass:t.getQualityClassname(100)}),ie("selectDownloadFileFormat",{action:"PNG"});break;default:throw new Error("unknown format")}t.calcSize()}))}},{key:"handleSaveFile",value:function(){var e=this.props.controller,t=this.state,n=t.fileName,a=t.quality,i=t.fileTypeId,o=n.trim();O.hasSupportedFileExt(o)&&(o=o.split(".").slice(0,-1).join(".")),e.saveImage(o,this.formatIds.get(i)||r.JPG,a)}},{key:"handleCancel",value:function(){this.props.controller.close()}},{key:"handleClose",value:function(){this.props.controller.close()}},{key:"handleNameChange",value:function(e){this.setState({fileName:e})}},{key:"handleQualityChange",value:function(e){this.setState({quality:e,qualityString:this.getQualityString(e),qualityClass:this.getQualityClassname(e)})}},{key:"getQualityString",value:function(e){var t=this.state.fileTypeId;return 100===e&&this.formatIds.get(t)===r.PNG?Ze("SaveAs.JPG.ExtremelyHighQuality","Extremely high quality image"):e>=80?Ze("SaveAs.JPG.GoodQuality","Good quality image"):e>=50?Ze("SaveAs.JPG.LowQuality","Low quality image"):Ze("SaveAs.JPG.ExtremelyLowQuality","Extremely low quality image")}},{key:"getQualityClassname",value:function(e){return e>=80?"quality-good":e>=50?"quality-low":"quality-extreme-low"}},{key:"calcSize",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a,i,o,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.imageData,n=this.state,a=n.quality,i=n.fileTypeId,o=null,(l=this.formatIds.get(i))!==r.JPG){e.next=10;break}return e.next=7,M.createBlob(t,"image/jpeg",a/100,"white");case 7:o=e.sent,e.next=14;break;case 10:if(l!==r.PNG){e.next=14;break}return e.next=13,M.createBlob(t,"image/png");case 13:o=e.sent;case 14:o&&this.setState({fileSize:O.humanFileSize(o.size)});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadImageData",value:function(){var e=this.props.targetFormat,t=this.props.imageData,n=M.hasAlpha(t)?this.getIdByFormat(r.PNG):this.getIdByFormat(r.JPG);e&&(n=this.getIdByFormat(e)),this.handleFileFormatChange(n),this.setState({imageWidth:t.width,imageHeight:t.height});var a=M.resizeImageDataToWidth(t,400);if(a){var i=document.createElement("canvas");i.width=a.width,i.height=a.height;var o=i.getContext("2d");if(o){o.putImageData(a,0,0);var s=i.toDataURL();this.imgRef&&this.imgRef.current&&(this.imgRef.current.style.backgroundImage="url(".concat(s,")"))}}}},{key:"hideTooltip",value:function(){this.setState({showTooltip:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.fileName,a=t.fileTypeId,r=t.quality,i=t.qualityString,o=t.qualityClass,s=t.fileSize,l=t.imageWidth,c=t.imageHeight,u=t.showTooltip,d=this.props.saveInitMode,h=g.a.createElement(Ie.a,{size:"XL"}),f=Ze("SaveAs.Title","Download Image");switch(d){case Ye.CONVERT:h=g.a.createElement(Re.a,{size:"XL"}),f=Ze("SaveAs.TitleConvert","Convert Image");break;case Ye.COMPRESS:h=g.a.createElement(Te.a,{size:"XL"}),f=Ze("SaveAs.TitleCompress","Compress Image")}return g.a.createElement(fe.a,{className:"image-edit-confirm"},g.a.createElement("div",{className:"dialog-close"},g.a.createElement(xe.a,{variant:"tool",onClick:function(){return e.handleClose()},icon:g.a.createElement(Oe.a,{style:{color:"var(--spectrum-global-color-gray-50)"}})})),g.a.createElement("div",null,g.a.createElement("div",{className:"base"},g.a.createElement("div",{className:"left",ref:this.imgRef}),g.a.createElement("div",{className:"right"},h,g.a.createElement("h1",null,f),g.a.createElement("section",{className:"saveas-section"},g.a.createElement(Se.a,{label:Ze("SaveAs.Filename","File name")},g.a.createElement(Ne.a,{value:n,onChange:function(t){return e.handleNameChange(t)}})),g.a.createElement(Se.a,{label:Ze("SaveAs.Fileformat","File format"),className:"file-format-label"},g.a.createElement(_e.TabView,{selectedIndex:a,onSelect:function(t){return e.handleFileFormatChange(t)}},g.a.createElement(_e.Tab,{label:Ze("SaveAs.Label.JPG","JPG"),className:"saveas-tab"},g.a.createElement(je.a,{placement:"top",show:u,delayHide:100,onClick:function(){e.hideTooltip()},onHide:function(){e.hideTooltip()}},g.a.createElement(Be.a,{renderLabel:!0,label:Ze("SaveAs.Quality","Quality"),className:"quality-slider",min:1,max:100,step:1,filled:!0,fillOffset:.01,value:r,onChange:function(t){return e.handleQualityChange(t)}}),g.a.createElement(Fe.a,{placement:"top"},Ze("SaveAs.Slider.Tooltip","Move slider to determine file size and image quality."))),g.a.createElement("div",null,Ze("SaveAs.Filesize","File size"),": ",s," - ",g.a.createElement("span",{className:o},i))),g.a.createElement(_e.Tab,{label:"PNG",className:"saveas-tab"},g.a.createElement("div",null,Ze("SaveAs.Filesize","File size"),": ",s," - ",g.a.createElement("span",{className:o},i))))),g.a.createElement(Se.a,{label:Ze("SaveAs.Dimensions","Dimensions"),labelFor:"dimension"},g.a.createElement("div",{id:"dimension"},l," \xd7 ",c," ",Ze("SaveAs.Label.Pixel","Pixel"))),g.a.createElement("div",{className:"saveas-buttons"},g.a.createElement(xe.a,{onClick:function(){return e.handleCancel()}},Ze("SaveAs.Button.Cancel","Cancel")),g.a.createElement(xe.a,{autoFocus:!0,onClick:function(){ie("downloadImage"),e.handleSaveFile()},className:"button-choosefile",variant:"cta"},Ze("SaveAs.Button.Download","Download"))))))))}}]),n}(v.PureComponent);!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.CONVERT=1]="CONVERT",e[e.COMPRESS=2]="COMPRESS"}(Ye||(Ye={}));var Xe,qe,Je=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).doc=void 0,a.dialogId=void 0,a.doc=e,a}return Object(u.a)(n,[{key:"show",value:function(){var e,t,n=K.getParams(),a=Ye.DEFAULT;switch(null===(e=n.globalAction)||void 0===e?void 0:e.action){case"convert":a=Ye.CONVERT;break;case"compress":a=Ye.COMPRESS}this.dialogId=j.a.show(g.a.createElement(Ke,{controller:this,imageData:this.doc.getImageData(),targetFormat:null===(t=n.globalAction)||void 0===t?void 0:t.targetFormat,saveInitMode:a}))}},{key:"close",value:function(){this.dialogId&&j.a.hide(this.dialogId)}},{key:"saveImage",value:function(e,t,n){this.doc.saveImage(e,t,n/100)&&(new Ee).showSurveyDownload(),this.close()}}]),n}(F),Qe=function(){function e(t,n){Object(c.a)(this,e),this.maxSteps=void 0,this.docPersister=void 0,this.inMemoryUndoStack=void 0,this.inMemoryUndoStack=t,this.docPersister=n,this.maxSteps=this.inMemoryUndoStack.maxSteps}return Object(u.a)(e,[{key:"getCurrent",value:function(){return this.inMemoryUndoStack.getCurrent()}},{key:"getLength",value:function(){return this.inMemoryUndoStack.getLength()}},{key:"clear",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.inMemoryUndoStack.clear(),this.docPersister.clear();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"canUndo",value:function(){return this.inMemoryUndoStack.canUndo()}},{key:"canRedo",value:function(){return this.inMemoryUndoStack.canRedo()}},{key:"undo",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.inMemoryUndoStack.undo(),this.docPersister.undo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"redo",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.inMemoryUndoStack.redo(),this.docPersister.redo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inMemoryUndoStack.add(t),e.abrupt("return",this.docPersister.add(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),$e=n(4),et=n(179),tt=n.n(et),nt=n(180),at=n.n(nt),rt=n(181),it=n.n(rt),ot=n(642),st=(n(420),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={hidden:!1,canZoomIn:!0,canZoomOut:!0,zoomValue:100,isPanning:!1},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setPanning",value:function(e){this.setState({isPanning:e})}},{key:"setZoomValue",value:function(e,t,n){this.setState({zoomValue:e,canZoomIn:t,canZoomOut:n})}},{key:"setHidden",value:function(e){this.setState({hidden:e})}},{key:"render",value:function(){var e=this.props.controller,t=this.state,n=t.canZoomIn,a=t.canZoomOut,r=t.zoomValue,i=t.isPanning,o=t.hidden?"stage-actions no-display":"stage-actions";return g.a.createElement("div",{className:o},g.a.createElement("div",{className:"zoom-bar"},g.a.createElement(je.a,{delayShow:1500},g.a.createElement(xe.a,{quiet:!0,variant:"action",icon:g.a.createElement(tt.a,null),selected:i,onClick:function(){e.togglePanning(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},className:i?"actions-button-selected":"actions-button"}),g.a.createElement(Fe.a,null,g.a.createElement(ot.a,null,(function(e){return g.a.createElement("p",null,e("Stage.PanAndZoom.HandTool","Drag image"))})))),g.a.createElement(xe.a,{quiet:!0,variant:"action",icon:g.a.createElement(it.a,null),disabled:!a,onClick:function(){e.zoomOut(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}}),g.a.createElement(xe.a,{quiet:!0,variant:"action",className:"zoom-text",onClick:function(){e.zoomToggleFit(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}},r,"%"),g.a.createElement(xe.a,{quiet:!0,variant:"action",icon:g.a.createElement(at.a,null),disabled:!n,onClick:function(){e.zoomIn(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}})))}}]),n}(v.PureComponent)),lt=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).stage=void 0,a.stage=e,a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(st,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewDidMount",this).call(this,e)}},{key:"viewWillUnmount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewWillUnmount",this).call(this,e)}},{key:"setPanning",value:function(e){var t;null===(t=this.getStageActionsView())||void 0===t||t.setPanning(e)}},{key:"setZoomValue",value:function(e,t,n){var a;null===(a=this.getStageActionsView())||void 0===a||a.setZoomValue(e,t,n)}},{key:"setHidden",value:function(e){var t;null===(t=this.getStageActionsView())||void 0===t||t.setHidden(e)}},{key:"togglePanning",value:function(){this.stage.togglePanning()}},{key:"zoomIn",value:function(){this.stage.zoomIn()}},{key:"zoomOut",value:function(){this.stage.zoomOut()}},{key:"zoomToggleFit",value:function(){this.stage.zoomFit()}},{key:"getStageActionsView",value:function(){return this.view}}]),n}(F);n(421);!function(e){e[e.CORE=1]="CORE",e[e.NORMAL=2]="NORMAL"}(Xe||(Xe={})),function(e){e[e.NONE=0]="NONE",e[e.ZOOMIN=1]="ZOOMIN",e[e.ZOOMOUT=2]="ZOOMOUT"}(qe||(qe={}));var ct=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).doc=void 0,a.canvas=void 0,a.maskCanvas=void 0,a.maskCanvasEmpty=void 0,a.toolLayer=void 0,a.containerSize=void 0,a.transformMode=void 0,a.transformOffset=void 0,a.transformScale=void 0,a.transformMatrix=void 0,a.isPanning=void 0,a.zoomStart=void 0,a.zoomMode=qe.NONE,a.startPanMouse=void 0,a.startPanPosition=void 0,a.panTracking=void 0,a.stageActions=void 0,$e.a.setMatrixArrayType(Array),a.doc=e,a.containerSize=$e.e.create(),a.transformMode=Xe.NORMAL,a.transformOffset=$e.e.create(),a.transformScale=1,a.transformMatrix=$e.b.create(),a.isPanning=!1,a.zoomStart=-1,a.startPanMouse=$e.e.create(),a.startPanPosition=$e.e.create(),a.panTracking=!1,a.maskCanvasEmpty=!0,a.stageActions=new lt(Object(d.a)(a)),a.onResize=a.onResize.bind(Object(d.a)(a)),a.onPointerDown=a.onPointerDown.bind(Object(d.a)(a)),a.onPointerMove=a.onPointerMove.bind(Object(d.a)(a)),a.onPointerUp=a.onPointerUp.bind(Object(d.a)(a)),a.onPointerEnter=a.onPointerEnter.bind(Object(d.a)(a)),a.onPointerOut=a.onPointerOut.bind(Object(d.a)(a)),a.onPointerLeave=a.onPointerLeave.bind(Object(d.a)(a)),a.onMouseWheel=a.onMouseWheel.bind(Object(d.a)(a)),a.onGestureStart=a.onGestureStart.bind(Object(d.a)(a)),a.onGestureChange=a.onGestureChange.bind(Object(d.a)(a)),a.onGestureEnd=a.onGestureEnd.bind(Object(d.a)(a)),a.onDrop=a.onDrop.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e);var t=document.createElement("div");t.id="stage-image-container",e.appendChild(t);var a=this.doc.getImageData();this.canvas=M.createHTMLCanvasElement(a),this.canvas.id="main-canvas",this.canvas.className="main-canvas",t.appendChild(this.canvas),this.maskCanvasEmpty=!0,this.maskCanvas=document.createElement("canvas"),this.maskCanvas.id="main-mask-canvas",this.maskCanvas.className="main-mask-canvas",t.appendChild(this.maskCanvas),this.toolLayer=document.createElement("div"),this.toolLayer.id="main-tool-layer",this.toolLayer.className="main-tool-layer",t.appendChild(this.toolLayer),this.containerSize[0]=e.clientWidth,this.containerSize[1]=e.clientHeight,window.addEventListener("resize",this.onResize),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),t.addEventListener("pointerenter",this.onPointerEnter),t.addEventListener("pointerout",this.onPointerOut),t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("wheel",this.onMouseWheel),t.addEventListener("gesturestart",this.onGestureStart),t.addEventListener("gesturechange",this.onGestureChange),t.addEventListener("gestureend",this.onGestureEnd),t.addEventListener("drop",this.onDrop),t.addEventListener("dragover",this.onDragOver),t.onselectstart=function(){return!1};var r=document.createElement("div");r.id="stage-actions-container",e.appendChild(r),this.stageActions.createView(r)}},{key:"destroyView",value:function(){if(this.stageActions.destroyView(),this.container){this.container.innerHTML="",window.removeEventListener("resize",this.onResize);var e=this.ensureHTMLElement("stage-image-container");e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),e.removeEventListener("pointerenter",this.onPointerEnter),e.removeEventListener("pointerout",this.onPointerOut),e.removeEventListener("pointerleave",this.onPointerLeave),e.removeEventListener("wheel",this.onMouseWheel),e.removeEventListener("gesturestart",this.onGestureStart),e.removeEventListener("gesturechange",this.onGestureChange),e.removeEventListener("gestureend",this.onGestureEnd)}Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"setTransformMode",value:function(e){this.transformMode=e}},{key:"getTransformOffset",value:function(){return this.transformOffset}},{key:"setTransformOffset",value:function(e){$e.e.copy(this.transformOffset,e)}},{key:"getTransformScale",value:function(){return this.transformScale}},{key:"setTransformScale",value:function(e){this.transformScale=e}},{key:"getTransformMatrix",value:function(){return this.transformMatrix}},{key:"setTransformMatrix",value:function(e){$e.b.copy(this.transformMatrix,e)}},{key:"centerContent",value:function(){this.transformMode===Xe.NORMAL&&this.canvas&&this.container&&(this.containerSize[0]=this.container.clientWidth,this.containerSize[1]=this.container.clientHeight,this.transformOffset[0]=(this.container.clientWidth-this.canvas.width*this.transformScale)/2,this.transformOffset[1]=(this.container.clientHeight-this.canvas.height*this.transformScale)/2,this.updateTransform())}},{key:"checkScroll",value:function(){if(this.transformMode===Xe.NORMAL&&this.canvas&&this.container){var e=this.transformOffset[0],t=this.transformOffset[1],n=this.canvas.width*this.transformScale,a=this.canvas.height*this.transformScale,r=this.container.clientWidth,i=this.container.clientHeight;n>r?(e>0&&(e=0),e+n<r&&(e=r-n)):e=(r-n)/2,a>i?(t>0&&(t=0),t+a<i&&(t=i-a)):t=(i-a)/2,this.transformOffset[0]=e,this.transformOffset[1]=t,this.updateTransform()}}},{key:"scrollContent",value:function(e,t){this.transformOffset[0]+=e,this.transformOffset[1]+=t,this.checkScroll()}},{key:"containerSizeChanged",value:function(){if(this.container){var e=this.container.clientWidth,t=this.container.clientHeight,n=this.containerSize[0]-e,a=this.containerSize[1]-t;this.containerSize[0]=e,this.containerSize[1]=t,this.transformMode===Xe.NORMAL&&(this.transformOffset[0]-=n/2,this.transformOffset[1]-=a/2,this.checkScroll()),this.doc.onContainerSizeChanged(e,t)}}},{key:"updateTransform",value:function(){var e=Math.floor(this.transformOffset[0]),t=Math.floor(this.transformOffset[1]);this.canvas&&(this.canvas.style.imageRendering=this.transformScale>=2?"pixelated":"auto",this.canvas.style.transformOrigin="".concat(0," ",0),this.transformMode===Xe.NORMAL&&(this.canvas.style.transform="translate(".concat(e,"px, ").concat(t,"px) scale(").concat(this.transformScale,")")),this.transformMode===Xe.CORE&&(this.canvas.style.transform="matrix(".concat(this.transformMatrix[0],", ").concat(this.transformMatrix[1],", ").concat(this.transformMatrix[2],", ").concat(this.transformMatrix[3],", ").concat(this.transformMatrix[4],", ").concat(this.transformMatrix[5],")"))),this.maskCanvas&&(this.maskCanvas.style.imageRendering=this.transformScale>=2?"pixelated":"auto",this.maskCanvas.style.transformOrigin="".concat(0," ",0),this.transformMode===Xe.NORMAL&&(this.maskCanvas.style.transform="translate(".concat(e,"px, ").concat(t,"px) scale(").concat(this.transformScale,")")),this.transformMode===Xe.CORE&&(this.maskCanvas.style.transform="matrix(".concat(this.transformMatrix[0],", ").concat(this.transformMatrix[1],", ").concat(this.transformMatrix[2],", ").concat(this.transformMatrix[3],", ").concat(this.transformMatrix[4],", ").concat(this.transformMatrix[5],")")));var n=this.doc.getCurrentEditor();n&&n.onStageTransformChanged()}},{key:"editorChanged",value:function(){this.container&&this.canvas&&this.containerSizeChanged(),this.setZoomMode(qe.NONE)}},{key:"setImageData",value:function(e){if(this.ensure2DCanvas(),this.canvas){this.canvas.width=e.width,this.canvas.height=e.height;var t=this.canvas.getContext("2d");null!==t&&t.putImageData(e,0,0),this.maskCanvas&&(this.maskCanvas.width=e.width,this.maskCanvas.height=e.height)}}},{key:"getCanvas",value:function(){return this.canvas}},{key:"setMaskData",value:function(e){if(this.canvas&&this.maskCanvas){var t=this.maskCanvas.getContext("2d");if(null!==t){if(!e)return t.clearRect(0,0,this.maskCanvas.width,this.maskCanvas.height),this.maskCanvasEmpty=!0,void(this.maskCanvas.style.opacity="0");if(e.width!==this.canvas.width||e.height!==this.canvas.height)return void console.error("mask size invalid",e.width,e.height,this.canvas.width,this.canvas.height);this.maskCanvas.width=e.width,this.maskCanvas.height=e.height,t.putImageData(e,0,0),this.maskCanvas.style.opacity="1",this.maskCanvasEmpty=!1}}}},{key:"getMaskCanvas",value:function(){return this.maskCanvas}},{key:"isMaskCanvasEmpty",value:function(){return this.maskCanvasEmpty}},{key:"getToolLayer",value:function(){return this.toolLayer}},{key:"togglePanning",value:function(){this.isPanning=!this.isPanning,this.stageActions.setPanning(this.isPanning),this.setZoomMode(qe.NONE),this.container&&(this.isPanning?(this.container.classList.add("cursor-pan"),this.doc.onPanModeStart()):(this.container.classList.remove("cursor-pan"),this.doc.onPanModeEnd()))}},{key:"setStageActionsVisible",value:function(e){this.stageActions.setHidden(!e)}},{key:"isPanningMode",value:function(){return this.isPanning}},{key:"setZoomFactor",value:function(e,t){if(t){var n=t[0],a=t[1],r=n+e*(this.transformOffset[0]-n)/this.transformScale,i=a+e*(this.transformOffset[1]-a)/this.transformScale;this.transformOffset[0]=r,this.transformOffset[1]=i,this.transformScale=e,this.checkScroll()}else this.transformScale=e,this.centerContent();this.stageActions.setZoomValue(Math.round(100*e),void 0!==this.getNextZoomIn(this.transformScale),void 0!==this.getNextZoomOut(this.transformScale)),this.onZoomChange(Math.round(100*e))}},{key:"getMaxZoom",value:function(){return n.zoomFactors[n.zoomFactors.length-1]/100}},{key:"getMinZoom",value:function(){return n.zoomFactors[0]/100}},{key:"getNextZoomIn",value:function(e){if(!(100*e>=n.zoomFactors[n.zoomFactors.length-1]))for(var t=n.zoomFactors.length-1;t>=0;t-=1)if(n.zoomFactors[t]<=100*e&&t<n.zoomFactors.length-1)return n.zoomFactors[t+1]/100}},{key:"getNextZoomOut",value:function(e){if(!(100*e<=n.zoomFactors[0]))for(var t=0;t<n.zoomFactors.length;t+=1)if(n.zoomFactors[t]>=100*e&&t>0)return n.zoomFactors[t-1]/100}},{key:"getZoomFactor",value:function(){return this.transformScale}},{key:"zoomIn",value:function(){var e,t=this.getNextZoomIn(this.transformScale);if(this.container){var n=this.container.clientWidth/2,a=this.container.clientHeight/2;e=$e.e.fromValues(n,a)}void 0!==t&&this.setZoomFactor(t,e)}},{key:"zoomOut",value:function(){var e,t=this.getNextZoomOut(this.transformScale);if(this.container){var n=this.container.clientWidth/2,a=this.container.clientHeight/2;e=$e.e.fromValues(n,a)}void 0!==t&&this.setZoomFactor(t,e)}},{key:"zoomToggleFit",value:function(){1===this.transformScale?this.zoomFit():this.setZoomFactor(1)}},{key:"zoomFit",value:function(){var e=this.doc.getImageData(),t=e.width,n=e.height,a=this.containerSize[0]/t,r=this.containerSize[1]/n,i=Math.min(a,r);if(i<1){var o,s,l=null!==(o=this.getNextZoomOut(null!==(s=this.getNextZoomIn(i))&&void 0!==s?s:i))&&void 0!==o?o:1;this.setZoomFactor(l)}else this.setZoomFactor(1)}},{key:"doPointerZoom",value:function(e){var t,n=this.eventToLocal(e);switch(this.zoomMode){case qe.ZOOMIN:t=this.getNextZoomIn(this.transformScale);break;case qe.ZOOMOUT:t=this.getNextZoomOut(this.transformScale);break;default:return}void 0!==t&&this.setZoomFactor(t,n)}},{key:"getZoomMode",value:function(){return this.zoomMode}},{key:"setZoomMode",value:function(e){if(this.zoomMode=e,this.container)switch(this.container.classList.remove("cursor-zoom-out"),this.container.classList.remove("cursor-zoom-in"),e){case qe.ZOOMIN:this.isPanningMode()&&this.togglePanning(),this.container.classList.add("cursor-zoom-in"),this.doc.onZoomModeStart();break;case qe.ZOOMOUT:this.container.classList.add("cursor-zoom-out");break;case qe.NONE:this.doc.onZoomModeEnd()}}},{key:"ensure2DCanvas",value:function(){this.canvas&&null!==this.canvas.getContext("2d")||(this.canvas=this.createNewCanvas(),this.canvas.getContext("2d"))}},{key:"ensureWebGLCanvas",value:function(e){!e&&this.canvas&&null!==this.canvas.getContext("webgl")||(this.canvas=this.createNewCanvas(),this.canvas.getContext("webgl",e))}},{key:"createNewCanvas",value:function(){var e,t=document.createElement("canvas");t.id="main-canvas",t.className="main-canvas";var n=this.doc.getImageData();t.width=n.width,t.height=n.height;var a=null===(e=this.container)||void 0===e?void 0:e.firstChild;return this.canvas&&(null===a||void 0===a?void 0:a.contains(this.canvas))?null===a||void 0===a||a.replaceChild(t,this.canvas):null===a||void 0===a||a.appendChild(t),t}},{key:"eventToLocal",value:function(e){var t=this.container;if(null==t)return $e.e.create();var n=0,a=0;for(a=0;null!=t;n+=t.offsetLeft,a+=t.offsetTop,t=t.offsetParent);var r=$e.e.fromValues(e.clientX,e.clientY);return r[0]-=n-window.pageXOffset,r[1]-=a-window.pageYOffset,r}},{key:"eventToStage",value:function(e){var t=this.eventToLocal(e),n=$e.e.create();return this.transformMode===Xe.NORMAL&&(n[0]=(t[0]-this.transformOffset[0])/this.transformScale,n[1]=(t[1]-this.transformOffset[1])/this.transformScale),this.transformMode===Xe.CORE&&$e.e.transformMat2d(n,t,$e.b.invert($e.b.create(),this.transformMatrix)),n}},{key:"pointToStage",value:function(e){var t=$e.e.create();return this.transformMode===Xe.NORMAL&&(t[0]=(e[0]-this.transformOffset[0])/this.transformScale,t[1]=(e[1]-this.transformOffset[1])/this.transformScale),this.transformMode===Xe.CORE&&$e.e.transformMat2d(t,e,$e.b.invert($e.b.create(),this.transformMatrix)),t}},{key:"pointFromStage",value:function(e){var t=$e.e.create();return this.transformMode===Xe.NORMAL&&(t[0]=e[0]*this.transformScale+this.transformOffset[0],t[1]=e[1]*this.transformScale+this.transformOffset[1]),this.transformMode===Xe.CORE&&$e.e.transformMat2d(t,e,this.transformMatrix),t}},{key:"onResize",value:function(e){this.containerSizeChanged()}},{key:"onPointerDown",value:function(e){e.target instanceof Element&&e.target.setPointerCapture(e.pointerId),this.zoomMode!==qe.NONE&&this.doPointerZoom(e),this.isPanning?(this.startPanMouse=this.eventToLocal(e),this.startPanPosition=$e.e.clone(this.transformOffset),this.panTracking=!0):this.doc.onPointerDown(e)}},{key:"onPointerMove",value:function(e){var t;if(this.isPanning&&this.panTracking){var n=this.eventToLocal(e);this.transformOffset[0]=this.startPanPosition[0]+n[0]-this.startPanMouse[0],this.transformOffset[1]=this.startPanPosition[1]+n[1]-this.startPanMouse[1],this.checkScroll()}this.isPanning&&this.panTracking&&!(null===(t=this.doc.getCurrentEditor())||void 0===t?void 0:t.needsAlwaysPointerTracking())||this.doc.onPointerMove(e)}},{key:"onPointerUp",value:function(e){e.target instanceof Element&&e.target.releasePointerCapture(e.pointerId),this.isPanning&&this.panTracking?this.panTracking=!1:this.doc.onPointerUp(e)}},{key:"onPointerEnter",value:function(e){this.doc.onPointerEnter(e)}},{key:"onPointerOut",value:function(e){this.doc.onPointerOut(e)}},{key:"onPointerLeave",value:function(e){this.doc.onPointerLeave(e)}},{key:"onMouseWheel",value:function(e){if(this.transformMode===Xe.NORMAL)if(e.ctrlKey||e.altKey){e.preventDefault();var t=this.eventToLocal(e),n=this.transformScale-.01*e.deltaY*this.transformScale;n<this.getMinZoom()&&(n=this.getMinZoom()),n>this.getMaxZoom()&&(n=this.getMaxZoom()),this.setZoomFactor(n,t)}else e.preventDefault(),this.scrollContent(-e.deltaX,-e.deltaY)}},{key:"onGestureStart",value:function(e){e.preventDefault(),this.transformMode===Xe.NORMAL&&-1===this.zoomStart&&(this.zoomStart=this.transformScale)}},{key:"onGestureChange",value:function(e){if(e.preventDefault(),this.transformMode===Xe.NORMAL){var t=this.eventToLocal(e),n=this.zoomStart*e.scale;n<this.getMinZoom()&&(n=this.getMinZoom()),n>this.getMaxZoom()&&(n=this.getMaxZoom()),this.setZoomFactor(n,t)}}},{key:"onGestureEnd",value:function(e){e.preventDefault(),this.transformMode===Xe.NORMAL&&(this.zoomStart=-1)}},{key:"onZoomChange",value:function(e){this.doc.onZoomChange(e)}},{key:"onDrop",value:function(e){if(e.preventDefault(),e.dataTransfer){var t=e.dataTransfer.files.item(0);if(t){if(!Et.isAllowedMimetype(t.type))return Object(E.error)(Ze("Importer.DragAndDrop.ErrorToast.Message","Sorry - this file type is currently not supported."),{timeout:3e3}),void ie("imageUploadFailed",{action:"dragDrop",error:"incorrectFileFormat",doc:{mimeType:t.type}});ie("imageUploadSuccess",{action:"dragDrop",doc:{action:"store",mimeType:t.type,id:V()()}}),this.doc.openDragImage(t)}}}},{key:"onDragOver",value:function(e){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")}}],[{key:"getMaxCanvasSizes",value:function(){if(0===n.maxWidth||0===n.maxHeight){var e=M.getMaxViewportDimsWebGl();n.maxWidth=e?Math.min(e[0],5120):5120,n.maxHeight=e?Math.min(e[1],5120):5120}return[n.maxWidth,n.maxHeight]}}]),n}(F);ct.maxWidth=0,ct.maxHeight=0,ct.zoomFactors=[1,1.5,2,3,4,5,12.5,25,100/3,50,100/3*2,100,150,200,250,300,400,600,800];var ut=function(){function e(t,n){Object(c.a)(this,e),this.steps=void 0,this.currentStep=void 0,this.maxSteps=void 0,this.steps=new Array,this.steps.push(t),this.currentStep=0,this.maxSteps=n}return Object(u.a)(e,[{key:"getCurrent",value:function(){return this.steps[this.currentStep]}},{key:"getLength",value:function(){return this.steps.length}},{key:"clear",value:function(){this.steps=new Array,this.currentStep=0}},{key:"add",value:function(e){this.currentStep<this.steps.length-1&&this.steps.splice(this.currentStep+1),this.steps.push(e),this.currentStep+=1,this.steps.length>this.maxSteps&&(this.steps.splice(0,1),this.currentStep-=1)}},{key:"canUndo",value:function(){return this.currentStep>0}},{key:"undo",value:function(){this.currentStep>0&&(this.currentStep-=1)}},{key:"canRedo",value:function(){return this.currentStep<this.getLength()-1}},{key:"redo",value:function(){this.currentStep<this.getLength()-1&&(this.currentStep+=1)}},{key:"setCurrentStep",value:function(e){e<this.getLength()&&(this.currentStep=e)}}]),e}(),dt=n(120),ht=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"openSessionDB",value:function(){var t=Object(l.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n||e.getSessionDBName()||"".concat(e.DB_NAME_PREFIX).concat(V()()),sessionStorage.setItem(e.DB_NAME_KEY,a),localStorage.setItem("_dbName_".concat(a),JSON.stringify({timestamp:Date.now(),active:!0})),t.abrupt("return",Object(dt.b)(a,e.dbVersion,{upgrade:function(e,t,n){console.debug("upgrading the object store form version ".concat(t," to version ").concat(n)),e.objectStoreNames.contains("undostack")&&e.deleteObjectStore("undostack"),e.objectStoreNames.contains("props")&&e.deleteObjectStore("props"),e.createObjectStore("undostack",{autoIncrement:!1}),t<=2&&e.createObjectStore("props")},terminated:function(){e.onClose()}}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getSessionDBName",value:function(){return sessionStorage.getItem(e.DB_NAME_KEY)}},{key:"getSessionDBs",value:function(){for(var t=new Array,n=0;n<localStorage.length;n+=1){var a=localStorage.key(n);if(null===a||void 0===a?void 0:a.startsWith("_dbName_".concat(e.DB_NAME_PREFIX))){var r=a.substring("_dbName_".length);if(r&&r!==e.getSessionDBName()){var i=this.getSessionDBInfo(r),o=i.timestamp||-1,s=i.active&&Date.now()-6048e5<o;t.push({dbName:r,timestamp:o,active:s})}}}for(var l=new Array,c=new Array,u=t.sort((function(e,t){return e.timestamp<t.timestamp?1:-1})),d=0;d<u.length;d+=1){var h=u[d];h&&(h.active?l.push({name:h.dbName,timestamp:h.timestamp}):c.push({name:h.dbName,timestamp:h.timestamp}))}return{opened:l,closed:c}}},{key:"getSessionDBInfo",value:function(e){var t=JSON.parse(localStorage.getItem("_dbName_".concat(e))||"{}");return{timestamp:t.timestamp||-1,active:t.active}}},{key:"getActiveSessionDB",value:function(){var t=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.database){t.next=4;break}return t.next=3,e.openSessionDB();case 3:e.database=t.sent;case 4:return t.abrupt("return",{sessionDB:e.database,timestamp:e.getSessionDBInfo(e.database.name).timestamp});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getLastClosedSessionDB",value:function(){var t=Object(l.a)(s.a.mark((function t(){var n,a,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=null===(n=e.getSessionDBs())||void 0===n?void 0:n.closed)||!a[0]){t.next=6;break}return t.next=4,e.openSessionDB(a[0].name);case 4:return r=t.sent,t.abrupt("return",{sessionDB:r,timestamp:a[0].timestamp});case 6:return t.abrupt("return",Promise.reject());case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"onClose",value:function(){if(e.hasValidSessionDB()){localStorage.setItem("_dbName_".concat(e.getSessionDBName()),JSON.stringify({timestamp:Date.now(),active:!1}));try{var t;null===(t=e.database)||void 0===t||t.close()}catch(n){console.debug("error while closing session DB")}e.database=null}}},{key:"cleanupUnusedSessionDBs",value:function(){for(var t=e.getSessionDBs(),n=0;n<t.closed.length;n+=1)Object(dt.a)(t.closed[n].name),localStorage.removeItem("_dbName_".concat(t.closed[n].name))}},{key:"hasValidSessionDB",value:function(){return null!==sessionStorage.getItem(e.DB_NAME_KEY)}},{key:"switchToSessionDB",value:function(){var t=Object(l.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=12;break}return e.onClose(),t.prev=2,t.next=5,e.openSessionDB(n);case 5:e.database=t.sent,t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(2),console.error("Error while switching the database: ".concat(t.t0)),t.abrupt("return",!1);case 12:return t.abrupt("return",!0);case 13:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}()}]),e}();ht.dbVersion=3,ht.DB_NAME_PREFIX="fps-",ht.DB_NAME_KEY="fps_db",ht.database=null;var ft=function(){function e(t){Object(c.a)(this,e),this.maxSteps=void 0,this.currentStep=void 0,this.endStep=void 0,this.startStep=void 0,this.maxSteps=t,this.currentStep=-1,this.endStep=-1,this.startStep=0}return Object(u.a)(e,[{key:"getCurrent",value:function(){throw new Error("method not implemented")}},{key:"clear",value:function(){var t=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.clearAll();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"add",value:function(){var t=Object(l.a)(s.a.mark((function t(n){var a,r,i,o,l,c,u,d,h=arguments;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=h.length>1&&void 0!==h[1]?h[1]:void 0,r=h.length>2&&void 0!==h[2]?h[2]:void 0,i=h.length>3&&void 0!==h[3]?h[3]:void 0,o=h.length>4&&void 0!==h[4]&&h[4],l=-1,c=-1,!o){t.next=11;break}return t.next=9,this.clear();case 9:t.next=13;break;case 11:this.getLength()+1>this.maxSteps&&this.currentStep===this.endStep&&(l=this.startStep,this.startStep+=1,this.currentStep=Math.max(this.currentStep,this.startStep)),this.currentStep<this.endStep&&(c=this.currentStep+1,this.endStep=this.currentStep);case 13:return this.currentStep+=1,this.endStep+=1,localStorage.setItem(e.LS_CURRENT_STEP_KEY,this.currentStep.toString()),localStorage.setItem(e.LS_START_STEP_KEY,this.startStep.toString()),localStorage.setItem(e.LS_END_STEP_KEY,this.endStep.toString()),null!=a&&localStorage.setItem(e.LS_FILE_NAME_KEY,a),r&&localStorage.setItem(e.LS_FILE_TYPE_KEY,r),null!=i&&localStorage.setItem(e.LS_IS_SAMPLE_IMAGE_KEY,String(i)),t.next=23,ht.getActiveSessionDB();case 23:return u=t.sent.sessionDB,(d=u.transaction(["undostack"],"readwrite")).objectStore("undostack").put(M.createHTMLCanvasElement(n).toDataURL(r),this.currentStep),l>=0&&d.objectStore("undostack").delete(l),c>=0&&d.objectStore("undostack").delete(IDBKeyRange.lowerBound(c,!0)),t.next=30,d.done;case 30:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"undo",value:function(){var t=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.canUndo()&&(this.currentStep-=1,localStorage.setItem(e.LS_CURRENT_STEP_KEY,this.currentStep.toString()),Promise.resolve());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"redo",value:function(){var t=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.canRedo()&&(this.currentStep+=1,localStorage.setItem(e.LS_CURRENT_STEP_KEY,this.currentStep.toString()),Promise.resolve());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"restore",value:function(){var t=Object(l.a)(s.a.mark((function t(n){var a,r,i,o,l,c,u,d,h,f,p,m,v,g,b,y,E;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ht.switchToSessionDB(n);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",Promise.resolve(null));case 4:if(a=localStorage.getItem(e.LS_END_STEP_KEY),r=localStorage.getItem(e.LS_START_STEP_KEY),a&&r){t.next=8;break}return t.abrupt("return",Promise.resolve(null));case 8:return i=Number.parseInt(a,10),o=Number.parseInt(r,10),l=[],t.next=13,ht.getActiveSessionDB();case 13:for(c=t.sent.sessionDB,u=c.transaction(["undostack"],"readonly"),d=o;d<=i;d+=1)l.push(u.objectStore("undostack").get(d));return t.next=18,u.done;case 18:return h=[],t.next=21,Promise.all(l).then((function(e){h=e.filter(Boolean)}));case 21:if(f=localStorage.getItem(e.LS_CURRENT_STEP_KEY),p=localStorage.getItem(e.LS_FILE_NAME_KEY),m=localStorage.getItem(e.LS_FILE_TYPE_KEY),v=localStorage.getItem(e.LS_IS_SAMPLE_IMAGE_KEY),0!==h.length&&v&&p&&m&&f){t.next=27;break}return t.abrupt("return",Promise.resolve(null));case 27:for(this.endStep=i,this.startStep=o,this.currentStep=parseInt(f,10),g=[],b=0;b<h.length;b+=1)(y=h[b])&&g.push(M.createImageData(y));return E=[],t.next=35,Promise.all(g).then((function(e){E=e}));case 35:return t.abrupt("return",Promise.resolve({imageDatas:E,currentIndex:this.currentStep,fileName:p,fileType:m,isSampleImage:"true"===v}));case 36:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"canRedo",value:function(){return this.currentStep<this.endStep}},{key:"canUndo",value:function(){return this.currentStep>this.startStep}},{key:"getLength",value:function(){return this.endStep-this.startStep+1}}],[{key:"getLastStoredDocument",value:function(){var t=Object(l.a)(s.a.mark((function t(){var n,a,r,i,o,l,c,u,d;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n={},a=!1,!ht.hasValidSessionDB()){t.next=9;break}return t.next=6,ht.getActiveSessionDB();case 6:n=t.sent,t.next=13;break;case 9:return t.next=11,ht.getLastClosedSessionDB();case 11:n=t.sent,a=!0;case 13:return r=Number.parseInt(localStorage.getItem(e.LS_CURRENT_STEP_KEY)||"0",10),i=n.sessionDB.transaction(["undostack"],"readonly"),o=i.objectStore("undostack").get(r),t.next=18,i.done;case 18:return a&&n.sessionDB.close(),l=localStorage.getItem(e.LS_FILE_NAME_KEY),c=localStorage.getItem(e.LS_IS_SAMPLE_IMAGE_KEY),t.next=23,o;case 23:if(u=t.sent,l&&c&&u){t.next=26;break}return t.abrupt("return",Promise.reject());case 26:return t.next=28,M.createImageData(u);case 28:return d=t.sent,t.abrupt("return",Promise.resolve({imageData:d,fileName:l,sessionDBName:n.sessionDB.name,timestamp:n.timestamp,isSampleImage:"true"===c}));case 32:return t.prev=32,t.t0=t.catch(0),t.abrupt("return",Promise.reject());case 35:case"end":return t.stop()}}),t,null,[[0,32]])})));return function(){return t.apply(this,arguments)}}()},{key:"clearAll",value:function(){var t=Object(l.a)(s.a.mark((function t(){var n,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ht.getActiveSessionDB();case 2:return n=t.sent.sessionDB,ht.cleanupUnusedSessionDBs(),(a=n.transaction(["undostack"],"readwrite")).objectStore("undostack").clear(),t.next=8,a.done;case 8:e.clearLocalStorageValues();case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"clearLocalStorageValues",value:function(){localStorage.removeItem(e.LS_CURRENT_STEP_KEY),localStorage.removeItem(e.LS_START_STEP_KEY),localStorage.removeItem(e.LS_END_STEP_KEY),localStorage.removeItem(e.LS_FILE_NAME_KEY),localStorage.removeItem(e.LS_FILE_TYPE_KEY),localStorage.removeItem(e.LS_IS_SAMPLE_IMAGE_KEY)}}]),e}();ft.LS_START_STEP_KEY="fps_pus_start",ft.LS_END_STEP_KEY="fps_pus_end",ft.LS_CURRENT_STEP_KEY="fps_pus_current",ft.LS_FILE_NAME_KEY="fps_pus_name",ft.LS_FILE_TYPE_KEY="fps_pus_type",ft.LS_IS_SAMPLE_IMAGE_KEY="fps_pus_sample";var pt=function(){function e(){Object(c.a)(this,e),this.staticData=void 0,this.isConsentGiven=!1,this.staticData=Object(X.a)(Object(X.a)({},this.getSourceData()),this.getEnvironmentData())}return Object(u.a)(e,null,[{key:"getInstance",value:function(){return e.instance}}]),Object(u.a)(e,[{key:"track",value:function(e,t,n,a){var r=this;var i=Object(X.a)(Object(X.a)(Object(X.a)(Object(X.a)(Object(X.a)(Object(X.a)(Object(X.a)({},this.getDefaultEventData(e)),e),a),t),this.staticData),this.getUserData()),n),o={events:[{project:"ps-web-service",environment:"prod",time:(new Date).toISOString(),ingesttype:"dunamis",data:i}]};if(this.isTrackingConsentGiven()){if(this.sendTrackingData(o),sessionStorage.getItem("usertracking-cache")){var s=sessionStorage.getItem("usertracking-cache");JSON.parse(s||"[]").forEach((function(e){return r.sendTrackingData(e)})),sessionStorage.removeItem("usertracking-cache")}}else{var l=sessionStorage.getItem("usertracking-cache"),c=JSON.parse(l||"[]");c.push(o),sessionStorage.setItem("usertracking-cache",JSON.stringify(c))}}},{key:"trackError",value:function(e,t){this.track(e,void 0,void 0,t)}},{key:"sendTrackingData",value:function(e){fetch("".concat("https://cc-api-data.adobe.io","/ingest"),{method:"POST",headers:{"x-api-key":"ps-web-service","content-type":"application/json"},body:JSON.stringify(e)}).then((function(e){200!==e.status&&console.error(e.statusText)})).catch((function(e){console.log(e)}))}},{key:"getDefaultEventData",value:function(e){var t;return{"event.guid":V.a.v4(),"event.category":"WEB","event.dts_end":(new Date).toISOString(),"event.user_agent":navigator.userAgent,"event.language":O.getNormalizedCurrentLocale(),"event.session_guid":this.getSessionId(),"event.mcid_guid":this.getVisitorGuid(),"event.url":window.location.href,"event.referrer":window.document.referrer,"event.pagename":"webApp:photoshop.adobe.com:".concat(e["event.type"],":").concat(e["event.subtype"]),"event.user_guid":null===(t=P.getInstance().getUserProfile())||void 0===t?void 0:t.userId,"event.visitor_guid":this.getVisitorGuid()}}},{key:"getSourceData",value:function(){var e=new i.UAParser;return{"source.client_id":"ps-frictionless-web","source.name":"Agedashi","source.version":"1.0","source.platform":"Web","source.device":e.getDevice().type||"desktop","source.os_version":e.getOS().version}}},{key:"getEnvironmentData",value:function(){var e=new i.UAParser;return{"env.com.name":e.getBrowser().name,"env.com.version":e.getBrowser().version}}},{key:"getUserData",value:function(){var e;if(!P.getInstance().isSignedInUser())return{};var t=null===(e=P.getInstance().getUserProfile())||void 0===e?void 0:e.serviceAccounts.find((function(e){return"creative_cloud"===e.serviceCode}));return{"user.service_code":null===t||void 0===t?void 0:t.serviceCode,"user.service_level":null===t||void 0===t?void 0:t.serviceLevel}}},{key:"getSessionId",value:function(){var e=window.sessionStorage.getItem("usertracking-sessionId");return e||(e=V.a.v4(),window.sessionStorage.setItem("usertracking-sessionId",e)),e}},{key:"isTrackingConsentGiven",value:function(){return this.isConsentGiven||(this.isConsentGiven=window._satellite&&"function"===typeof window._satellite.getVar&&"true"===window._satellite.getVar("isConsentGiven").toString()),this.isConsentGiven}},{key:"getVisitorGuid",value:function(){var e=window.sessionStorage.getItem("usertracking-vistorId");if(!e){try{window._satellite&&"function"===typeof window._satellite.getVisitorId&&window._satellite.getVisitorId().isAllowed()&&(e=window._satellite.getVisitorId().getAnalyticsVisitorID()||window._satellite.getVisitorId().getMarketingCloudVisitorID())}catch(t){}e||(e=V()()),window.sessionStorage.setItem("usertracking-vistorId",e)}return e}}]),e}();pt.instance=new pt;var mt=n(90),vt=n.n(mt),gt=n(47),bt=n.n(gt),yt=(n(431),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).inputFileRef=void 0,a.mounted=void 0,a.handleFileInputChange=function(e){var t=a.props.controller,n=e.target.files;if(n&&n[0]){if(!Et.isAllowedMimetype(n[0].type))return Object(E.error)(Ze("Importer.DragAndDrop.ErrorToast.Message","Sorry - this file type is currently not supported."),{timeout:5e3}),void ie("imageUploadFailed",{action:"fileInput",error:"incorrectFileFormat",doc:{mimeType:n[0].type}});t.startReadFile(n[0],n[0].name,n[0].type,!1)}},a.onDrop=function(e){var t=a.props.controller;if(e.dataTransfer){var n=e.dataTransfer.files.item(0);if(n){if(!Et.isAllowedMimetype(n.type))return Object(E.error)(Ze("Importer.DragAndDrop.ErrorToast.Message","Sorry - this file type is currently not supported."),{timeout:5e3}),void ie("imageUploadFailed",{action:"dragDrop",error:"incorrectFileFormat",doc:{mimeType:n.type}});t.startReadFile(n,n.name,n.type,!1),ie("imageUploadSuccess",{action:"dragDrop",doc:{action:"store",mimeType:n.type,id:V()()}})}}},a.onSampleImageClick=function(e){var t=a.props.controller,n=e.currentTarget.dataset.fullimg||"",r=n.split("/")[n.split("/").length-1],i=V()(),o=e.currentTarget.dataset.position;ie("sampleImageClick",{doc:{action:"store",mimeType:"image/jpeg",isSampleImage:!0,sampleImagePosition:parseInt(o||"0",10),id:i}}),t.startReadFile(n,r,"image/jpeg",!0)},a.onFileInputClick=function(){ie("chooseFile"),null!==a.inputFileRef.current&&a.inputFileRef.current.click()},a.state={previousDoc:void 0},a.inputFileRef=g.a.createRef(),a.mounted=!1,a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.controller;t.viewDidMount(this),this.mounted=!0,t.getPreviousDocument().then((function(t){var n={dataURI:t.dataURI,fileName:t.fileName,sessionDBName:t.sessionDBName,timestamp:t.timestamp,isSampleImage:t.isSampleImage,isRestoring:!1};e.mounted&&e.setState({previousDoc:n})})).catch((function(){})),se("importer:modal")}},{key:"componentWillUnmount",value:function(){var e=this.props.controller;this.mounted=!1,e.viewWillUnmount(this),this.setState({previousDoc:void 0}),ce("importer:modal")}},{key:"refresh",value:function(){}},{key:"renderSampleImages",value:function(){var e=this,t=this.getSampleImages();return t?t.map((function(t,n){return g.a.createElement("button",{type:"button",key:t.thumb,className:"sample-image",onClick:e.onSampleImageClick,"data-fullimg":t.full,"data-position":n+1},g.a.createElement("img",{alt:t.alt,width:"100",height:"100",src:t.thumb}))})):[]}},{key:"getSampleImages",value:function(){return[{alt:"Sample 1",thumb:"/assets/sample_1_thumb.jpg",full:"/assets/sample_1.jpg"},{alt:"Sample 2",thumb:"/assets/sample_2_thumb.jpg",full:"/assets/sample_2.jpg"},{alt:"Sample 3",thumb:"/assets/sample_3_thumb.jpg",full:"/assets/sample_3.jpg"}]}},{key:"getImporterHeadingText",value:function(){var e=this.props,t=e.importInitMode,n=e.sourceFormat,r=e.editorId;switch(t){case Ye.CONVERT:switch(n){case a.JPG:return Ze("Importer.Title.DragAndDropYourFiles.Convert.JPG","Select a jpeg image to convert");case a.PNG:return Ze("Importer.Title.DragAndDropYourFiles.Convert.PNG","Select a png image to convert");case a.SVG:return Ze("Importer.Title.DragAndDropYourFiles.Convert.SVG","Select an svg image to convert");default:return Ze("Importer.Title.DragAndDropYourFiles.Convert.Default","Select an image to convert")}case Ye.COMPRESS:return Ze("Importer.Title.DragAndDropYourFiles.Compress","Select an image to compress")}switch(r){case T.crop:return Ze("Importer.Title.DragAndDropYourFiles.Crop","Select an image to crop");case T.resize:return Ze("Importer.Title.DragAndDropYourFiles.Resize","Select an image to resize");case T.adjust:return Ze("Importer.Title.DragAndDropYourFiles.Adjust","Select an image to adjust");case T.spotheal:return Ze("Importer.Title.DragAndDropYourFiles.SpotHeal","Select an image to retouch");case T.cutout:return Ze("Importer.Title.DragAndDropYourFiles.Cutout","Select an image to remove background");default:return Ze("Importer.Title.DragAndDropYourFiles.NoEditorSelected","Select an image to edit")}}},{key:"getImporterTitleText",value:function(){return Ze(this.props.editorId?"Importer.Description.DragAndDropYourFiles.WithSelectedEditor":"Importer.Description.DragAndDropYourFiles.NoEditorSelected","Drag and drop a file here, or select a file from your device.")}},{key:"importPreviousEdit",value:function(){var e=this,t=this.state.previousDoc,n=this.props.controller;t&&!t.isRestoring&&(t.isRestoring=!0,this.setState({previousDoc:t}),n.restorePreviousDocument(t.sessionDBName).catch((function(){e.mounted&&(t.isRestoring=!1,e.setState({previousDoc:t}))})))}},{key:"render",value:function(){var e=this.props,t=e.controller;return e.dialog?g.a.createElement(fe.a,{className:"importer-dialog"},g.a.createElement("div",{className:"dialog-close"},g.a.createElement(xe.a,{variant:"tool",onClick:function(){return t.close()},icon:g.a.createElement(Oe.a,{style:{color:"var(--spectrum-global-color-gray-50)"}})})),this.renderImporter()):g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:"outer-container"},this.renderImporter(!0)),g.a.createElement("div",{className:"legal-notice-importer"},g.a.createElement(xe.a,{quiet:!0,variant:"action",onClick:function(){return t.toggleFooter()},className:"button-legal-notice"},Ze("Footer.title","Legal Notices"))))}},{key:"getAcceptedFileExt",value:function(e){switch(e){case a.JPG:return".jpg,.jpeg";case a.PNG:return".png";case a.SVG:return".svg";default:return".jpg,.jpeg,.png,.svg"}}},{key:"renderImporter",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.state.previousDoc,a=this.props,r=a.importInitMode,i=a.sourceFormat;return g.a.createElement("div",{className:"drop"},g.a.createElement(vt.a,{onDrop:this.onDrop,className:"drop-zone"},g.a.createElement("h1",null,this.getImporterHeadingText()),g.a.createElement("p",{className:"subtitle"},this.getImporterTitleText()),g.a.createElement(xe.a,{className:"button-choosefile",variant:"cta",onClick:this.onFileInputClick},Ze("Importer.Button.ChooseFile","Upload file")),g.a.createElement("input",{type:"file",id:"file-upload",accept:this.getAcceptedFileExt(i),ref:this.inputFileRef,onChange:this.handleFileInputChange,style:{display:"none"}}),!r&&g.a.createElement("div",{className:"sample-files"},g.a.createElement("p",null,Ze("Importer.Title.OrSelectSampleImage","Or select a sample image")),this.renderSampleImages()),!r&&t&&n&&g.a.createElement("div",null,g.a.createElement("p",null,Ze("Importer.LandingPage.PreviousEdit","Or continue working on your previous edit")),g.a.createElement("button",{type:"button",onClick:function(){return e.importPreviousEdit()},className:"previous-image"},g.a.createElement("img",{src:n.dataURI,alt:n.fileName,style:{objectFit:"cover"}})),n.isRestoring&&g.a.createElement(bt.a,{centered:!0}))))}}]),n}(v.PureComponent)),Et=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a){var r;return Object(c.a)(this,n),(r=t.call(this)).app=void 0,r.dialogId=void 0,r.editorId=void 0,r.app=e,r.editorId=a,r}return Object(u.a)(n,[{key:"createView",value:function(e){var t,a;Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e);var r=K.getParams(),i=Ye.DEFAULT;switch(null===(t=r.globalAction)||void 0===t?void 0:t.action){case"convert":i=Ye.CONVERT;break;case"compress":i=Ye.COMPRESS}y.a.render(g.a.createElement(yt,{controller:this,dialog:!1,sourceFormat:null===(a=r.globalAction)||void 0===a?void 0:a.sourceFormat,importInitMode:i}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"show",value:function(){this.dialogId=j.a.show(g.a.createElement(yt,{controller:this,dialog:!0,editorId:this.editorId}))}},{key:"close",value:function(){this.dialogId&&j.a.hide(this.dialogId)}},{key:"toggleFooter",value:function(){this.app.getFooter().toggleFooter()}},{key:"startReadFile",value:function(){var e=Object(l.a)(s.a.mark((function e(t,a,r,i){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.close(),e.abrupt("return",n.readFile(this.app,t,a,r,i));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"restorePreviousDocument",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,a,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ft(10),e.next=3,n.restore(t);case 3:if(!(a=e.sent)){e.next=9;break}for(r=new ut(a.imageDatas[0],10),i=1;i<a.imageDatas.length;i+=1)r.add(a.imageDatas[i]);return r.setCurrentStep(a.currentIndex),e.abrupt("return",this.app.createDocument(a.imageDatas[0],a.fileName,a.fileType,a.isSampleImage,new Qe(r,n)));case 9:return e.abrupt("return",Promise.reject());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPreviousDocument",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a,r,i,o,l,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ft.getLastStoredDocument();case 3:if(t=e.sent,!(n=M.resizeImageData(t.imageData,t.imageData.width,t.imageData.height))){e.next=12;break}return e.next=8,M.createBlob(n);case 8:return a=e.sent,r=URL.createObjectURL(a),i=t.fileName,o=t.sessionDBName,l=t.timestamp,c=t.isSampleImage,e.abrupt("return",Promise.resolve({dataURI:r,fileName:i,sessionDBName:o,timestamp:l,isSampleImage:c}));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.debug("Error while retrieving document data: ".concat(e.t0));case 17:return e.abrupt("return",Promise.reject());case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}()}],[{key:"getAllowedMimetypes",value:function(){return n.ALLOWED_MIMETYPES.join(",")}},{key:"isAllowedMimetype",value:function(e){return-1!==n.ALLOWED_MIMETYPES.indexOf(e)}},{key:"showOpenFileError",value:function(){Object(E.error)(Ze("Importer.ReadFile.ErrorFileOpen","Sorry! Your image could not be opened."),{timeout:5e3}),ie("imageUploadFailed",{action:"readFile",error:"fileNotOpen"})}},{key:"readFile",value:function(){var e=Object(l.a)(s.a.mark((function e(t,a,r,i,o){var l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=ct.getMaxCanvasSizes(),pt.getInstance().track({"event.workflow":t.hasDoc()?"Canvas":"Home","event.subcategory":"Select Image","event.type":"click","event.subtype":o?"image":"upload"}),n.loadData(a,r,{onSuccess:function(e,n,s,c){t.createDocument(e,n,i,o);var u=s&&s>l[0]||c&&c>l[1];u&&(Object(E.error)(Ze("Importer.ReadFile.AutoScale","The image resolution has been adapted to realize the best working experience for you."),{timeout:5e3}),ie("imageUploadScaled",{action:"readFile",error:"resolutionAboveMaxLimits originalWidth: ".concat(s," originalHeight: ").concat(c)})),ie("imageUploadSuccess",{action:"fileInput",doc:{action:"store",mimeType:i,id:V()(),resolution:u?[null!==s&&void 0!==s?s:0,null!==c&&void 0!==c?c:0]:l}}),pt.getInstance().track({"event.workflow":"Canvas","event.subcategory":"Load Image","event.type":"success","event.subtype":"image"},{"content.name":r,"content.mimetype":i,"content.size":a instanceof Blob?a.size.toString():void 0,"content.extension":r.split(".").pop()})},onError:function(){pt.getInstance().track({"event.workflow":"Canvas","event.subcategory":"Load Image","event.type":"error","event.subtype":"image"},{"content.name":r,"content.mimetype":i,"content.size":a instanceof Blob?a.size.toString():void 0,"content.extension":r.split(".").pop()},{},{"event.error_code":"L1001","event.error_type":"max_resolution_exceeds","event.error_desc":"The image exceeds the max resolution"})}});case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r,i){return e.apply(this,arguments)}}()},{key:"loadData",value:function(e,t,a){var r=ct.getMaxCanvasSizes();L()(e,(function(r,i){if(r instanceof Event&&"error"===r.type||!i||i.originalWidth&&i.originalWidth>=32767||i.originalHeight&&i.originalHeight>=32767)return n.showOpenFileError(),(null===a||void 0===a?void 0:a.onError)&&a.onError(r),void console.error(r);var o=r,s=o.getContext("2d"),l=null===s||void 0===s?void 0:s.getImageData(0,0,o.width,o.height);if(!l||M.isEmptyImage(l))return n.showOpenFileError(),void((null===a||void 0===a?void 0:a.onEmptyData)&&a.onEmptyData());var c=t.split(".").slice(0,-1).join(".");if(c.length>n.MAX_FILENAME_LENGTH){var u=(c.length-n.MAX_FILENAME_LENGTH+"...".length)/2;c="".concat(c.substring(0,c.length/2-u),"...").concat(c.substring(c.length/2+u))}(null===a||void 0===a?void 0:a.onSuccess)&&a.onSuccess(l,c,i.originalWidth,i.originalHeight,e instanceof Blob?e.size:void 0)}),{canvas:!0,orientation:!0,maxWidth:r[0],maxHeight:r[1]})}}]),n}(F);Et.ALLOWED_MIMETYPES=["image/jpeg","image/png","image/svg+xml"],Et.MAX_FILENAME_LENGTH=120;var wt,xt=n(182),kt=n.n(xt),St=n(183),Ct=n.n(St),Ot=n(184),Pt=n.n(Ot),Tt=(n(438),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={isUndoEnabled:!1,isRedoEnabled:!1},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setUndoRedoEnabled",value:function(e,t){this.setState({isUndoEnabled:e,isRedoEnabled:t})}},{key:"render",value:function(){var e=this.props.controller,t=this.state,n=t.isUndoEnabled,a=t.isRedoEnabled;return g.a.createElement("div",null,g.a.createElement(xe.a,{quiet:!0,variant:"action",icon:g.a.createElement(Pt.a,null),disabled:!n,onClick:function(){ie("headerUndoClick",{action:"headerClick"}),pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"undo"},{},{"ui.view_type":"button"}),e.undo()}},Ze("GlobalNav.Button.Undo","Undo")),g.a.createElement(xe.a,{quiet:!0,variant:"action",icon:g.a.createElement(Ct.a,null),disabled:!a,onClick:function(){ie("headerRedoClick",{action:"headerClick"}),pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"redo"},{},{"ui.view_type":"button"}),e.redo()}},Ze("GlobalNav.Button.Redo","Redo")),g.a.createElement("div",{className:"button-divider"}),g.a.createElement(xe.a,{quiet:!0,variant:"action",icon:g.a.createElement(Ie.a,null),onClick:function(){ie("headerDownloadClick",{action:"headerClick"}),pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"download"},{},{"ui.view_type":"button"}),e.saveImage(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}},Ze("GlobalNav.ImageAction.Button.Download","Download")),g.a.createElement("div",{className:"button-divider"}),g.a.createElement(xe.a,{quiet:!0,variant:"action",icon:g.a.createElement(kt.a,null),onClick:function(){ie("headerOpenImageClick",{action:"headerClick"}),pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"open-image"},{},{"ui.view_type":"button"}),e.openImage()}},Ze("GlobalNav.ImageAction.Button.OpenImage","Open image")),g.a.createElement("div",{className:"button-divider"}))}}]),n}(v.PureComponent)),Mt=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).doc=void 0,a.doc=e,a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Tt,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"update",value:function(){var e;null===(e=this.getDocActionsView())||void 0===e||e.setUndoRedoEnabled(this.doc.canUndo(),this.doc.canRedo())}},{key:"undo",value:function(){this.doc.undo()}},{key:"redo",value:function(){this.doc.redo()}},{key:"saveImage",value:function(){this.doc.showSaveImage()}},{key:"openImage",value:function(){this.doc.showOpenImage()}},{key:"disableUndoRedo",value:function(){var e;null===(e=this.getDocActionsView())||void 0===e||e.setUndoRedoEnabled(!1,!1)}},{key:"getDocActionsView",value:function(){return this.view}}]),n}(F),It=(n(439),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.message,a=e.title,r=e.confirmLabel,i=e.secondaryLabel,o=e.cancelLabel;return g.a.createElement(fe.a,{className:"nav-confirm",title:a,role:"dialog",confirmLabel:r,secondaryLabel:i,cancelLabel:o,keyboardConfirm:!0,onConfirm:function(e){t.confirm(e&&"primary"!==e?"discard":"apply")},onCancel:function(){t.cancel()},variant:"confirmation"},n)}}]),n}(v.PureComponent));!function(e){e[e.apply=0]="apply",e[e.discard=1]="discard",e[e.cancel=2]="cancel"}(wt||(wt={}));var At=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a){var r;return Object(c.a)(this,n),(r=t.call(this)).dialogId=void 0,r.editorName=void 0,r.onUserInteraction=void 0,r.editorName=e,r.onUserInteraction=a,r}return Object(u.a)(n,[{key:"show",value:function(){this.dialogId=j.a.show(g.a.createElement(It,{controller:this,message:this.getDialogMessage(),title:this.getDialogTitle(),confirmLabel:this.getDialogConfirmLabel(),secondaryLabel:this.getDialogSecondaryLabel(),cancelLabel:this.getDialogCancelLabel()}))}},{key:"close",value:function(){this.dialogId&&j.a.hide(this.dialogId),this.dialogId=void 0}},{key:"cancel",value:function(){this.trackEvent(wt.cancel),this.onUserInteraction&&this.onUserInteraction(wt.cancel),this.close()}},{key:"confirm",value:function(e){"apply"===e?(this.trackEvent(wt.apply),this.onUserInteraction&&this.onUserInteraction(wt.apply)):(this.trackEvent(wt.discard),this.onUserInteraction&&this.onUserInteraction(wt.discard)),this.close()}},{key:"getDialogMessage",value:function(){return"Do you want to apply the edits?"}},{key:"getDialogConfirmLabel",value:function(){return Ze("ApplyEdits.Dialog.Warn.Button.Confirm","Apply")}},{key:"getDialogSecondaryLabel",value:function(){return"Discard"}},{key:"getDialogCancelLabel",value:function(){return Ze("ApplyEdits.Dialog.Warn.Button.Cancel","Cancel")}},{key:"getDialogTitle",value:function(){return Ze("ApplyEdits.Dialog.Warn.Title","Apply edits?")}},{key:"trackEvent",value:function(e){}}]),n}(F),Rt=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"getDialogMessage",value:function(){return Ze("ApplyEdits.Dialog.Warn.Download.Message","Do you want to apply the edits you just made before downloading your photo?")}},{key:"getDialogSecondaryLabel",value:function(){return Ze("ApplyEdits.Dialog.Warn.Download.utton.Discard","Download without saving")}},{key:"trackEvent",value:function(e){switch(e){case wt.apply:ie("".concat(this.editorName,":applyEditsConfirm"),{action:"applyEditsBeforeDownload"});break;case wt.discard:ie("".concat(this.editorName,":applyEditsDiscard"),{action:"applyEditsBeforeDownload"});break;case wt.cancel:ie("".concat(this.editorName,":applyEditsCancel"),{action:"applyEditsBeforeDownload"})}}}]),n}(At),Dt=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"getDialogMessage",value:function(){return Ze("ApplyEdits.Dialog.SwitchEditor.Warn.Message","Do you want to apply the edits you just made before switching to a new editing space?")}},{key:"getDialogConfirmLabel",value:function(){return Ze("ApplyEdits.Dialog.SwitchEditor.Warn.Button.Confirm","Apply edits to image")}},{key:"getDialogSecondaryLabel",value:function(){return Ze("ApplyEdits.Dialog.SwitchEditor.Warn.Button.Discard","Discard edits")}},{key:"getDialogTitle",value:function(){return Ze("ApplyEdits.Dialog.SwitchEditor.Warn.Title","Apply edits?")}},{key:"trackEvent",value:function(e){switch(e){case wt.apply:ie("".concat(this.editorName,":applyEditsConfirm"),{action:"applyEditsBeforeSwitchEditor"});break;case wt.discard:ie("".concat(this.editorName,":applyEditsDiscard"),{action:"applyEditsBeforeSwitchEditor"});break;case wt.cancel:ie("".concat(this.editorName,":applyEditsCancel"),{action:"applyEditsBeforeSwitchEditor"})}}}]),n}(At),jt=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"getDialogMessage",value:function(){return Ze("ApplyEdits.Dialog.Warn.OpenImage.Message","If you open a new photo, you\u2019ll lose the changes you just made...")}},{key:"getDialogConfirmLabel",value:function(){return Ze("ApplyEdits.Dialog.Warn.OpenImage.Button.Confirm","Open new photo")}},{key:"getDialogSecondaryLabel",value:function(){}},{key:"getDialogCancelLabel",value:function(){return Ze("ApplyEdits.Dialog.Warn.OpenImage.Button.Cancel","Keep Editing")}},{key:"getDialogTitle",value:function(){return Ze("ApplyEdits.Dialog.Warn.OpenImage.Title","Open new image?")}},{key:"trackEvent",value:function(e){switch(e){case wt.apply:ie("".concat(this.editorName,":discardChangeContinue"),{action:"discardChangeBeforeOpenImage"});break;case wt.cancel:ie("".concat(this.editorName,":discardChangeCancel"),{action:"discardChangeBeforeOpenImage"})}}}]),n}(At),_t=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"getDialogMessage",value:function(){return Ze("ApplyEdits.Dialog.Warn.SignIn.Message","Do you want to apply the edits you just made before signing in?")}},{key:"getDialogSecondaryLabel",value:function(){return Ze("ApplyEdits.Dialog.Warn.SignIn.Button.Discard","Sign in without saving")}},{key:"trackEvent",value:function(e){switch(e){case wt.apply:ie("".concat(this.editorName,":applyEditsConfirm"),{action:"applyEditsBeforeSignIn"});break;case wt.discard:ie("".concat(this.editorName,":applyEditsDiscard"),{action:"applyEditsBeforeSignIn"});break;case wt.cancel:ie("".concat(this.editorName,":applyEditsCancel"),{action:"applyEditsBeforeSignIn"})}}}]),n}(At),Lt=(n(440),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.message;return g.a.createElement(fe.a,{title:"Login Required",cancelLabel:"Cancel",confirmLabel:"Log In",onConfirm:function(){return t.login()},onCancel:function(){return t.close()},disableEscKey:!1},g.a.createElement("span",null,n))}}]),n}(v.PureComponent)),Nt=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a){var r;return Object(c.a)(this,n),(r=t.call(this)).dialogId=void 0,r.doc=void 0,r.message=void 0,r.doc=e,r.message=a,r}return Object(u.a)(n,[{key:"show",value:function(){this.dialogId=j.a.show(g.a.createElement(Lt,{controller:this,message:this.message||Ze("LoginDialog.Default.Message","You need to log in to use this functionality.")}))}},{key:"close",value:function(){this.dialogId&&j.a.hide(this.dialogId)}},{key:"login",value:function(){var e;P.getInstance().loginUser(null===(e=this.doc.getCurrentEditor())||void 0===e?void 0:e.getId())}}]),n}(F),Vt=(n(441),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={loading:e.loading},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setLoading",value:function(e){this.setState({loading:e})}},{key:"setEditorId",value:function(e){this.setState({editorId:e})}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.editorId;return g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{id:"doc-container",className:n},t&&g.a.createElement(bt.a,{centered:!0}),g.a.createElement("div",{id:"toolbar-container"}),g.a.createElement("div",{id:"stage-container"}),g.a.createElement("div",{id:"editor-container"}),g.a.createElement("div",{id:"layers-container"})))}}]),n}(v.PureComponent)),Ft=n(19),Ut=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,50,75,0,0,0,0,0,0,0,50,50,0,0];function Bt(e){var t=document.createElement("canvas");t.width=256,t.height=256;var n=e.width>e.height?256/e.width:256/e.height,a=Math.floor(e.width*n),r=Math.floor(e.height*n);t.width=256,t.height=256;var i=t.getContext("2d");if(null!==i){i.drawImage(e,0,0,a,r);var o=i.getImageData(0,0,a,r);return function(e){var t=0,n=0,a=0,r=e.width,i=e.height,o=[.10986328125,.10577392578125,.0943603515625,.07806396484375,.05987548828125,.0426025390625,.028076171875,.01715087890625,.00970458984375,.005126953125,.00250244140625,.0010986328125,.00048828125,.00018310546875,6103515625e-14],s=o.length,l=new Array(65536),c=new Array(256);for(n=0;n<e.data.length;n++){var u=4*n;l[n]=(e.data[u]+2*e.data[u+1]+e.data[u+2])/4}for(n=0;n<i;n++){for(t=0;t<r;t++)c[t]=l[t+n*r];for(t=0;t<r;t++){var d=c[t]*o[0];for(a=1;a<s;a++){var h=Math.min(t+a,r-1);d+=c[h]*o[a],d+=c[h=Math.max(t-a,0)]*o[a]}l[t+n*r]=d}}for(t=0;t<r;t++){for(n=0;n<i;n++)c[n]=l[t+n*r];for(n=0;n<i;n++){var f=c[n]*o[0];for(a=1;a<s;a++){var p=Math.min(n+a,i-1);f+=c[p]*o[a],f+=c[p=Math.max(n-a,0)]*o[a]}l[t+n*r]=f}}for(n=0;n<e.data.length;n++){var m=l[n],v=Math.floor(m),g=Math.floor(256*(m-v));e.data[4*n]=v,e.data[4*n+1]=g,e.data[4*n+2]=0}}(o),o}return null}var Ht=[0,.18006,.26352,-.24341,10,.18066,.26589,-.25479,20,.18133,.26846,-.26876,30,.18208,.27119,-.28539,40,.18293,.27407,-.3047,50,.18388,.27709,-.32675,60,.18494,.28021,-.35156,70,.18611,.28342,-.37915,80,.1874,.28668,-.40955,90,.1888,.28997,-.44278,100,.19032,.29326,-.47888,125,.19462,.30141,-.58204,150,.19962,.30921,-.70471,175,.20525,.31647,-.84901,200,.21142,.32312,-1.0182,225,.21807,.32909,-1.2168,250,.22511,.33439,-1.4512,275,.23247,.33904,-1.7298,300,.2401,.34308,-2.0637,325,.24702,.34655,-2.4681,350,.25591,.34951,-2.9641,375,.264,.352,-3.5814,400,.27218,.35407,-4.3633,425,.28039,.35577,-5.3762,450,.28863,.35714,-6.7262,475,.29685,.35823,-8.5955,500,.30505,.35907,-11.324,525,.3132,.35968,-15.628,550,.32129,.36011,-23.325,575,.32931,.36038,-40.77,600,.33724,.36051,-116.45];function zt(e,t){var n=new Array(3);return n[0]=e[0]*t[0]+e[1]*t[1]+e[2]*t[2],n[1]=e[3]*t[0]+e[4]*t[1]+e[5]*t[2],n[2]=e[6]*t[0]+e[7]*t[1]+e[8]*t[2],n}function Gt(e,t){var n=new Array(9);return n[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],n[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],n[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],n[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],n[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],n[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],n[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],n[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],n[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],n}function Wt(){var e=new Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Zt(e){var t=new Array(9),n=e[0],a=e[1],r=e[2],i=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=new Array(9);d[0]=o*u-c*s,d[1]=c*r-a*u,d[2]=a*s-o*r,d[3]=l*s-i*u,d[4]=n*u-l*r,d[5]=i*r-n*s,d[6]=i*c-l*o,d[7]=l*a-n*c,d[8]=n*o-i*a;var h=n*d[0]+a*d[3]+r*d[6];if(Math.abs(h)<1e-10)return Wt();for(var f=0;f<3;f++)for(var p=0;p<3;p++)t[3*f+p]=d[3*f+p]/h;return t}function Yt(e,t){if(e=Math.max(1e-6,e),e=Math.min(.999999,e),t=Math.max(1e-6,t),e+(t=Math.min(.999999,t))>.999999){var n=.999999/(e+t);e*=n,t*=n}return[e/t,1,(1-e-t)/t]}function Kt(e,t,n,a,r){var i=[1.3458,-.2556,-.051,-.5444,1.5081,.0205,0,0,1.212],o=function(e,t){e=5e4/(10+(e/=100)*(3*e-12)),t=9.562965+(t=.5*(t/=100)*(1+Math.abs(t)))*(150+-9.562965*t);var n={x:0,y:0};n.x=0,n.y=0;for(var a=1e6/e,r=t*(1/-3e3),i=0;i<=29;i++)if(a<Ht[4*(i+1)]||29===i){var o=(Ht[4*(i+1)]-a)/(Ht[4*(i+1)]-Ht[4*i]),s=Ht[4*i+1]*o+Ht[4*(i+1)+1]*(1-o),l=Ht[4*i+2]*o+Ht[4*(i+1)+2]*(1-o),c=1,u=Ht[4*i+3],d=1,h=Ht[4*(i+1)+3],f=Math.sqrt(1+u*u),p=Math.sqrt(1+h*h),m=(c/=f)*o+(d/=p)*(1-o),v=(u/=f)*o+(h/=p)*(1-o),g=Math.sqrt(m*m+v*v);s+=(m/=g)*r,l+=(v/=g)*r,n.x=1.5*s/(s-4*l+2),n.y=l/(s-4*l+2);break}return n}(a,r),s=0,l=0,c=Yt(o.x,o.y);c=zt(i,c);var u=1/Math.max(Math.max(c[0],c[1]),c[2]);for(s=0;s<3;s++){var d=c[s];d*=u,d=Math.max(.001,Math.min(1,d)),c[s]=d}var h=function(e,t,n,a){var r=[.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296],i=Yt(e,t),o=Yt(n,a);i=zt(r,i),o=zt(r,o),i[0]=Math.max(i[0],0),i[1]=Math.max(i[1],0),i[2]=Math.max(i[2],0),o[0]=Math.max(o[0],0),o[1]=Math.max(o[1],0),o[2]=Math.max(o[2],0);var s=Wt();s[0]=Math.max(.1,Math.min(i[0]>0?o[0]/i[0]:10,10)),s[4]=Math.max(.1,Math.min(i[1]>0?o[1]/i[1]:10,10)),s[8]=Math.max(.1,Math.min(i[2]>0?o[2]/i[2]:10,10));var l=Zt(r);return null!=l&&(l=Gt(l,s),l=Gt(l,r)),l}(.3457,.3585,o.x,o.y),f=zt(h=Gt(i,h),[.96429567642957,1,.82510460251046]);!function(e,t){for(var n=0;n<e.length;n++)e[n]*=t}(h,1/Math.max(Math.max(f[0],f[1]),f[2]));var p=Gt(i,Zt(h));p=Gt(p,function(e){var t=new Array(9);return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=e[2],t}(c));var m=new Array(3);m[0]=1/c[0],m[1]=1/c[1],m[2]=1/c[2];var v=new Array(3);for(v[0]=0,v[1]=1,v[2]=2,s=0;s<3;s++)for(t[3*s]=0,t[3*s+1]=0,t[3*s+2]=0,l=0;l<2;l++)if(m[v[l]]<m[v[l+1]]){var g=v[l];v[l]=v[l+1],v[l+1]=g}t[3*v[0]]=1,t[3*v[1]+1]=1,t[3*v[2]+2]=1,e[0]=p[v[0]],e[3]=p[v[1]],e[6]=p[v[2]],e[1]=p[3+v[0]],e[4]=p[3+v[1]],e[7]=p[3+v[2]],e[2]=p[6+v[0]],e[5]=p[6+v[1]],e[8]=p[6+v[2]],n[0]=m[v[0]],n[1]=m[v[1]],n[2]=m[v[2]]}function Xt(e){return e<0?-1:e>0?1:0}function qt(e,t,n){var a=Xt(Math.max(t,0)),r=1/n,i=e=Math.pow(e,n),o=e,s=Xt(Math.max(e-.5,0)),l=4*(i-(.5*s+.25));i+=(l=(1-2*s)*(l*l-1))*(.095*t);var c=1-Math.pow(2,t);return o=.5*(1-c*s)*(o-=.5*s)/(.5*(1-c*(1-s))+(1-2*s)*c*o),e=(i-(o+=.5*s))*a+o,e=Math.pow(e,r)}function Jt(e){var t=e/100;return.5*t*t+1.5*t+1}function Qt(e){var t=0,n=0;if(e<0)if(e>=-50)t=Jt(90*e/50),n=1;else{var a=2*(e+50);t=Jt((e+50)/5-90),n=Jt(a)}else t=Jt(e),n=1;return[t,n]}function $t(e,t,n){return e*((1-e)*(t+(3-n-t)*e)+e*e)}var en=function e(){Object(c.a)(this,e),this.fDarksSlope=1,this.fDarksExtraSlope=1,this.fLightsSlope=1,this.fLightsExtraSlope=1,this.fShadowsSlope=1,this.fShadowsExtraSlope=1,this.fHighlightsSlope=1,this.fHighlightsExtraSlope=1,this.fMidtonesSplitLinear=.21404114048223255,this.fMapDarks=3.2071068781954066,this.fMapMidtones=3.6719990266684714,this.fMapLights=1.5478403981490734},tn=function e(){Object(c.a)(this,e),this.darks=0,this.lights=0,this.shadows=0,this.highlights=0,this.shadowSplit=25,this.midtoneSplit=50,this.highlightSplit=75};function nn(e,t){t.darks=e[11],t.lights=e[12],t.shadows=e[13],t.highlights=e[14],t.shadowSplit=e[15],t.midtoneSplit=e[16],t.highlightSplit=e[17]}function an(e,t){var n=null;n=Qt(e.darks),t.fDarksSlope=n[0],t.fDarksExtraSlope=n[1],n=Qt(-e.lights),t.fLightsSlope=n[0],t.fLightsExtraSlope=n[1],n=Qt(e.shadows),t.fShadowsSlope=n[0],t.fShadowsExtraSlope=n[1],n=Qt(-e.highlights),t.fHighlightsSlope=n[0],t.fHighlightsExtraSlope=n[1];var a=function(e){var t,n=.01*e.shadowSplit,a=.01*e.midtoneSplit,r=.01*e.highlightSplit;a<n&&(t=a,a=n,n=t),r<a&&(t=a,a=r,r=t,a<n&&(t=a,a=n,n=t)),r-n<=0&&(n=a-.1,r=a+.1),a=(a-n)/(r-n);var i=Math.min(n,.1),o=.8/(Math.max(r,.9)-i);return(r=.1+(r-i)*o)-(n=.1+(n-i)*o)<.2&&(r=(n=.6*(n-.1)/(.8-(r-n))+.1)+.2),a=n+a*(r-n),a=Math.max(a,r-.1),[n,a=Math.min(a,n+.1),r]}(e);t.fMidtonesSplitLinear=ln(a[1]);var r=t.fMidtonesSplitLinear,i=.5;t.fMapMidtones=i*(1-r)/(r*(1-i));var o=ln(a[0]),s=ln(a[2]);r=o/t.fMidtonesSplitLinear,i=.5,t.fMapDarks=i*(1-r)/(r*(1-i)),r=(s-t.fMidtonesSplitLinear)/(1-t.fMidtonesSplitLinear),i=.5,t.fMapLights=i*(1-r)/(r*(1-i))}function rn(e,t){var n=t.fMidtonesSplitLinear,a=0;return e<n?(e/=n,e=$t(e=(a=t.fMapDarks*e)/(1+a-e),t.fShadowsSlope,1),e=(a=(e=$t(e,t.fShadowsExtraSlope,1))/t.fMapDarks)/(1+a-e),e*=n):(e=(e-n)/(1-n),e=$t(e=(a=t.fMapLights*e)/(1+a-e),1,t.fHighlightsSlope),e=(e=(a=(e=$t(e,1,t.fHighlightsExtraSlope))/t.fMapLights)/(1+a-e))*(1-n)+n),e=$t(e=(a=t.fMapMidtones*e)/(1+a-e),t.fDarksSlope,t.fLightsSlope),e=(a=(e=$t(e,t.fDarksExtraSlope,t.fLightsExtraSlope))/t.fMapMidtones)/(1+a-e)}var on=function e(){Object(c.a)(this,e),this.contrast=0,this.contrastKey=0,this.toneValues=new en};function sn(e){var t,n=[0,.10433,.25961,.40389,.52069,.61436,.69035,.75289,.80486,.84825,.88453,.91478,.93986,.96042,.97702,.99009,1],a=new Array(17);for(t=0;t<17;t++)a[t]=qt(n[t],e.contrast,Math.log(.5)/Math.log(e.contrastKey)),a[t]=rn(a[t],e.toneValues);var r=function(e){var t,n,a,r,i,o=[];t=e[0],n=e[1],a=e[2],o[0]=.5*(5*t-4*n+a),o[1]=.5*(4*n-t-a),o[2]=.5*(t-4*n+5*a),r=o[1],i=o[2];for(var s=1;s<8;s++){var l=2*s,c=.5*(5*(t=e[l])-4*(n=e[l+1])+(a=e[l+2])),u=.5*(4*n-t-a),d=.5*(t-4*n+5*a);o.push(d),o[o.length-3]=(c+2*r)/3,o[o.length-2]=(u+i)/2,r=u,i=d}return o[0]=e[0]-(o[1]-e[0]),o}(a),i=new Float32Array(24);for(t=0;t<8;t++){var o=r[t],s=r[t+1],l=r[t+2];i[3*t]=.5*(o+s),i[3*t+1]=s-o,i[3*t+2]=.5*(o-2*s+l)}return i}function ln(e){return e<=.040449936?e*(1/12.92):(e+.055)*Math.pow(1/1.055,2.4)}function cn(e,t,n,a){var r=new Array(3),i=[.2880859375,.7119140625,0];e<0&&(e+=360),e>=360&&(e-=360);var o=0,s=0,l=0,c=0;e<60?(o=e/60,s=0,l=1,c=2):e<120?(o=(120-e)/60,s=1,l=0,c=2):e<180?(o=(e-120)/60,s=1,l=2,c=0):e<240?(o=(240-e)/60,s=2,l=1,c=0):e<300?(o=(e-240)/60,s=2,l=0,c=1):(o=(360-e)/60,s=0,l=2,c=1);var u=n*(2.5-a)*t,d=1-u*(i[s]+o*i[l]);return d=Math.min(Math.max(a,d),2.5),d=Math.min(Math.max(a-u,d),2.5-u),r[s]=d+u,r[l]=d+u*o,r[c]=d,r}function un(e,t,n,a,r){var i=new Array(7),o=null;return i[0]=function(e){var t=.5-.4*e;return.5*(1-(t=ln(t)))/(.5*t)}(n/100),o=cn(e,t/100,1,.05),i[1]=o[0],i[2]=o[1],i[3]=o[2],o=cn(a,r/100,-1,.2),i[4]=3-o[0]-i[1],i[5]=3-o[1]-i[2],i[6]=3-o[2]-i[3],i}var dn=n(91),hn=new Map([["add-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSamplers[2];\nuniform float uScales[2];\n\nvoid main()\n{\n    gl_FragColor = vec4( uScales[0] * texture2D( uSamplers[0], vTexCoord ).xyz + uScales[1] * texture2D( uSamplers[1], vTexCoord ).xyz, 1.0 );\n}\n"],["blit-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    gl_FragColor = texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) );\n}\n"],["blitscale-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uScale;\n\nvoid main()\n{\n    gl_FragColor = uScale * abs( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ) );\n}\n"],["blitx-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    gl_FragColor = vec4( vec3( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ).x ), 1.0 );\n}\n"],["deltamask-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSamplers[2]; // 0: original, 1: compressed\nuniform float uDiffMid;\n\n#define ToneMapLimitShadowGain 1\n\nvoid main()\n{\n    float src = texture2D( uSamplers[0], vTexCoord ).x;\n    float dst = texture2D( uSamplers[1], vTexCoord ).x + uDiffMid;\n#if ToneMapLimitShadowGain\n    float diff = min( dst - src, 4.0 );\n#else\n    float diff = dst - src;\n#endif\n    gl_FragColor = vec4( vec3( diff ), 1.0 );\n}\n"],["gaussian-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D uSampler;\nvarying vec2 vTexCoords[5];\n\nvoid main()\n{\n    gl_FragColor =\n        vec4(\n        0.00456569 * (texture2D( uSampler, vTexCoords[0] ).xyz + texture2D( uSampler, vTexCoords[4] ).xyz) +\n        0.29596257 * (texture2D( uSampler, vTexCoords[1] ).xyz + texture2D( uSampler, vTexCoords[3] ).xyz) +\n        0.39894347 * texture2D( uSampler, vTexCoords[2] ).xyz,\n        1.0 );\n}\n"],["gaussian-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[5];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    // Hardcoded: gaussian weights with sigma = 1.00 sampled at [-4,4], see dng_resample_gaussian\n    // Linear filtering taken advantage of to reduce sample count\n    // kernel.py 4 1.00\n\n    vTexCoords[0] = aTexCoord + (-3.02931223 * uTextureUnit);\n    vTexCoords[1] = aTexCoord + (-1.18242552 * uTextureUnit);\n    vTexCoords[2] = aTexCoord;\n    vTexCoords[3] = aTexCoord + (1.18242552 * uTextureUnit);\n    vTexCoords[4] = aTexCoord + (3.02931223 * uTextureUnit);\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["gaussianbigsigma-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D uSampler;\nvarying vec2 vTexCoords[15];\n\nvoid main()\n{\n    // Hardcoded: gaussian weights with sigma = 3.50 sampled at [-14,14], see dng_resample_gaussian\n    // Linear filtering taken advantage of to reduce sample count\n    // kernel.py 14 3.50\n\n    gl_FragColor =      \n        vec4(\n        0.00015335 * (texture2D( uSampler, vTexCoords[0] ).xyz + texture2D( uSampler, vTexCoords[14] ).xyz) +\n        0.00113588 * (texture2D( uSampler, vTexCoords[1] ).xyz + texture2D( uSampler, vTexCoords[13] ).xyz) +\n        0.00610264 * (texture2D( uSampler, vTexCoords[2] ).xyz + texture2D( uSampler, vTexCoords[12] ).xyz) +\n        0.02378969 * (texture2D( uSampler, vTexCoords[3] ).xyz + texture2D( uSampler, vTexCoords[11] ).xyz) +\n        0.06731104 * (texture2D( uSampler, vTexCoords[4] ).xyz + texture2D( uSampler, vTexCoords[10] ).xyz) +\n        0.13826867 * (texture2D( uSampler, vTexCoords[5] ).xyz + texture2D( uSampler, vTexCoords[9] ).xyz) +\n        0.20624514 * (texture2D( uSampler, vTexCoords[6] ).xyz + texture2D( uSampler, vTexCoords[8] ).xyz) +\n        0.11398719 * texture2D( uSampler, vTexCoords[7] ).xyz,\n        1.0 );\n}\n"],["gaussianbigsigma-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[15];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    // Hardcoded: gaussian weights with sigma = 3.50 sampled at [-14,14], see dng_resample_gaussian\n    // Linear filtering taken advantage of to reduce sample count\n    // kernel.py 14 3.50\n\n    vTexCoords[0] = aTexCoord + (-13.24935770 * uTextureUnit);\n    vTexCoords[1] = aTexCoord + (-11.28114775 * uTextureUnit);\n    vTexCoords[2] = aTexCoord + (-9.31528835 * uTextureUnit);\n    vTexCoords[3] = aTexCoord + (-7.35154728 * uTextureUnit);\n    vTexCoords[4] = aTexCoord + (-5.38960340 * uTextureUnit);\n    vTexCoords[5] = aTexCoord + (-3.42905340 * uTextureUnit);\n    vTexCoords[6] = aTexCoord + (-1.46942595 * uTextureUnit);\n    vTexCoords[7] = aTexCoord;\n    vTexCoords[8] = aTexCoord + (1.46942595 * uTextureUnit);\n    vTexCoords[9] = aTexCoord + (3.42905340 * uTextureUnit);\n    vTexCoords[10] = aTexCoord + (5.38960340 * uTextureUnit);\n    vTexCoords[11] = aTexCoord + (7.35154728 * uTextureUnit);\n    vTexCoords[12] = aTexCoord + (9.31528835 * uTextureUnit);\n    vTexCoords[13] = aTexCoord + (11.28114775 * uTextureUnit);\n    vTexCoords[14] = aTexCoord + (13.24935770 * uTextureUnit);\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n\n"],["greylog2-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvec3 evalUndoRenderCurveGrey(vec3 col)\n{\n    vec2 fMinMax;\n    vec2 nMinMax;\n    \n    float eps = 0.00001;\n    \n    \n    fMinMax.x = min(min(col.r,col.g),col.b);\n    fMinMax.y = max(max(col.r,col.g),col.b);\n    \n    vec2 t = pow(fMinMax,vec2(3.14453125));\n    \n    nMinMax = pow(fMinMax,vec2(0.8125))*0.3828125*(1.0-t) + (1.0-pow(1.0-fMinMax,vec2(0.69140625)))*t;\n\n    fMinMax.y = (nMinMax.y-nMinMax.x)/(fMinMax.y-fMinMax.x+eps);\n    \n    return (col-fMinMax.x)*fMinMax.y + nMinMax.x;\n}\n\nvoid main()\n{\n    vec3 col = clamp( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ).xyz, 0.0, 1.0 );\n    col = mix( col / 12.92, pow( (col + 0.055)/1.055, vec3( 2.4 ) ), step( 0.04045, col ) );\n\n    const float eps = 1.0/255.0;\n\n    // RGB linear -> Prophoto\n    const mat3 rgb2proPhotoMatrix = mat3(0.52932378745827813, 0.098426540365603984, 0.016845769297481432,\n                                     0.33005506400369466, 0.87350872697710469, 0.11769549131351224,\n                                     0.14064019169871309, 0.028111560975330636, 0.86547398998538982);\n    col = rgb2proPhotoMatrix * col;\n    \n    col = evalUndoRenderCurveGrey(col);\n    \n    /*\n    // Undo render curve\n    vec2 minmax0 = vec2( min( min( col.r, col.g ), col.b ), max( max( col.r, col.g ), col.b ) );\n    vec2 minmax1 = vec2( texture2D( uUndoRenderCurveSampler, vec2( minmax0.x, 0.0 ) ).x, texture2D( uUndoRenderCurveSampler, vec2( minmax0.y, 0.0 ) ).x );\n    col = ((minmax1.y - minmax1.x) * (col - minmax0.x) / max( (minmax0.y - minmax0.x), eps ) + minmax1.x);\n    */\n\n    // !!! Ignore white balance for now !!!\n\n    // To grey\n    float lum = max( dot( col, vec3( 0.30, 0.59, 0.11 ) ), 0.0 );\n\n    const float kMaxFlareLinear_real64 = 0.000244140625;    // ~ 2^-12\n\n    gl_FragColor = vec4( vec3( log2( lum + kMaxFlareLinear_real64 ) ), 1.0 );\n}\n"],["lin2srgb-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec3 cl = clamp( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ).xyz, 0.0, 1.0 );\n    gl_FragColor = vec4( mix( 12.92 * cl, 1.055 * pow( cl, vec3( 0.41666 ) ) - 0.055, step( 0.0031308, cl ) ), 1.0 );\n}\n"],["llf-fs",'\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSamplers[3]; // 0: gaussian level, 1: laplacian level, 2: pingpong result from last render\nuniform float reference;        // Value in log space at which image was tone mapped\nuniform float inv_ds;           // Inverse of difference in stops between samples, "stops per sample"\n\nvoid main()\n{\n    float g = texture2D( uSamplers[0], vTexCoord ).x;   // Its grey => just care about one of the 3 identical channels\n\n    // Triangle function blending between samples: __//\\__\n    float line0 = inv_ds * (g - reference) + 1.0;   // for da/ds: da always 1\n    float line1 = inv_ds * (reference - g) + 1.0;   // for da/ds: da always 1\n    float alpha = max( min( line0, line1 ), 0.0 );\n\n    // No programmable blending... result ping ponged\n    float result = texture2D( uSamplers[2], vTexCoord ).x;\n\n    gl_FragColor = vec4( vec3( alpha * texture2D( uSamplers[1], vTexCoord ).x + result ), 1.0 );\n}\n'],["log2lin-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    const float kMaxFlareLinear_real64 = 0.000244140625;    // 2^-12\n    gl_FragColor = vec4( exp2( texture2D( uSampler, vTexCoord ).xyz ) - kMaxFlareLinear_real64, 1.0 );\n}\n"],["lum-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec3 col = texture2D( uSampler, vTexCoord ).xyz;\n    const vec3 weights = vec3( 0.25, 0.5, 0.25 );\n    gl_FragColor = vec4( vec3( dot( col, weights ) ), 1.0 );\n}\n"],["minmaxmean-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoords[4];\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec3 samples[4];\n    samples[0] = texture2D( uSampler, vTexCoords[0] ).xyz;\n    samples[1] = texture2D( uSampler, vTexCoords[1] ).xyz;\n    samples[2] = texture2D( uSampler, vTexCoords[2] ).xyz;\n    samples[3] = texture2D( uSampler, vTexCoords[3] ).xyz;\n\n    float minVal = min( min( min( samples[0].x, samples[1].x ), samples[2].x ), samples[3].x );\n    float maxVal = max( max( max( samples[0].y, samples[1].y ), samples[2].y ), samples[3].y );\n    float meanVal = 0.25 * (samples[0].z + samples[1].z + samples[2].z + samples[3].z);\n    gl_FragColor = vec4( minVal, maxVal, meanVal, 0.0 );\n}\n"],["minmaxmean-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[4];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    vTexCoords[0] = aTexCoord + vec2( uTextureUnit.x, uTextureUnit.y );\n    vTexCoords[1] = aTexCoord + vec2( uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[2] = aTexCoord + vec2( -uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[3] = aTexCoord + vec2( -uTextureUnit.x, uTextureUnit.y );\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["moments-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoords[4];\n\nuniform sampler2D uSampler;\nuniform float uMean;\n\nvoid main()\n{\n    float samples[4];\n    samples[0] = texture2D( uSampler, vTexCoords[0] ).x;\n    samples[1] = texture2D( uSampler, vTexCoords[1] ).x;\n    samples[2] = texture2D( uSampler, vTexCoords[2] ).x;\n    samples[3] = texture2D( uSampler, vTexCoords[3] ).x;\n\n    vec4 diff = vec4( samples[0], samples[1], samples[2], samples[3] ) - vec4( uMean );\n    vec4 diff2 = diff * diff;\n    vec4 diff3 = diff2 * diff;            \n    float variance = 0.25*dot( diff2, vec4( 1.0 ) );\n    float moment3 = 0.25*dot( diff3, vec4( 1.0 ) );\n    gl_FragColor = vec4( variance, moment3, 0.0, 0.0 );\n}\n"],["moments-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[4];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    vTexCoords[0] = aTexCoord + vec2( uTextureUnit.x, uTextureUnit.y );\n    vTexCoords[1] = aTexCoord + vec2( uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[2] = aTexCoord + vec2( -uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[3] = aTexCoord + vec2( -uTextureUnit.x, uTextureUnit.y );\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["reductionsum-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoords[4];\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec4 samples[4];\n    samples[0] = texture2D( uSampler, vTexCoords[0] );\n    samples[1] = texture2D( uSampler, vTexCoords[1] );\n    samples[2] = texture2D( uSampler, vTexCoords[2] );\n    samples[3] = texture2D( uSampler, vTexCoords[3] );\n    float val0 = 0.25*(samples[0].x + samples[1].x + samples[2].x + samples[3].x);\n    float val1 = 0.25*(samples[0].y + samples[1].y + samples[2].y + samples[3].y);\n    gl_FragColor = vec4( val0, val1, 0.0, 0.0 );\n}\n"],["reductionsum-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[4];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    vTexCoords[0] = aTexCoord + vec2( uTextureUnit.x, uTextureUnit.y );\n    vTexCoords[1] = aTexCoord + vec2( uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[2] = aTexCoord + vec2( -uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[3] = aTexCoord + vec2( -uTextureUnit.x, uTextureUnit.y );\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["shader-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n"],["shaderTemplate","\n\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D lcSampler;\nuniform sampler2D toneMapMask;\n\nuniform float exposure;\nuniform float exposureGain;\nuniform vec3 undoCurve[8];\nuniform vec3 renderCurve[8];\n\nuniform float blacks;\nuniform float whites;\n\n//***uniforms\n\nuniform float uGlobalAmtHighlights;\nuniform float uGlobalAmtShadows;\nuniform float uGlobalAmtClarity;\n\nuniform float uToneMapMid;\n\nuniform vec4 lineLumWeightScale;\nuniform vec4 lineLumWeightOffset;\n\nuniform float uCompressionScale;\nuniform float uCompressionOffset;\n\nuniform float uHighlightPinAmount;\n\nuniform float uToneMapMaxAbsOffset;\n\n#define ToneMap 1\n\nvec2 EndpointPinMask (vec2 x)\n{\n\n    x = 1.0 - x;\n\n    x *= x;     // 2\n    x *= x;     // 4\n    x *= x;     // 8\n\n    x = 1.0 - x;\n\n    return x;\n\n}\n\nconst vec3 kGrayWeights = vec3 (0.30, 0.59, 0.11);\n\nvec3 DoToneMap( vec3 rgb, vec2 pt )\n{       \n    // const kMaxFlareLinear_real64 = 0.000244140625;\n    // const flareLinear = kMaxFlareLinear_real64;\n    // const flareLog = Math.log2( flareLinear );\n    // const eps = flareLinear / 128.0;\n\n    const float flareLog = -12.0;\n    const float eps = 0.00000190734;\n    \n    vec2 absGlobalAmtHS = abs(vec2(uGlobalAmtHighlights,uGlobalAmtShadows));\n    \n    float mask = texture2D (toneMapMask, pt).x;\n    float srcGrayLinear = dot (rgb, kGrayWeights);\n    float srcGrayLog = log2 (srcGrayLinear);\n    \n    vec4 lineLumWeightResult = lineLumWeightScale * srcGrayLog + lineLumWeightOffset;\n    \n    float partSwitch = step(srcGrayLog,uToneMapMid);\n    \n    float baseCompressed = mix(lineLumWeightResult.y, lineLumWeightResult.x, partSwitch);\n    \n    float localContrastSignal = srcGrayLog + mask - baseCompressed;\n    localContrastSignal *= max(uGlobalAmtClarity, 0.0);\n    localContrastSignal *= clamp(uCompressionScale * 0.5*(-uGlobalAmtHighlights + uGlobalAmtShadows) + uCompressionOffset, 1.0, 2.0);\n    \n    vec2 localContrastSignal2 = vec2(max(localContrastSignal, 0.0),min(localContrastSignal, 0.0));\n    \n    vec2 lumWeight;\n    lumWeight.x = mix(lineLumWeightResult.w, lineLumWeightResult.z, partSwitch);\n                            \n    lumWeight.x = clamp(lumWeight.x,0.0,1.0);\n    lumWeight.y = 1.0-lumWeight.x;\n    \n    vec2 claritySHPinMask = EndpointPinMask(lumWeight);\n    \n    vec2 hsPinMask;\n    hsPinMask.y =  mix(0.5 + 0.5*max(1.0-sign(uGlobalAmtShadows),0.0), 1.0, claritySHPinMask.x);\n    hsPinMask.x = mix (1.0, 0.5, (1.0-claritySHPinMask.y)*max(-sign(uGlobalAmtHighlights),0.0));\n    hsPinMask.x = mix(1.0, hsPinMask.x, max(uHighlightPinAmount,0.0));\n    \n    float baseOffset = uToneMapMaxAbsOffset * (uGlobalAmtHighlights + uGlobalAmtShadows)/ max(max(absGlobalAmtHS.x, absGlobalAmtHS.y), eps);\n    vec2 offsetHS = lumWeight * absGlobalAmtHS * baseOffset;\n    vec2 deltaHS = vec2(-uGlobalAmtHighlights, uGlobalAmtShadows);\n    deltaHS = clamp(deltaHS,-1.0,1.0);\n    deltaHS *= vec2(min(mask, 0.0),max(mask, 0.0));\n    deltaHS += offsetHS;\n    \n    float delta = dot(deltaHS,hsPinMask);\n    delta += dot(localContrastSignal2,claritySHPinMask);\n    \n    float startpoint;\n    float t;\n    \n    partSwitch = sign(delta);\n    float zeroSwitch = 1.0 - abs(partSwitch);\n    partSwitch = 1.0-max(partSwitch,0.0);\n    \n    float flare = partSwitch*flareLog;\n    startpoint = flare - (delta + delta);\n    \n    float t1 = step(startpoint,srcGrayLog);\n    float t2 = step(srcGrayLog,startpoint);\n    \n    t = clamp((srcGrayLog - startpoint) / (flare - startpoint + zeroSwitch),0.0,1.0);\n    t *= t * (1.0-mix(t2,t1,partSwitch));\n    delta = mix (delta, 0.0, t);\n    \n    rgb *= exp2 (srcGrayLog + delta) / max(srcGrayLinear, eps);\n\n    return max (rgb, 0.0);\n}\n\nvec3 sRGBGamma(in vec3 col)\n{\n        vec3 sV = step(col,vec3(0.0031308));\n        return mix((1.055 * pow (col, vec3(1.0/2.4)) - 0.055),(col*12.92),sV);\n}\n\nvec3 invSRGBGamma(in vec3 col)\n{\n    vec3 sV = step(col,vec3(0.040449936));\n    return mix(pow ((col + 0.055)/1.055, vec3(2.4)),(col/12.92),sV);\n}\n\nfloat calcProtection(in float hue, in float sat)\n{\n    float val = mod(hue + 1.0,6.0);\n    float minSide = min(val,1.0);\n    float maxSide = clamp(1.0 - (val - 1.5) * 4.0,0.0,1.0);\n    val = min(minSide, maxSide);\n    return val * (1.0 - sat*sat);\n}\n\nvec3 rgb2HSL(in vec3 rgbCol)\n{\n    vec3 colFactors;\n    vec3 outVal;\n    \n    outVal.y = min(min(rgbCol.r, rgbCol.g), rgbCol.b);\n    outVal.z = max(max(rgbCol.r, rgbCol.g), rgbCol.b);\n    \n    float delta = outVal.z - outVal.y;\n    \n    float deltaFactor = sign(delta);\n    \n    delta += 1.0 - deltaFactor;\n\n    colFactors.xyz = 1.0 - sign(outVal.z - rgbCol.rgb);\n    colFactors.yzx *= 1.0 - colFactors.xyz;\n\n    outVal.x = ((rgbCol.g - rgbCol.b) / delta)*colFactors.x;\n    outVal.x += (2.0+(rgbCol.b - rgbCol.r) / delta)*colFactors.y;\n    outVal.x += (4.0+(rgbCol.r - rgbCol.g) / delta)*colFactors.z;\n    \n    outVal.x *= deltaFactor;\n    outVal.x = mod(outVal.x+6.0,6.0);\n    \n    return outVal;\n}\n\nvec3 hsl2RGB(in vec3 hslCol)\n{\n    float dH = floor(hslCol.x);\n    float h = fract(hslCol.x);\n\n    if(mod(dH,2.0) > 0.5)\n        h = 1.0 - h;\n\n    vec3 cCol;\n    vec3 outCol;\n    \n    cCol.x = hslCol.y;\n    cCol.y = hslCol.z;\n    cCol.z = (cCol.y - cCol.x) * h + cCol.x;\n    \n    outCol = mix(cCol.yzx,cCol.zyx,float(dH == 1.0));\n    outCol = mix(outCol,cCol.xyz, float(dH == 2.0));\n    outCol = mix(outCol,cCol.xzy, float(dH == 3.0));\n    outCol = mix(outCol,cCol.zxy, float(dH == 4.0));\n    outCol = mix(outCol,cCol.yxz, float(dH == 5.0));\n    \n    return outCol;\n}\nfloat spline6Value(in vec3 curve[6], in float t)\n{\n    float checkT;\n    vec3 tVec;\n    float tMask;\n    float outVal;\n    \n    t *= 6.0;\n    checkT = t;\n    t = fract(t);\n    tVec.x = 1.0;\n    tVec.y = t;\n    tVec.z = t*t;\n    \n    tMask = step(checkT,1.0); outVal = dot(curve[0],tVec)*tMask;\n    tMask = step(checkT,2.0)*step(1.0,checkT); outVal += dot(curve[1],tVec)*tMask;\n    tMask = step(checkT,3.0)*step(2.0,checkT); outVal += dot(curve[2],tVec)*tMask;\n    tMask = step(checkT,4.0)*step(3.0,checkT); outVal += dot(curve[3],tVec)*tMask;\n    tMask = step(checkT,5.0)*step(4.0,checkT); outVal += dot(curve[4],tVec)*tMask;\n    tMask = step(5.0,checkT); outVal += dot(curve[5],tVec)*tMask;\n    \n    return outVal;\n}\n\nfloat spline8Value(in vec3 curve[8], in float t)\n{\n    float checkT; vec3 tVec; float tMask; float outVal;\n    \n        t *= 8.0;\n    checkT = t;\n    t = fract(t);\n    tVec.x = 1.0;\n    tVec.y = t;\n    tVec.z = t*t;\n    \n    tMask = step(checkT,1.0);\n    outVal = dot(curve[0],tVec)*tMask;\n\n    tMask = step(checkT,2.0)*step(1.0,checkT);  outVal += dot(curve[1],tVec)*tMask;\n    tMask = step(checkT,3.0)*step(2.0,checkT);  outVal += dot(curve[2],tVec)*tMask;\n    tMask = step(checkT,4.0)*step(3.0,checkT);  outVal += dot(curve[3],tVec)*tMask;\n    tMask = step(checkT,5.0)*step(4.0,checkT);  outVal += dot(curve[4],tVec)*tMask;\n    tMask = step(checkT,6.0)*step(5.0,checkT);  outVal += dot(curve[5],tVec)*tMask;\n    tMask = step(checkT,7.0)*step(6.0,checkT);  outVal += dot(curve[6],tVec)*tMask;\n    tMask = step(7.0,checkT);                   outVal += dot(curve[7],tVec)*tMask;\n    \n    return outVal;\n}\n\nvec3 evalUndoRenderCurve(vec3 col)\n{\n    vec2 fMinMax;\n    vec2 nMinMax;\n    \n    float eps = 0.00001;\n    \n    \n    fMinMax.x = min(min(col.r,col.g),col.b);\n    fMinMax.y = max(max(col.r,col.g),col.b);\n    \n    vec2 t = pow(fMinMax,vec2(3.14453125));\n    \n    nMinMax = pow(fMinMax,vec2(0.8125))*0.3828125*(1.0-t) + (1.0-pow(1.0-fMinMax,vec2(0.69140625)))*t;\n\n    fMinMax.y = (nMinMax.y-nMinMax.x)/(fMinMax.y-fMinMax.x+eps);\n    \n    return (col-fMinMax.x)*fMinMax.y + nMinMax.x;\n}\n\nvec3 evalToneCurve(vec3 curve[8],vec3 col)\n{\n    float fMin,fMax;\n    float nMin,nMax;\n    float eps = 0.00001;\n    \n    fMin = min(min(col.r,col.g),col.b);\n    fMax = max(max(col.r,col.g),col.b);\n    \n    nMin = spline8Value(curve,fMin);\n    nMax = spline8Value(curve,fMax);\n    \n    fMax = (nMax-nMin)/(fMax-fMin+eps);\n    \n    return (col-fMin)*fMax + nMin;\n}\n\nfloat calcPosBlacks(float x,float blacks)  // scale\n{\n    float pVal = 1.0/(1.0+blacks*0.18);\n    return (1.0 - x*x)*pow(x,pVal) + x*x*x;\n}\n\nfloat calcNegWhites(float x,float whites) // scale\n{\n    float smallX = x;\n    float pVal = 1.0/(1.0-whites*0.72);\n    return smallX*pow(x,pVal) + (1.0-smallX)*x;\n}\n\nvec2 calcPosWhites(vec2 x,float whites)\n{\n    float val = 1.0 - (0.8*whites);\n    //(x/(1.0+x))*(1.0+x/(val*val))\n    //x+2.0*whites*x*x\n\n    return min((x/(1.0+x))*(1.0+x/(val*val)), vec2(1.0,1.0));\n}\n\nvec3 calcNegBlacks(vec3 x,float blacks)\n{\n    float n = 0.04*blacks*blacks;\n    \n    float m = max(min(0.05,n),0.000001);\n    float a = 1.0/(4.0*m*(1.0-n));\n    vec3 b = (n-m)-x;\n    b = b*b;\n\n    vec3 roundY = a*b;\n    vec3 straightY = 1.0/(1.0-n)*(x-n);\n\n    float sect = (n-m)+((1.0/(1.0-n))/(2.0*a));\n    \n    //step(edge,x) -> x < edge ? 0.0 : 1.0\n    \n    vec3 zeroFactor = step(vec3(n-m,n-m,n-m),x);\n    vec3 straightFactor = step(sect,x);\n\n    return mix(roundY,straightY,straightFactor)*zeroFactor;\n\n    //return max(vec3(0.0,0.0,0.0),straightY);\n}\n\n//***functions\n\nvoid main(void)\n{\n    vec2 fMinMax;\n    vec2 nMinMax;\n    vec2 endPin;\n    \n    float pinWeight;\n    float eps = 0.00001;\n    \n    const highp mat3 fromSRGBMatr = mat3(0.529285,0.098394,0.016823,\n                                    0.330046,0.873493,0.117671,\n                                    0.140669,0.028113,0.865506);\n    \n    const highp mat3 toSRGBMatr = mat3(2.034302,-0.228882,-0.00842285,\n                                    -0.727295,1.23168945,-0.15332,\n                                    -0.307007,-0.00280762,1.16174316);\n\n    highp vec4 col = texture2D(uSampler, vTextureCoord.st);\n    highp vec3 rgbCol = col.rgb;\n    float grayVal = dot(rgbCol,vec3(0.25,0.5,0.25)); \n    \n    rgbCol = clamp(rgbCol,0.0001,0.999);\n    \n    rgbCol = invSRGBGamma(rgbCol);\n    rgbCol = fromSRGBMatr * rgbCol;\n\n    //rgbCol = evalToneCurve(undoCurve,rgbCol);\n    rgbCol = evalUndoRenderCurve(rgbCol);\n    \n    //***stagesPreExposure\n    \n    float negWhites = max(-whites,0.0);\n    float posWhites = max(whites,0.0);\n    float negBlacks = max(-blacks,0.0);\n    float posBlacks = max(blacks,0.0);\n\n    rgbCol *= exposureGain;\n    \n\n    pinWeight = max(exposure,0.0)/8.488339269336635;\n    pinWeight *= pinWeight;\n    pinWeight *= pinWeight;\n    fMinMax.x = min(min(rgbCol.r,rgbCol.g),rgbCol.b);\n    fMinMax.y = max(max(rgbCol.r,rgbCol.g),rgbCol.b);\n    \n    nMinMax = fMinMax;\n\n    nMinMax = calcPosWhites(nMinMax,posWhites);\n    \n    nMinMax = min(nMinMax,1.0);\n    nMinMax = pow(nMinMax,vec2(1.0/2.2));\n    endPin = pow(1.0-nMinMax,vec2(exposure));\n    nMinMax = 1.0-endPin;\n    endPin *= endPin;\n    endPin = 1.0-endPin*pinWeight;\n    nMinMax *= endPin;\n    \n    nMinMax = pow(nMinMax,vec2(2.2));\n    fMinMax.y = (nMinMax.y-nMinMax.x)/(fMinMax.y-fMinMax.x+eps);\n    \n    rgbCol = (rgbCol-fMinMax.x)*fMinMax.y + nMinMax.x;\n    \n    float curLum = dot(rgbCol,vec3(0.25,0.5,0.25));\n    float newLum = calcNegWhites(curLum,negWhites);\n    float lumScale = newLum/(curLum+0.00000190734863);\n    rgbCol *= lumScale;\n\n    rgbCol = calcNegBlacks(rgbCol,negBlacks);\n\n    curLum = dot(rgbCol,vec3(0.25,0.5,0.25));\n    newLum = calcPosBlacks(curLum,posBlacks);\n    lumScale = newLum/(curLum+0.00000190734863);\n    rgbCol *= lumScale;\n    \n    //***stagesPreTone\n    \n    rgbCol = evalToneCurve(renderCurve,rgbCol);\n    \n    //***stagesPostTone\n    \n    rgbCol = toSRGBMatr * rgbCol;\n    col.rgb = sRGBGamma(rgbCol);\n    \n    gl_FragColor = col;\n}"],["srgb2lin-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec3 cs = clamp( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ).xyz, 0.0, 1.0 );\n    gl_FragColor = vec4( mix( cs / 12.92, pow( (cs + 0.055)/1.055, vec3( 2.4 ) ), step( 0.04045, cs ) ), 1.0 );\n}\n"],["standard-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying highp vec2 vTexCoord;\n\nuniform mat3 uPositionTransform;\n\nvoid main()\n{\n    vTexCoord = aTexCoord;\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["tonemap-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 minmax;\n\nvoid main()\n{\n    gl_FragColor = vec4( clamp( texture2D( uSampler, vTexCoord ).xyz, minmax.x, minmax.y ), 1.0 );\n}\n"]]);function fn(e,t,n){var a,r=t,i=hn.get(r);if(void 0===i&&(i=hn.get(n),r=n),-1!==r.indexOf("-fs"))a=e.createShader(e.FRAGMENT_SHADER);else{if(-1===r.indexOf("-vs"))return null;a=e.createShader(e.VERTEX_SHADER)}return null==a||void 0===i?null:(e.shaderSource(a,i),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:null)}function pn(e,t,n){switch(t){case e.FLOAT_VEC2:return[e.FLOAT,2*n];case e.FLOAT_VEC3:return[e.FLOAT,3*n];case e.FLOAT_VEC4:return[e.FLOAT,4*n];case e.INT_VEC2:return[e.INT,2*n];case e.INT_VEC3:return[e.INT,3*n];case e.INT_VEC4:return[e.INT,4*n];case e.FLOAT_MAT2:return[e.FLOAT,2*n*2];case e.FLOAT_MAT3:return[e.FLOAT,3*n*3];case e.FLOAT_MAT4:return[e.FLOAT,4*n*4];case e.INT:case e.FLOAT:case e.SAMPLER_2D:case e.SAMPLER_CUBE:return[t,n];default:return[e.FLOAT,0]}}var mn=function(){function e(t,n,a){if(Object(c.a)(this,e),this.glContext=t,this.program=null,this.attributes=null,this.uniforms=null,this.indexBuffer=null,this.filename=a,a in n){var r=n.get(a);void 0!==r&&(this.program=r)}else{var i=fn(this.glContext,"".concat(a,"-fs"),""),o=fn(this.glContext,"".concat(a,"-vs"),"standard-vs"),s=this.glContext.createProgram();null!==s&&null!=o&&null!=i&&(this.program=s,this.glContext.attachShader(this.program,o),this.glContext.attachShader(this.program,i),this.glContext.linkProgram(this.program),this.glContext.getProgramParameter(this.program,this.glContext.LINK_STATUS),this.glContext.deleteShader(i),this.glContext.deleteShader(o),n.set(a,this.program))}if(this.glContext.useProgram(this.program),this.attributes=new Map,null!==this.program){for(var l=this.glContext.getProgramParameter(this.program,this.glContext.ACTIVE_ATTRIBUTES),u=0;u<l;++u){var d=this.glContext.getActiveAttrib(this.program,u);if(null===d)return;var h=pn(this.glContext,d.type,d.size),f=this.glContext.getAttribLocation(this.program,d.name);if(this.glContext.enableVertexAttribArray(f),this.attributes.set(d.name,{location:f,buffer:null,type:h[0],size:h[1]}),"aPosition"===d.name){var p=this.attributes.get(d.name);if(void 0===p)return;p.buffer=this.glContext.createBuffer(),this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,p.buffer);this.glContext.bufferData(this.glContext.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.glContext.STATIC_DRAW)}else if("aTexCoord"===d.name){var m=this.attributes.get(d.name);if(void 0===m)return;m.buffer=this.glContext.createBuffer(),this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,m.buffer);this.glContext.bufferData(this.glContext.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),this.glContext.STATIC_DRAW)}}this.uniforms=new Map;for(var v=this.glContext.getProgramParameter(this.program,this.glContext.ACTIVE_UNIFORMS),g=0;g<v;++g){var b=this.glContext.getActiveUniform(this.program,g);if(null===b)return;var y=this.glContext.getUniformLocation(this.program,b.name);if(null===y)return;if(this.uniforms.set(b.name,{location:y,buffer:null,type:b.type,size:b.size,name:b.name}),"uPositionTransform"===b.name){var E=$e.c.create(),w=this.uniforms.get(b.name);if(void 0===w)return;w.buffer=new Float32Array(E)}}this.indexBuffer=this.glContext.createBuffer(),this.glContext.bindBuffer(this.glContext.ELEMENT_ARRAY_BUFFER,this.indexBuffer);this.glContext.bufferData(this.glContext.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,3]),this.glContext.STATIC_DRAW)}}return Object(u.a)(e,[{key:"destroy",value:function(){if(this.glContext.deleteBuffer(this.indexBuffer),null!=this.attributes){var e,t=Object(dn.a)(this.attributes);try{for(t.s();!(e=t.n()).done;){var n=e.value[1];null!=n&&this.glContext.deleteBuffer(n.buffer)}}catch(a){t.e(a)}finally{t.f()}}}},{key:"getUniform",value:function(e){if(null==this.uniforms)return null;var t=this.uniforms.get(e);return void 0===t?null:t}},{key:"render",value:function(e){var t=this.glContext.getParameter(this.glContext.CURRENT_PROGRAM);this.glContext.useProgram(this.program),this.updateProgram(e),this.glContext.bindBuffer(this.glContext.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.glContext.drawElements(this.glContext.TRIANGLE_STRIP,4,this.glContext.UNSIGNED_SHORT,0),this.glContext.useProgram(t)}},{key:"updateProgram",value:function(e){var t=this;if(void 0!==e&&(e.soso=2),null!=this.attributes){this.attributes.forEach((function(e){if(null!=t.attributes){var n=e;void 0!==n&&(t.glContext.bindBuffer(t.glContext.ARRAY_BUFFER,n.buffer),t.glContext.vertexAttribPointer(n.location,n.size,n.type,!1,0,0))}}));var n=[],a=0;if(null!=this.uniforms){this.uniforms.forEach((function(e){null!=t.uniforms&&n.push(e)}));for(var r=0,i=n;r<i.length;r++){var o=i[r];if(void 0===o)return;if(null==o.buffer)return;switch(o.type){case this.glContext.FLOAT:this.glContext.uniform1fv(o.location,o.buffer);break;case this.glContext.FLOAT_VEC2:this.glContext.uniform2fv(o.location,o.buffer);break;case this.glContext.FLOAT_VEC3:this.glContext.uniform3fv(o.location,o.buffer);break;case this.glContext.FLOAT_VEC4:this.glContext.uniform4fv(o.location,o.buffer);break;case this.glContext.INT:this.glContext.uniform1iv(o.location,o.buffer);break;case this.glContext.INT_VEC2:this.glContext.uniform2iv(o.location,o.buffer);break;case this.glContext.INT_VEC3:this.glContext.uniform3iv(o.location,o.buffer);break;case this.glContext.INT_VEC4:this.glContext.uniform4iv(o.location,o.buffer);break;case this.glContext.FLOAT_MAT2:this.glContext.uniformMatrix2fv(o.location,!1,o.buffer);break;case this.glContext.FLOAT_MAT3:this.glContext.uniformMatrix3fv(o.location,!1,o.buffer);break;case this.glContext.FLOAT_MAT4:this.glContext.uniformMatrix4fv(o.location,!1,o.buffer);break;case this.glContext.SAMPLER_2D:for(var s=Array.isArray(o.buffer)?o.buffer:[o.buffer],l=[],c=0;c<s.length;++c)this.glContext.activeTexture(this.glContext.TEXTURE0+a),this.glContext.bindTexture(this.glContext.TEXTURE_2D,s[c]),l.push(a++);this.glContext.uniform1iv(o.location,l)}}}}}}]),e}(),vn=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a,r){var i;return Object(c.a)(this,n),(i=t.call(this,e,a,r?"gaussianbigsigma":"gaussian")).horizontal=!0,i}return Object(u.a)(n,[{key:"updateProgram",value:function(e){if(null!=this.uniforms&&void 0!==e){var t=this.uniforms.get("uTextureUnit");void 0!==t&&(t.buffer=this.horizontal?[1/e.width,0]:[0,1/e.height])}Object(h.a)(Object(f.a)(n.prototype),"updateProgram",this).call(this,e)}}]),n}(mn);function gn(e,t,n,a,r){if(void 0===e.toneMappingShaders)return null;var i=r;"undefined"===typeof r&&void 0!==e.toneMappingShaders.gaussianShader&&(i=e.toneMappingShaders.gaussianShader),n=Math.round(n),a=Math.round(a),i.horizontal=!0;var o=Mn(e.gl);if(null==o)return null;Rn(e.gl,i,$e.c.create(),t,n,a,t.type,o),i.horizontal=!1;var s=Mn(e.gl);return null==s?null:(Rn(e.gl,i,$e.c.create(),o,o.width,o.height,t.type,s),Tn(e.gl,o),s)}var bn=function(){function e(t,n){Object(c.a)(this,e),this.context=t,this.levels=[n];var a=n.width,r=n.height;do{a=Math.max(a/2,1),r=Math.max(r/2,1);var i=Math.round(a),o=Math.round(r),s=gn(this.context,this.levels[this.levels.length-1],i,o);null!=s&&this.levels.push(s)}while(1!==this.levels[this.levels.length-1].width||1!==this.levels[this.levels.length-1].height)}return Object(u.a)(e,[{key:"destroy",value:function(){for(var e in this.levels)Tn(this.context.gl,this.levels[e])}}]),e}(),yn=(new Float32Array([0,.00237489,.00496978,.00739292,.00952519,.01140722,.01313902,.01473082,.01622254,.01765395,.01901583,.02032755,.02159865,.02283053,.02402233,.02520346,.0263457,.02747726,.02858875,.02969016,.03076227,.03183356,.03289564,.03394681,.03497884,.0360099,.0370319,.03804284,.03904479,.04003675,.04102753,.04200945,.04298137,.043952,.04491387,.04586576,.04681623,.04775806,.0486999,.04963174,.05056202,.05148382,.05240397,.05331742,.05422749,.05513102,.05603102,.05693094,.05782266,.05871438,.05959611,.06047783,.06134955,.0622292,.06310088,.06397256,.06483425,.0656937,.06654761,.06740698,.06825098,.06910266,.06995191,.07079356,.0716252,.07246685,.07329849,.07413014,.07495912,.07578073,.07661232,.07743116,.07824554,.07906429,.07987585,.08069035,.08149898,.08230357,.08311211,.08391368,.08471525,.08551364,.08630517,.08709995,.0878915,.08867975,.08947127,.0902528,.09104433,.09182585,.09260738,.0933789,.09415683,.09493196,.09570348,.09647502,.09724654,.09801427,.09877575,.09954111,.10030873,.10107022,.1018217,.10258319,.10334061,.10409617,.10484765,.10559914,.10635063,.10709785,.10784361,.10859074,.10933219,.11007807,.11082509,.11157654,.11232252,.11307401,.1138255,.11457699,.11533378,.11608996,.11684145,.11760294,.11836442,.11912592,.1198874,.12064889,.12141538,.12218186,.12295336,.12371997,.12449148,.12526301,.12603454,.12681606,.12758759,.12836911,.12915064,.12993218,.1307137,.13150522,.13229232,.13307828,.1338698,.13466132,.13545857,.13625439,.1370517,.13785326,.13865484,.13945641,.14026797,.14107552,.14188111,.14269266,.14350423,.14432193,.14514354,.14595515,.14677675,.14760464,.14842996,.14926156,.15008959,.15092123,.15175289,.15259452,.15342958,.1542678,.15511611,.1559611,.15680946,.15765439,.15850604,.15936452,.16021621,.16107789,.16193959,.16280125,.16367294,.16454171,.1654163,.16628799,.16716687,.16804135,.16892031,.16981204,.17069376,.17158547,.17247722,.1733764,.17426816,.17516991,.17607929,.17698345,.1778852,.17879698,.17971648,.18063048,.18155007,.18247187,.18340158,.18432549,.18525729,.1861971,.18713894,.18808079,.18902262,.18996447,.19091631,.1918664,.19282827,.19379015,.19475204,.19571391,.19668424,.19765617,.19862808,.19960999,.20059192,.20157383,.20256576,.20355769,.20455834,.20555151,.20656112,.20756422,.2085751,.2095871,.21060909,.21163109,.21265309,.21368422,.21471626,.21574828,.2167903,.21783234,.21888372,.21993577,.22098784,.22204992,.223112,.22417407,.22524615,.22631821,.22739993,.22848204,.22957414,.230666,.23176816,.23286031,.23397246,.23507462,.23619671,.2373089,.2384311,.23956327,.24069546,.24182779,.24297006,.24411251,.2452645,.24641703,.24757929,.24874194,.24991423,.25108653,.25226888,.25345117,.25463405,.25582638,.25702873,.25824109,.25944418,.26066577,.26187897,.26311135,.26434374,.26557702,.26681945,.26806289,.26931533,.27057779,.27184027,.27310392,.27438641,.27566013,.27695143,.27824521,.27953911,.28085029,.28216287,.28347689,.28479946,.28612357,.28746462,.28880045,.29015142,.29150575,.29285842,.29422286,.29560378,.29697829,.29836285,.2997556,.30115834,.30256107,.30397385,.30538869,.30682147,.3082464,.30968919,.31113428,.31258714,.31404999,.31551525,.31699574,.31847346,.31996641,.32145932,.32296482,.32447779,.32600075,.3275238,.32905945,.3306025,.33214828,.33371133,.33527437,.33685035,.33843341,.34001955,.34162268,.34322581,.34484205,.3464652,.34809154,.34973475,.35138124,.35304451,.35470778,.3563844,.35806769,.35975787,.36146772,.36317107,.36489153,.36662501,.36836475,.37011179,.37186894,.37364239,.3754096,.37720311,.37900048,.380808,.38262755,.38445508,.38629267,.38814038,.38999811,.39187181,.39374968,.39564344,.39754716,.39945519,.40138894,.40331709,.40526533,.40722916,.40919751,.41118145,.4131799,.41518378,.41720238,.41923106,.42127502,.42332903,.42540267,.42747679,.4295758,.43168485,.43380398,.43593812,.4380874,.44024649,.44242096,.44461048,.44681478,.44903433,.45126867,.45351368,.45577347,.45805794,.46034241,.46265793,.46497798,.46732253,.46967274,.47204298,.47443333,.47683805,.47925848,.48170492,.48415971,.48663044,.4891212,.49162608,.49415696,.49670398,.49926898,.50185633,.50446141,.50708264,.50973028,.51239175,.51506698,.51777858,.52051026,.52325207,.52602041,.52881229,.53163093,.53446651,.53732866,.54021758,.54311997,.54605252,.54901183,.55199766,.55500412,.55804002,.56109285,.56417584,.56730592,.57044625,.57360953,.57681572,.58004349,.58330703,.58660066,.58992165,.59328014,.59667158,.60008085,.60354996,.60703915,.61055356,.6141156,.61771262,.62135255,.62502515,.62874556,.63249284,.63629138,.64012671,.64401996,.64794135,.65191495,.65593082,.66000885,.66412306,.66828924,.67251003,.67678469,.68112421,.68549275,.68995309,.69445014,.69902092,.70365524,.70833129,.71310455,.7179395,.72285187,.72783619,.73289204,.73804551,.74327189,.74857479,.75397295,.75947785,.76506311,.77078569,.77658296,.78249043,.78854442,.79470003,.80099618,.80740523,.81398237,.82068944,.82757771,.83464378,.84187275,.84929043,.85691893,.86478841,.87286919,.88120967,.88983017,.89875185,.90803343,.91766715,.92768061,.93817639,.94917262,.960751,.97300148,.98602414,1]),new Float32Array([0,.00160321,.00314556,.00460928,.00624393,.00807957,.01014583,.01241315,.01489102,.01755896,.02038753,.0233763,.02650562,.02975497,.03312425,.03658333,.04013209,.04374176,.04743104,.05117055,.05498029,.05884027,.06276049,.06673094,.07075975,.07483058,.07895064,.08312086,.08733123,.09158289,.09588362,.10022449,.10460429,.10901673,.11347675,.11796822,.12249985,.12706162,.13166356,.13630413,.14097634,.1456771,.15040959,.15517223,.15997502,.16480622,.16966748,.17455068,.17947404,.18442562,.18939923,.19440901,.19944288,.20450482,.20958894,.21471107,.21985109,.22497112,.23007658,.23516423,.24022178,.24525926,.25027424,.25526151,.26022869,.26516584,.2700803,.27496725,.27982408,.28465816,.2894648,.2942414,.29899505,.30372146,.30841774,.31309104,.31772712,.32234317,.32692602,.33148882,.33601451,.34052014,.34499249,.34943795,.35385001,.35823524,.36260039,.36693209,.37123707,.37550849,.37975323,.38397795,.38816896,.39233345,.39646786,.4005785,.40465271,.4087069,.41273713,.41673112,.42070496,.42465481,.42856848,.43246207,.43632558,.44016495,.44397825,.44776732,.45152044,.45525926,.45896649,.46265504,.46630782,.46994051,.47354865,.47713119,.48069358,.48422596,.4877336,.49121577,.49467781,.49810985,.50152695,.50491363,.50828052,.51162219,.51494366,.51823521,.52150655,.52475798,.52798915,.53119522,.53437626,.53753722,.54067814,.54378903,.54688966,.54996037,.55301559,.55604601,.5590564,.56204677,.56501698,.56796718,.57089287,.57380283,.57669288,.57956272,.58241254,.58524638,.58806193,.59085149,.59363097,.59638637,.59911972,.60184503,.60454816,.60723341,.6098963,.61255145,.61518037,.61779916,.62039429,.6229766,.62554157,.62809014,.63061869,.63313705,.63563532,.63812023,.6405884,.64303654,.64547455,.64789927,.65030724,.65269506,.65507281,.65743053,.65977818,.66211271,.6644302,.66673464,.66902208,.67129654,.67355663,.67580098,.67803806,.68025506,.68245935,.68465626,.68683314,.68899739,.69115412,.69329071,.69541484,.6975314,.69963545,.70172185,.70379817,.70586222,.70790845,.70995241,.7119785,.71399248,.71599847,.71798432,.7199682,.72193396,.7238878,.72583348,.72776735,.72968453,.73159832,.73349363,.73538733,.737261,.73912621,.74098134,.74282497,.74466002,.74648356,.74829715,.75009328,.75188679,.75367028,.75544381,.75719959,.75895298,.76069635,.76242077,.76414418,.76585752,.76755273,.76924604,.77092934,.77260256,.77425742,.77591062,.77755451,.77918774,.78082091,.78243405,.78403777,.78564084,.78722441,.78880751,.79037106,.79193407,.79348737,.79503042,.79656363,.7980966,.79960972,.80112267,.8026256,.80411857,.80560142,.80707431,.80854702,.81,.81145269,.81289554,.81432831,.81576085,.8171736,.81858605,.81998873,.82138145,.82277375,.82415593,.82552856,.82689124,.82824391,.82959592,.8309378,.83227032,.83359295,.83491552,.83622724,.83752978,.83883131,.84011388,.84139633,.84267777,.84394026,.84520274,.84646404,.84770644,.84894884,.85017997,.8514024,.85262477,.85383713,.85504812,.85624039,.85744119,.8586235,.85980415,.86097646,.86213875,.86330104,.86445332,.86560369,.8667441,.86787629,.86899853,.87012064,.87124079,.872343,.87344515,.87454522,.87563729,.87671942,.87779927,.87887132,.87993342,.88099551,.88204515,.88309723,.8841393,.88517123,.88620073,.88722277,.88824469,.88925672,.890266,.8912679,.89225996,.89324903,.89423096,.89521289,.8961848,.89715374,.89811563,.89906752,.90001935,.90096807,.90190673,.90284169,.90377033,.90469217,.90561402,.90652573,.90743411,.9083358,.90923417,.91012585,.9110111,.91188931,.91277099,.91364276,.91451073,.91537243,.91622406,.91707575,.91792357,.91876525,.91960287,.92043447,.92125607,.92207766,.92289931,.92371094,.92451829,.92531985,.92611718,.92690861,.92770016,.9284817,.92925882,.93003476,.93080175,.93156326,.93232477,.93308163,.933833,.93457925,.93532121,.93605739,.9367888,.93751544,.93824685,.93895829,.93967962,.94038606,.94109738,.94179875,.9424901,.94318628,.94387287,.94455898,.94524038,.94591165,.94658756,.94724888,.9479202,.94857144,.94922727,.94987851,.95052969,.95117092,.95180655,.95243776,.95306891,.95369601,.95432138,.95493257,.95554793,.95615906,.95676017,.95736146,.95796257,.95855761,.95914876,.95972991,.96031106,.9608922,.96146703,.9620381,.9626056,.96317029,.96372485,.96428251,.96483362,.96537805,.96592569,.96646345,.9670012,.96753228,.96806335,.96858752,.96910858,.96962965,.97014058,.97065163,.97115564,.97166663,.97216046,.97265857,.97314954,.97364056,.97412425,.9746052,.97508609,.97555965,.97603059,.97650146,.97696239,.97742325,.97788423,.97833741,.97878832,.97923923,.97968006,.9801209,.98056185,.98099267,.98142344,.98184645,.98227727,.98269808,.9831109,.98352969,.98394054,.98434323,.98474401,.98514479,.98554558,.98593807,.98632878,.98671949,.98710871,.98749101,.98786318,.98824245,.98861325,.98898393,.98934603,.98970675,.99006742,.99042821,.99078006,.99113071,.99148136,.99182206,.9921627,.99250335,.99283499,.99317467,.99349624,.99382687,.99414748,.99446815,.99478871,.99509931,.99541062,.99572116,.99602175,.99633235,.99663293,.99692351,.9972145,.99750507,.99779564,.99808592,.99836671,.99864727,.998918,.99919832,.99946886,.99973947,1]),function(){function e(t,n){Object(c.a)(this,e),this.context=t.context,this.levels=[];for(var a=0;a<t.levels.length-1;++a){var r=null;if(n)r=In(this.context.gl,t.levels[a].format,t.levels[a].type,t.levels[a].width,t.levels[a].height);else{var i=gn(this.context,t.levels[a+1],t.levels[a].width,t.levels[a].height);if(null==i)return;r=jn(this.context,1,t.levels[a],-1,i),Tn(this.context.gl,i)}null!=r&&this.levels.push(r)}this.levels.push(t.levels[t.levels.length-1])}return Object(u.a)(e,[{key:"collapse",value:function(){for(var e=this.levels[this.levels.length-1],t=this.levels.length-2;t>=0;--t){var n=gn(this.context,e,this.levels[t].width,this.levels[t].height);if(null==n)return null;e!==this.levels[this.levels.length-1]&&Tn(this.context.gl,e);var a=jn(this.context,1,n,1,this.levels[t]);if(null==a)return null;e=a,Tn(this.context.gl,n)}return e}},{key:"destroy",value:function(){for(var e=0;e<this.levels.length-1;e++)Tn(this.context.gl,this.levels[e])}}]),e}());var En=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a){return Object(c.a)(this,n),t.call(this,e,a,"minmaxmean")}return Object(u.a)(n,[{key:"updateProgram",value:function(e){if(null!=this.uniforms&&void 0!==e){var t=this.uniforms.get("uTextureUnit");void 0!==t&&(t.buffer=[.5/e.width,.5/e.height])}Object(h.a)(Object(f.a)(n.prototype),"updateProgram",this).call(this,e)}}]),n}(mn),wn=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a){return Object(c.a)(this,n),t.call(this,e,a,"moments")}return Object(u.a)(n,[{key:"updateProgram",value:function(e){if(null!=this.uniforms&&void 0!==e){var t=this.uniforms.get("uTextureUnit");void 0!==t&&(t.buffer=[.5/e.width,.5/e.height])}Object(h.a)(Object(f.a)(n.prototype),"updateProgram",this).call(this,e)}}]),n}(mn),xn=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a){return Object(c.a)(this,n),t.call(this,e,a,"reductionsum")}return Object(u.a)(n,[{key:"updateProgram",value:function(e){if(null!=this.uniforms&&void 0!==e){var t=this.uniforms.get("uTextureUnit");void 0!==t&&(t.buffer=[.5/e.width,.5/e.height])}Object(h.a)(Object(f.a)(n.prototype),"updateProgram",this).call(this,e)}}]),n}(mn),kn=function(){function e(t){Object(c.a)(this,e),this.min=0,this.max=0,this.mean=0,this.absskew=0,this.median=0,void 0!==t&&(this.min=t.min,this.max=t.max,this.mean=t.mean,this.absskew=t.absskew,this.median=t.median)}return Object(u.a)(e,[{key:"clone",value:function(){return new e({min:this.min,max:this.max,mean:this.mean,absskew:this.absskew,median:this.median})}}]),e}();function Sn(e,t){var n=function(e,t){if(void 0===e.toneMappingShaders)return null;var n=t,a=null,r=n.width,i=n.height;if(null==e.toneMappingShaders.minmaxmeanShader)return null;if(null==e.toneMappingShaders.log2linShader)return null;do{if(null==(a=Mn(e.gl)))return null;r=Math.max(r/2,1),i=Math.max(i/2,1);var o=Math.round(r),s=Math.round(i);Rn(e.gl,e.toneMappingShaders.minmaxmeanShader,$e.c.create(),n,o,s,e.texFloatFormat,a),n!==t&&Tn(e.gl,n),n=a}while(a.width>1||a.height>1);var l=Mn(e.gl);if(null==l)return null;Rn(e.gl,e.toneMappingShaders.log2linShader,$e.c.create(),a,a.width,a.height,e.gl.UNSIGNED_BYTE,l);var c=e.gl.createFramebuffer();e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,c),e.gl.framebufferTexture2D(e.gl.FRAMEBUFFER,e.gl.COLOR_ATTACHMENT0,e.gl.TEXTURE_2D,l,0);var u=new Uint8Array(4);e.gl.readPixels(0,0,1,1,e.gl.RGBA,e.gl.UNSIGNED_BYTE,u),e.gl.deleteFramebuffer(c),Tn(e.gl,a),Tn(e.gl,l);var d=new kn;return d.min=Math.log2(u[0]/255+.000244140625),d.max=Math.log2(u[1]/255+.000244140625),d.mean=Math.log2(u[2]/255+.000244140625),d}(e,t);if(null==n)return null;var a=function(e,t,n,a,r){if(void 0===e.toneMappingShaders)return null;if(null==e.toneMappingShaders.momentsShader)return null;if(null==e.toneMappingShaders.reductionsumShader)return null;if(null==e.toneMappingShaders.blitscaleShader)return null;var i=e.toneMappingShaders.momentsShader.getUniform("uMean");if(null==i)return null;i.buffer=[r];var o=t,s=null,l=o.width,c=o.height,u=!0;do{if(null==(s=Mn(e.gl)))return null;l=Math.max(l/2,1),c=Math.max(c/2,1);var d=Math.round(l),h=Math.round(c);Rn(e.gl,u?e.toneMappingShaders.momentsShader:e.toneMappingShaders.reductionsumShader,$e.c.create(),o,d,h,e.texFloatFormat,s),u=!1,o!==t&&Tn(e.gl,o),o=s}while(s.width>1||s.height>1);var f,p=Math.pow(a-n,2)/4,m=Mn(e.gl);if(null==m)return null;if(null==(i=e.toneMappingShaders.blitscaleShader.getUniform("uScale")))return null;i.buffer=[1/p,1,1,1],Rn(e.gl,e.toneMappingShaders.blitscaleShader,$e.c.create(),s,s.width,s.height,e.gl.UNSIGNED_BYTE,m);var v=e.gl.createFramebuffer();e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,v),e.gl.framebufferTexture2D(e.gl.FRAMEBUFFER,e.gl.COLOR_ATTACHMENT0,e.gl.TEXTURE_2D,m,0);var g=new Uint8Array(4);e.gl.readPixels(0,0,1,1,e.gl.RGBA,e.gl.UNSIGNED_BYTE,g),f=g[0]/255*p,e.gl.deleteFramebuffer(v),Tn(e.gl,m);var b,y=1.5*Math.pow(f,1.5);if(null==(m=Mn(e.gl)))return null;if(null==(i=e.toneMappingShaders.blitscaleShader.getUniform("uScale")))return null;i.buffer=[1,1/y,1,1],Rn(e.gl,e.toneMappingShaders.blitscaleShader,$e.c.create(),s,s.width,s.height,e.gl.UNSIGNED_BYTE,m),v=e.gl.createFramebuffer(),e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,v),e.gl.framebufferTexture2D(e.gl.FRAMEBUFFER,e.gl.COLOR_ATTACHMENT0,e.gl.TEXTURE_2D,m,0),g=new Uint8Array(4),e.gl.readPixels(0,0,1,1,e.gl.RGBA,e.gl.UNSIGNED_BYTE,g),b=g[1]/255*y/Math.pow(f,1.5),e.gl.deleteFramebuffer(v),Tn(e.gl,m),Tn(e.gl,s);var E={variance:0,absskew:0};return E.variance=f,E.absskew=b,E}(e,t,n.min,n.max,n.mean);return null==a?null:(n.absskew=a.absskew,n)}var Cn=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a){return Object(c.a)(this,n),t.call(this,e,a,"greylog2")}return Object(u.a)(n,[{key:"destroy",value:function(){Object(h.a)(Object(f.a)(n.prototype),"destroy",this).call(this)}}]),n}(mn),On=function(){function e(t,n){Object(c.a)(this,e),this.shaderProgramIndex=new Map,this.greyShader=new Cn(t,this.shaderProgramIndex),this.blitShader=new mn(t,this.shaderProgramIndex,"blit"),this.log2linShader=new mn(t,this.shaderProgramIndex,"log2lin"),this.lin2srgbShader=new mn(t,this.shaderProgramIndex,"lin2srgb"),this.srgb2linShader=new mn(t,this.shaderProgramIndex,"srgb2lin"),this.gaussianShader=new vn(t,this.shaderProgramIndex,!1),n&&(this.gaussianbigsigmaShader=new vn(t,this.shaderProgramIndex,!0)),this.addShader=new mn(t,this.shaderProgramIndex,"add"),this.minmaxmeanShader=new En(t,this.shaderProgramIndex),this.momentsShader=new wn(t,this.shaderProgramIndex),this.reductionsumShader=new xn(t,this.shaderProgramIndex),this.tonemapShader=new mn(t,this.shaderProgramIndex,"tonemap"),this.llfShader=new mn(t,this.shaderProgramIndex,"llf"),this.deltaMaskShader=new mn(t,this.shaderProgramIndex,"deltamask"),this.blitscaleShader=new mn(t,this.shaderProgramIndex,"blitscale"),this.lumShader=new mn(t,this.shaderProgramIndex,"lum"),this.blitxShader=new mn(t,this.shaderProgramIndex,"blitx")}return Object(u.a)(e,[{key:"destroy",value:function(e){if(void 0!==this.shaderProgramIndex){var t,n=Object(dn.a)(this.shaderProgramIndex);try{for(n.s();!(t=n.n()).done;){var a=t.value;e.deleteProgram(a[1])}}catch(r){n.e(r)}finally{n.f()}}this.greyShader&&this.greyShader.destroy(),this.log2linShader&&this.log2linShader.destroy(),this.lin2srgbShader&&this.lin2srgbShader.destroy(),this.srgb2linShader&&this.srgb2linShader.destroy(),this.blitShader&&this.blitShader.destroy(),this.gaussianShader&&this.gaussianShader.destroy(),this.gaussianbigsigmaShader&&this.gaussianbigsigmaShader.destroy(),this.addShader&&this.addShader.destroy(),this.minmaxmeanShader&&this.minmaxmeanShader.destroy(),this.momentsShader&&this.momentsShader.destroy(),this.reductionsumShader&&this.reductionsumShader.destroy(),this.tonemapShader&&this.tonemapShader.destroy(),this.llfShader&&this.llfShader.destroy(),this.deltaMaskShader&&this.deltaMaskShader.destroy(),this.blitscaleShader&&this.blitscaleShader.destroy(),this.lumShader&&this.lumShader.destroy(),this.blitxShader&&this.blitxShader.destroy()}}]),e}(),Pn=0;function Tn(e,t){e.deleteTexture(t),Pn--}function Mn(e,t,n){Pn++;var a=e.createTexture();return a.type="undefined"!==typeof t?t:e.UNSIGNED_BYTE,a.format="undefined"!==typeof n?n:e.RGBA,e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),a}function In(e,t,n,a,r){var i=Mn(e,n,t);i.width=a,i.height=r;var o=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.texImage2D(e.TEXTURE_2D,0,i.format,i.width,i.height,0,i.format,i.type,null),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.deleteFramebuffer(o),i}function An(e,t){var n=Mn(e);return n.width=t.width,n.height=t.height,e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,n.format,n.format,e.UNSIGNED_BYTE,t),n}!function(){var e=new Float32Array(1),t=new Int32Array(e.buffer)}();function Rn(e,t,n,a,r,i,o,s){r=Math.round(r),i=Math.round(i);var l=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,l),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,s.format,r,i,0,s.format,o,null),s.width=r,s.height=i,s.type=o,e.viewport(0,0,r,i);var c=t.uniforms;if(null!=c){if(Array.isArray(a)){var u=c.get("uSamplers[0]");void 0!==u&&(u.buffer=a)}else{var d=c.get("uSampler");void 0!==d&&(d.buffer=a)}var h="undefined"!==typeof n?n:$e.c.create(),f=c.get("uPositionTransform");void 0!==f&&(f.buffer=new Float32Array(h))}t.render(s),e.deleteFramebuffer(l),e.bindFramebuffer(e.FRAMEBUFFER,null),e.flush()}function Dn(e,t,n,a,r,i){var o=Math.min(2048/Math.max(n,a),1);n*=o,a*=o,n=Math.round(n),a=Math.round(a);var s=document.createElement("canvas");s.width=n,s.height=a;var l=$e.c.create();$e.c.set(l,1,0,0,0,-1,0,0,0,1);var c=Mn(e.gl);if(null==c)return null;if(void 0===e.toneMappingShaders)return null;if(void 0===e.toneMappingShaders.blitxShader)return null;if(void 0===e.toneMappingShaders.blitShader)return null;if(void 0===e.toneMappingShaders.log2linShader)return null;r?Rn(e.gl,"undefined"!==typeof i&&i?e.toneMappingShaders.blitxShader:e.toneMappingShaders.blitShader,l,t,n,a,e.texFloatFormat,c):Rn(e.gl,e.toneMappingShaders.log2linShader,l,t,n,a,e.gl.FLOAT,c);var u=Mn(e.gl);if(null==u)return null;if(void 0===e.toneMappingShaders.lin2srgbShader)return null;Rn(e.gl,e.toneMappingShaders.lin2srgbShader,$e.c.create(),c,n,a,e.gl.UNSIGNED_BYTE,u);var d=e.gl.createFramebuffer();e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,d),e.gl.framebufferTexture2D(e.gl.FRAMEBUFFER,e.gl.COLOR_ATTACHMENT0,e.gl.TEXTURE_2D,u,0);var h=new Uint8Array(n*a*4);e.gl.readPixels(0,0,n,a,e.gl.RGBA,e.gl.UNSIGNED_BYTE,h),e.gl.deleteFramebuffer(d),Tn(e.gl,c),Tn(e.gl,u);var f=s.getContext("2d");if(null==f)return null;var p=f.createImageData(n,a);return p.data.set(h),f.putImageData(p,0,0),s}function jn(e,t,n,a,r){var i=Mn(e.gl);if(null==i)return null;if(void 0===e.toneMappingShaders)return null;if(void 0===e.toneMappingShaders.addShader)return null;var o=e.toneMappingShaders.addShader.getUniform("uScales[0]");return null==o?null:(o.buffer=new Float32Array([t,a]),Rn(e.gl,e.toneMappingShaders.addShader,$e.c.create(),[n,r],n.width,n.height,n.type,i),i)}var _n=function(){function e(){Object(c.a)(this,e),this.toneMapMask=null}return Object(u.a)(e,[{key:"initWithBitmap",value:function(e,t,n,a){this.toneMapMask=An(e.gl,t),this.srcStats=n.clone(),this.dstStats=a.clone()}},{key:"initWithTexture",value:function(e,t){var n=(new Date).getTime();if(this.toneMapMask=Mn(e.gl),null!=this.toneMapMask&&void 0!==e.toneMappingShaders&&void 0!==e.toneMappingShaders.blitShader&&void 0!==e.toneMappingShaders.greyShader){for(var a,r=t,i=t.width,o=t.height,s=0;s<2;s++){var l=Mn(e.gl);if(null==l)return;i/=2,o/=2,Rn(e.gl,e.toneMappingShaders.blitShader,$e.c.create(),r,i,o,e.gl.UNSIGNED_BYTE,l),r!==t&&Tn(e.gl,r),r=l}a=r;var c=Mn(e.gl);if(null!=c){Rn(e.gl,e.toneMappingShaders.greyShader,$e.c.create(),a,a.width,a.height,e.texFloatFormat,c);var u=new bn(e,c),d=Sn(e,u.levels[0]);if(null!=d){this.srcStats=d;var h=function(e,t){var n=t.max-t.min,a=function(e,t){for(var n=0;n<e.length;++n)if(t<e[n][0]){if(0===n)return e[n][1];var a=(t-e[n-1][0])/(e[n][0]-e[n-1][0]);return e[n-1][1]*(1-a)+e[n][1]*a}return 0}([[2,1.4],[3.5,1.6],[5,2.3],[6.5,2.5],[12,2.5],[14,2]],n),r=Math.log2(a+.000244140625),i=t.min,o=t.max,s=Math.max(2,1+Math.ceil(n)),l=n/(s-1),c=[new yn(e,!0),new yn(e,!0)],u=0;if(void 0===e.context.toneMappingShaders)return null;if(null==e.context.toneMappingShaders.llfShader)return null;var d=e.context.toneMappingShaders.llfShader.getUniform("inv_ds");if(null==d)return null;d.buffer=[1/((o-i)/(s-1))];for(var h=0;h<s;++h){var f=i+h*l;if(null==e.context.toneMappingShaders.tonemapShader)return null;if(null==(d=e.context.toneMappingShaders.tonemapShader.getUniform("minmax")))return null;d.buffer=[f-r,f+r];var p=Mn(e.context.gl);if(null==p)return null;Rn(e.context.gl,e.context.toneMappingShaders.tonemapShader,$e.c.create(),e.levels[0],e.levels[0].width,e.levels[0].height,e.levels[0].type,p);var m=new bn(e.context,p),v=new yn(m,!1);if(null==(d=e.context.toneMappingShaders.llfShader.getUniform("reference")))return null;d.buffer=[f];for(var g=(u+1)%2,b=0;b<v.levels.length-1;++b){var y=c[u].levels[b],E=c[g].levels[b];Rn(e.context.gl,e.context.toneMappingShaders.llfShader,$e.c.create(),[e.levels[b],v.levels[b],y],E.width,E.height,E.type,E)}m.destroy(),v.destroy(),u=g}var w=c[u].collapse();return c[0].destroy(),c[1].destroy(),w}(u,this.srcStats);if(null!=h){var f=Sn(e,h);if(null!=f&&(this.dstStats=f,null!=e.toneMappingShaders.deltaMaskShader)){var p=e.toneMappingShaders.deltaMaskShader.uniforms;if(null!=p){var m=p.get("uDiffMid");if(void 0!==m){m.buffer=new Float32Array([this.srcStats.mean-this.dstStats.mean]),Rn(e.gl,e.toneMappingShaders.deltaMaskShader,$e.c.create(),[c,h],c.width,c.height,c.type,this.toneMapMask),u.destroy(),Tn(e.gl,c);var v=(new Date).getTime()-n;console.debug("Building tone map mask took ".concat(v,"ms, ").concat(Pn," textures remaining"))}}}}}}}}},{key:"destroy",value:function(e){null!=this.toneMapMask&&e.deleteTexture(this.toneMapMask)}},{key:"getTonemappingBitmap",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,a,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.toneMapMask){e.next=2;break}return e.abrupt("return",null);case 2:if(null!=(n=Dn(t,this.toneMapMask,this.toneMapMask.width,this.toneMapMask.height,!0,!1))){e.next=5;break}return e.abrupt("return",null);case 5:if(a=n,null!=this.srcStats){e.next=8;break}return e.abrupt("return",null);case 8:if(null!=this.dstStats){e.next=10;break}return e.abrupt("return",null);case 10:return r=this.srcStats.clone(),i=this.dstStats.clone(),e.abrupt("return",{imageBitmap:a,srcStats:r,dstStats:i});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ln=function(){function e(t){Object(c.a)(this,e),this.aspect=1,this.aspectX=1,this.aspectY=1,this.groupIdx=1,this.activeGroupMask=3,this.shaderCode="",this.exposureGain=1,this.finalExposure=0,this.abcIndexMatr=new Array(9),this.abcMatr=new Array(9),this.abcScale=$e.f.create(),this.texture=null,this.lcTexture=null,this.cubeVertexPositionBuffer=null,this.cubeVertexTextureCoordBuffer=null,this.cubeVertexIndexBuffer=null,this.gl=t,this.toneControls=new tn,this.toneValues=new en,this.mvMatrix=$e.d.create(),this.pMatrix=$e.d.create(),this.params=function(){for(var e=new Array(29),t=0;t<29;t++)e[t]=Ut[t];return e}(),this.texFloatFormat=t.FLOAT}return Object(u.a)(e,[{key:"destroy",value:function(){null!=this.texture&&this.gl.deleteTexture(this.texture),null!=this.lcTexture&&this.gl.deleteTexture(this.lcTexture),void 0!==this.shaderProgram&&this.gl.deleteProgram(this.shaderProgram),null!=this.cubeVertexPositionBuffer&&this.gl.deleteBuffer(this.cubeVertexPositionBuffer),null!=this.cubeVertexTextureCoordBuffer&&this.gl.deleteBuffer(this.cubeVertexTextureCoordBuffer),null!=this.cubeVertexIndexBuffer&&this.gl.deleteBuffer(this.cubeVertexIndexBuffer),void 0!==this.toneMappingMask&&this.toneMappingMask.destroy(this.gl),void 0!==this.toneMappingShaders&&this.toneMappingShaders.destroy(this.gl)}}]),e}();function Nn(e){!function(e){e.gl.clearColor(0,0,0,0),e.gl.disable(e.gl.DEPTH_TEST);var t=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;if(!e.gl.getExtension("OES_texture_float")||t){var n=e.gl.getExtension("OES_texture_half_float");e.gl.getExtension("OES_texture_half_float_linear"),null!=n?e.texFloatFormat=n.HALF_FLOAT_OES:alert("OES_texture_half_float extension not supported")}else e.gl.getExtension("OES_texture_float_linear")||alert("OES_texture_float_linear extension not supported");e.texFloatFormat,e.toneMappingShaders=new On(e.gl,!1)}(e)}function Vn(e){var t="",n="",a="",r="";if(e.activeGroupMask=2,e.groupIdx=0,0===e.groupIdx&&(t+="uniform highp mat3 abcMatr;\n",t+="uniform highp mat3 indexMatr;\n",t+="uniform highp vec3 abcScale;\n",n+="rgbCol = indexMatr * rgbCol;\n",n+="rgbCol *= abcScale;\n",n+="vec3 colorThresh = abcScale*0.25;\n",n+="vec3 colorScale = 1.0/(abcScale*0.75);\n",n+="float t1 = max(rgbCol.r, rgbCol.g);\n",n+="vec2 recT;\n",n+="recT = max ((rgbCol.rg - colorThresh.xy) * colorScale.xy, 0.0);\n",n+="recT = recT * recT;\n",n+="rgbCol.rg = mix(rgbCol.rg, vec2(t1), recT);\n",n+="t1 = max(0.5 * (rgbCol.r + rgbCol.g), rgbCol.b);\n",n+="recT.x = max((rgbCol.b - colorThresh.z) * colorScale.z, 0.0);\n",n+="recT.x = recT.x * recT.x;\n",n+="rgbCol.b = mix(rgbCol.b, t1, recT.x);\n",n+="rgbCol = abcMatr * rgbCol;\n",n+="rgbCol = clamp(rgbCol,0.0,1.0);\n",e.activeGroupMask|=1),e.groupIdx=2,2===e.groupIdx&&(t+="uniform float saturation;\n",a+="const vec3 lumvec = vec3(0.2880859375, 0.7119140625,0.0);\n",a+="vec3 yuv;\n",a+="yuv.x = dot(rgbCol,lumvec);\n",a+="yuv.y = (rgbCol.r-yuv.x) * (saturation*0.70233196159122);\n",a+="yuv.z = (rgbCol.b-yuv.x) * saturation;\n",a+="yuv = yuv.yyz * vec3(1.423828125,-0.576171875,1.0) + yuv.x;\n",a+="rgbCol = clamp(yuv,0.0,1.0);\n",e.activeGroupMask|=4),e.groupIdx=2,2===e.groupIdx&&(t+="uniform float vibrance;\n",a+="vec3 hsl = rgb2HSL(rgbCol);\n",a+="float sFactor = step(0.0,-vibrance);\n",a+="float vibSat = (hsl.z - hsl.y) / hsl.z;\n",a+="float protection = calcProtection(hsl.x, vibSat);\n",a+="float shadowRolloff = min( 1.0, 16.0 * hsl.z );\n",a+="float saturationMask = vibSat * (1.0 - vibSat);\n",a+="saturationMask *= 2.0 - saturationMask;\n",a+="shadowRolloff *= 2.0 - shadowRolloff;\n",a+="float brightnessFactor = shadowRolloff * saturationMask;\n",a+="float shiftFactor = vibrance * (vibrance * protection + 1.0 - protection);\n",a+="float saturationFactor = (35.0 - 17.0*protection)/42.0 * shiftFactor * (1.0 - hsl.y)*shadowRolloff;\n",a+="float satPos = vibSat / (1.0 - saturationFactor * (1.0 - vibSat));\n",a+="float brightPos = brightnessFactor * shiftFactor * 0.25;\n",a+="saturationFactor = -vibrance;\n",a+="float satNeg = vibSat;\n",a+="satNeg *= 1.0 - saturationFactor + saturationFactor * vibSat * (0.5 + 0.5 * vibSat) * shadowRolloff;\n",a+="satNeg *= 1.0 - 0.25 * saturationFactor;\n",a+="float brightNeg = -(brightnessFactor*saturationFactor);\n",a+="vibSat = mix(satPos,satNeg,sFactor);\n",a+="brightnessFactor = mix(brightPos,brightNeg,sFactor);\n",a+="hsl.z *= 1.0 + brightnessFactor * (1.0 - hsl.z);\n",a+="hsl.y = hsl.z - vibSat * hsl.z;\n",a+="rgbCol = hsl2RGB(hsl);\n",e.activeGroupMask|=4),e.groupIdx=2,2===e.groupIdx&&(t+="uniform float negClarity;\n",a+="highp vec4 bwCol = texture2D(lcSampler, vTextureCoord.st);\n",a+="float lum = dot(rgbCol,vec3(0.25,0.5,0.25));\n",a+="float dLum = (sqrt(lum + 0.00390625) - 0.0625) * 1.0644512214;\n",a+="float x = dLum*2.0 - 1.0;\n",a+="x = x*x*x*x;\n",a+="x = 1.0-x;\n",a+="x = x*x*x*x;\n",a+="float delta = grayVal - (bwCol.r*256.0+bwCol.g)*0.00390625;\n",a+="dLum = clamp(dLum+delta*x*negClarity,0.0,1.0);\n",a+="dLum = dLum * 0.93945122137 + 0.0625;\n",a+="dLum = (dLum * dLum) - 0.00390625;\n",a+="float scale = dLum/max(lum,0.00001);\n",a+="rgbCol *= scale;\n",e.activeGroupMask|=4),e.groupIdx=2,2===e.groupIdx?(n+="rgbCol = DoToneMap( rgbCol, vTextureCoord );\n",e.activeGroupMask|=4):1===e.groupIdx&&(n+="rgbCol = DoToneMap( rgbCol, vTextureCoord );\n",e.activeGroupMask|=2),e.groupIdx=3,3===e.groupIdx&&(e.activeGroupMask|=8),4===e.groupIdx&&(t+="uniform float splttAlpha;\n",t+="uniform vec3 splttShadow;\n",t+="uniform vec3 splttDelta;\n",r+="vec3 tCol = rgbCol*splttAlpha;\n",r+="rgbCol = tCol/(1.0+tCol-rgbCol);\n",r+="rgbCol = rgbCol*((1.0-rgbCol) * (splttShadow + splttDelta * rgbCol) + rgbCol*rgbCol);\n",r+="tCol = rgbCol/splttAlpha;\n",r+="rgbCol = tCol/(1.0+tCol-rgbCol);\n",e.activeGroupMask|=16),e.groupIdx=5,5===e.groupIdx){t+="uniform float vignetteAmount;\n",t+="uniform float roundness;\n",t+="uniform float feather;\n",t+="uniform float midpoint;\n",t+="uniform float highlightContrast;\n",t+="uniform float highlightMask;\n",t+="uniform vec2 aspect;\n";var i="";switch(i+="vec2 pos = vTextureCoord - 0.5;\n",i+="float dlFactor = 1.0-max(sign(vignetteAmount),0.0);\n",i+="vec3 resultColor = mix(vec3(1.0,1.0,1.0),vec3(0.0,0.0,0.0),dlFactor);\n",i+="float blackShift = dlFactor*0.28;\n",i+="float maskShift = mix(2.4,0.334,dlFactor);\n",i+="float absAmount = abs(vignetteAmount);\n",i+="vec2 circlePos = pos*aspect;\n",i+="float circleLen = length(circlePos)*0.95;\n",i+="float elipseLen = length(pos)*1.15;\n",i+="float rectRadius = 1.0-(2.0*max(-roundness-0.5,0.0)*0.86);\n",i+="vec2 minValue = max(2.0*abs(circlePos)-aspect+rectRadius,0.0);\n",i+="float rectLen = length(minValue)*0.576;\n",i+="rectLen /= rectRadius;\n",i+="float rectFactor = min(1.0,max(-roundness,0.0)*2.0);\n",i+="elipseLen = mix(elipseLen,rectLen,rectFactor);\n",i+="elipseLen = mix(elipseLen,circleLen,max(roundness,0.0));\n",i+="elipseLen = pow(1.0-elipseLen,0.8125);\n",i+="float addVal = midpoint*0.3 + elipseLen*max(midpoint,0.0)*0.5 - feather*0.3;\n",i+="float start = mix(0.495,-0.25+blackShift,feather) - addVal;\n",i+="float end = mix(0.505,0.4+blackShift,feather) - addVal;\n",i+="float maskFactor = 1.0 - (1.0 - smoothstep(start,end,elipseLen))*pow(absAmount,maskShift);\n",i+="float maxScale = mix(maskFactor,1.0,highlightContrast);\n",i+="float v = max(max(rgbCol.r,rgbCol.g),rgbCol.b);\n",i+="v = max(v*1.21951219512195 - 0.21951219512195,0.0);\n",i+="maskFactor = mix(maskFactor,maxScale,v);\n",i+="rgbCol = mix(rgbCol,resultColor,1.0-maskFactor);\n",e.params[28]){case 0:n+=i;break;case 1:a+=i;break;case 2:r+=i}e.activeGroupMask|=32}var o=function(e,t,n,a,r,i,o){var s=e.gl.createShader(e.gl.FRAGMENT_SHADER);if(null==s)return null;var l=hn.get(t);return null==l?null:(l=(l=(l=(l=(l=l.replace("//***uniforms",n)).replace("//***functions",a)).replace("//***stagesPreExposure",r)).replace("//***stagesPreTone",i)).replace("//***stagesPostTone",o),e.shaderCode=l,e.gl.shaderSource(s,l),e.gl.compileShader(s),e.gl.getShaderParameter(s,e.gl.COMPILE_STATUS)?s:null)}(e,"shaderTemplate",t,"",n,a,r);if(null!=o){var s=fn(e.gl,"shader-vs","");if(null!=s){var l=e.gl.createProgram();if(null!=l){if(e.gl.attachShader(l,s),e.gl.attachShader(l,o),e.gl.linkProgram(l),!e.gl.getProgramParameter(l,e.gl.LINK_STATUS))throw new Error("Could not initialise shaders");e.gl.useProgram(l),e.shaderProgram=l,e.shaderProgram.vertexPositionAttribute=e.gl.getAttribLocation(e.shaderProgram,"aVertexPosition"),e.gl.enableVertexAttribArray(e.shaderProgram.vertexPositionAttribute),e.shaderProgram.textureCoordAttribute=e.gl.getAttribLocation(e.shaderProgram,"aTextureCoord"),e.gl.enableVertexAttribArray(e.shaderProgram.textureCoordAttribute),e.shaderProgram.pMatrixUniform=e.gl.getUniformLocation(e.shaderProgram,"uPMatrix"),e.shaderProgram.mvMatrixUniform=e.gl.getUniformLocation(e.shaderProgram,"uMVMatrix"),e.shaderProgram.samplerUniform=e.gl.getUniformLocation(e.shaderProgram,"uSampler"),e.shaderProgram.lcSamplerUniform=e.gl.getUniformLocation(e.shaderProgram,"lcSampler"),e.shaderProgram.toneMapMaskUniform=e.gl.getUniformLocation(e.shaderProgram,"toneMapMask"),Gn(e,function(){for(var e=[-.04845666666666667,.04845666666666667,.097545,.14548333333333335,.20238666666666663,.27339166666666664,.36798000000000003,.5101999999999999,.699435,1.3165399999999998],t=new Float32Array(24),n=0;n<8;n++){var a=e[n],r=e[n+1],i=e[n+2];t[3*n]=.5*(a+r),t[3*n+1]=r-a,t[3*n+2]=.5*(a-2*r+i)}return t}(),"undoCurve")}}}}function Fn(e){var t=190734e-11;if(void 0!==e.toneMappingMask&&null!=e.toneMappingMask.srcStats&&null!=e.toneMappingMask.dstStats){var n=e.toneMappingMask.srcStats.min,a=e.toneMappingMask.dstStats.min,r=e.toneMappingMask.srcStats.max,i=e.toneMappingMask.dstStats.max,o=e.toneMappingMask.srcStats.mean,s=e.params[7]/100,l=e.params[6]/100,c=e.params[8]/100;c=Math.max(c,0);var u=n-1*(a-n),d=r-0*(i-r),h=(o-a)/(o-u),f=a-h*u,p=(o-i)/(o-d),m=i-p*d,v=r-i,g=v-.5*(n-a+v);g*=function(e){var t=e.absskew;return Math.max(.125,Math.min(.375*t-.0625,.5))}(e.toneMappingMask.srcStats);var b=.5/(o-n),y=0-b*n,E=.5/(r-o),w=.5-E*o;n+t>=o&&(b=0,y=.5),r-t<=o&&(E=0,w=.5);var x=e.toneMappingMask.srcStats.max-e.toneMappingMask.srcStats.mean,k=Math.max(0,Math.min(1,-1*x+5));Bn(e,s,"uGlobalAmtHighlights"),Bn(e,l,"uGlobalAmtShadows"),Bn(e,c,"uGlobalAmtClarity"),Bn(e,e.toneMappingMask.srcStats.mean,"uToneMapMid"),Bn(e,-1,"uCompressionScale"),Bn(e,2,"uCompressionOffset"),zn(e,h,p,b,E,"lineLumWeightScale"),zn(e,f,m,y,w,"lineLumWeightOffset"),Bn(e,k,"uHighlightPinAmount"),Bn(e,g,"uToneMapMaxAbsOffset")}}function Un(e){var t=!1;if(0!==(1&e.activeGroupMask)&&(Wn(e,e.abcMatr,"abcMatr"),Wn(e,e.abcIndexMatr,"indexMatr"),function(e,t,n){if(void 0===e.shaderProgram)return;var a=e.gl.getUniformLocation(e.shaderProgram,n);e.gl.uniform3f(a,t[0],t[1],t[2])}(e,e.abcScale,"abcScale")),0!==(2&e.activeGroupMask)){Bn(e,e.exposureGain,"exposureGain"),Bn(e,e.finalExposure,"exposure"),Bn(e,e.params[4]/100,"blacks"),Bn(e,e.params[5]/100,"whites");var n=new on;if(n.contrast=e.params[3]/100,n.contrastKey=.18,n.toneValues=e.toneValues,Gn(e,sn(n),"renderCurve"),t=!0,void 0===e.toneMappingMask)return;null!==e.toneMappingMask.srcStats&&null!==e.toneMappingMask.dstStats&&Fn(e)}if(0!==(8&e.activeGroupMask)&&!t){var a=new on;a.contrast=e.params[3]/100,a.contrastKey=.18,a.toneValues=e.toneValues,Gn(e,sn(a),"renderCurve")}if(0!==(4&e.activeGroupMask)){Bn(e,e.params[10]/100+1,"saturation"),Bn(e,e.params[9]/100,"vibrance");var r=.5*Math.min(e.params[8]/100,0),i=1+.5*r,o=.5+.5*i;Bn(e,r=i*o*o-1,"negClarity")}if(0!==(16&e.activeGroupMask)){var s=un(e.params[21],e.params[22],e.params[20],e.params[18],e.params[19]);Hn(e,s[1],s[2],s[3],"splttShadow"),Bn(e,s[0],"splttAlpha"),Hn(e,s[4],s[5],s[6],"splttDelta")}0!==(32&e.activeGroupMask)&&(Bn(e,e.params[23]/100,"vignetteAmount"),Bn(e,e.params[24]/100,"roundness"),Bn(e,e.params[26]/100,"feather"),Bn(e,(e.params[25]-50)/100,"midpoint"),Bn(e,e.params[27]/100,"highlightContrast"),Bn(e,2===e.params[28]||0===e.params[27]?0:1,"highlightMask"),function(e,t,n,a){if(void 0===e.shaderProgram)return;var r=e.gl.getUniformLocation(e.shaderProgram,a);e.gl.uniform2f(r,t,n)}(e,e.aspectX,e.aspectY,"aspect"))}function Bn(e,t,n){if(void 0!==e.shaderProgram){var a=e.gl.getUniformLocation(e.shaderProgram,n);e.gl.uniform1f(a,t)}}function Hn(e,t,n,a,r){if(void 0!==e.shaderProgram){var i=e.gl.getUniformLocation(e.shaderProgram,r);e.gl.uniform3f(i,t,n,a)}}function zn(e,t,n,a,r,i){if(void 0!==e.shaderProgram){var o=e.gl.getUniformLocation(e.shaderProgram,i);e.gl.uniform4f(o,t,n,a,r)}}function Gn(e,t,n){if(void 0!==e.shaderProgram){var a=e.gl.getUniformLocation(e.shaderProgram,n);e.gl.uniform3fv(a,t)}}function Wn(e,t,n){if(void 0!==e.shaderProgram){for(var a=e.gl.getUniformLocation(e.shaderProgram,n),r=$e.c.create(),i=0;i<9;i++)r[i]=t[i];e.gl.uniformMatrix3fv(a,!1,r)}}function Zn(e,t){switch(e){default:Kt(t.abcMatr,t.abcIndexMatr,t.abcScale,t.params[0],t.params[1]),t.finalExposure=function(e,t,n){var a=1.26;if(e.exposureGain=1,(t+=.8*n)<0){var r=Math.min(t+1,0);r*=r,e.exposureGain*=1/(1+r),t=Math.max(-1,t)}var i=Math.abs(t),o=i/8;a+=.24*(o*=o);var s=Math.pow(i/8,1.26);return s=Math.pow(8*s,a)+1,t<0?1/s:Math.min(s,8.488339269336635)}(t,t.params[2],Math.log(t.abcScale[0])/Math.log(2)),t.abcScale[1]/=t.abcScale[0],t.abcScale[2]/=t.abcScale[0],t.abcScale[0]=1,nn(t.params,t.toneControls),an(t.toneControls,t.toneValues);break;case 4:case 5:break;case 3:nn(t.params,t.toneControls),an(t.toneControls,t.toneValues)}}function Yn(e){Nn(e),Vn(e),function(e){if(e.cubeVertexPositionBuffer=e.gl.createBuffer(),null!=e.cubeVertexPositionBuffer){e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.cubeVertexPositionBuffer);e.gl.bufferData(e.gl.ARRAY_BUFFER,new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),e.gl.STATIC_DRAW),e.cubeVertexPositionBuffer.itemSize=3,e.cubeVertexPositionBuffer.numItems=4,e.cubeVertexTextureCoordBuffer=e.gl.createBuffer(),e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.cubeVertexTextureCoordBuffer);e.gl.bufferData(e.gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),e.gl.STATIC_DRAW),e.cubeVertexTextureCoordBuffer.itemSize=2,e.cubeVertexTextureCoordBuffer.numItems=4,e.cubeVertexIndexBuffer=e.gl.createBuffer(),e.gl.bindBuffer(e.gl.ELEMENT_ARRAY_BUFFER,e.cubeVertexIndexBuffer);e.gl.bufferData(e.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),e.gl.STATIC_DRAW),e.cubeVertexIndexBuffer.itemSize=1,e.cubeVertexIndexBuffer.numItems=6}}(e),Zn(-1,e),e.gl.clearColor(.4,.4,.4,1),e.gl.enable(e.gl.DEPTH_TEST)}function Kn(e,t){return Xn.apply(this,arguments)}function Xn(){return(Xn=Object(l.a)(s.a.mark((function e(t,n){var a,r,i,o,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(a=Bt(n))){e.next=3;break}throw new Error("Cannot create blur data!");case 3:if(r=a,null!=(i=An(t.gl,n))){e.next=7;break}throw new Error("Cannot create texture!");case 7:return(o=new _n).initWithTexture(t,i),e.next=11,o.getTonemappingBitmap(t);case 11:if(null!=(l=e.sent)){e.next=14;break}throw new Error("Cannot create tonemaps!");case 14:return o.destroy(t.gl),Tn(t.gl,i),e.abrupt("return",{toneMap:l.imageBitmap,blurMap:r,srcStats:l.srcStats,dstStats:l.dstStats});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qn(e,t,n,a,r,i){null!==e.texture&&(e.gl.deleteTexture(e.texture),e.gl.deleteTexture(e.lcTexture)),e.texture=e.gl.createTexture(),e.lcTexture=e.gl.createTexture(),e.texture.image=t,e.lcTexture.image=n,function(e){null!=e.texture&&null!=e.lcTexture&&(e.gl.bindTexture(e.gl.TEXTURE_2D,e.texture),e.gl.texImage2D(e.gl.TEXTURE_2D,0,e.gl.RGBA,e.gl.RGBA,e.gl.UNSIGNED_BYTE,e.texture.image),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_MAG_FILTER,e.gl.LINEAR),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_MIN_FILTER,e.gl.LINEAR),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_WRAP_S,e.gl.CLAMP_TO_EDGE),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_WRAP_T,e.gl.CLAMP_TO_EDGE),e.gl.bindTexture(e.gl.TEXTURE_2D,e.lcTexture),e.gl.texImage2D(e.gl.TEXTURE_2D,0,e.gl.RGBA,e.gl.RGBA,e.gl.UNSIGNED_BYTE,e.lcTexture.image),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_MAG_FILTER,e.gl.LINEAR),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_MIN_FILTER,e.gl.LINEAR),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_WRAP_S,e.gl.CLAMP_TO_EDGE),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_WRAP_T,e.gl.CLAMP_TO_EDGE),e.gl.bindTexture(e.gl.TEXTURE_2D,null),e.aspect=e.texture.image.width/e.texture.image.height,e.aspectX=Math.max(e.aspect,1),e.aspectY=Math.max(1/e.aspect,1),e.texture.type=e.gl.UNSIGNED_BYTE,e.texture.format=e.gl.RGBA,e.texture.width=e.texture.image.width,e.texture.height=e.texture.image.height,e.lcTexture.type=e.gl.UNSIGNED_BYTE,e.lcTexture.format=e.gl.RGBA,e.lcTexture.width=e.lcTexture.image.width,e.lcTexture.height=e.lcTexture.image.height)}(e),void 0!==e.toneMappingMask&&e.toneMappingMask.destroy(e.gl),e.toneMappingMask=new _n,e.toneMappingMask.initWithBitmap(e,a,r,i)}function Jn(e){!function(e){Un(e);var t=e.gl.drawingBufferWidth,n=e.gl.drawingBufferHeight;if(e.gl.viewport(0,0,t,n),e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT),$e.d.ortho(e.pMatrix,-1,1,-1,1,.1,100),$e.d.identity(e.mvMatrix),$e.d.translate(e.mvMatrix,e.mvMatrix,[0,0,-1]),$e.d.scale(e.mvMatrix,e.mvMatrix,[1,t/n,1]),e.aspect>0?$e.d.scale(e.mvMatrix,e.mvMatrix,[1,1/e.aspect,1]):$e.d.scale(e.mvMatrix,e.mvMatrix,[1/e.aspect,1,1]),e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.cubeVertexPositionBuffer),e.gl.vertexAttribPointer(e.shaderProgram.vertexPositionAttribute,e.cubeVertexPositionBuffer.itemSize,e.gl.FLOAT,!1,0,0),e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.cubeVertexTextureCoordBuffer),e.gl.vertexAttribPointer(e.shaderProgram.textureCoordAttribute,e.cubeVertexTextureCoordBuffer.itemSize,e.gl.FLOAT,!1,0,0),e.gl.activeTexture(e.gl.TEXTURE0),e.gl.bindTexture(e.gl.TEXTURE_2D,e.texture),e.gl.uniform1i(e.shaderProgram.samplerUniform,0),e.gl.activeTexture(e.gl.TEXTURE1),e.gl.bindTexture(e.gl.TEXTURE_2D,e.lcTexture),e.gl.uniform1i(e.shaderProgram.lcSamplerUniform,1),void 0===e.toneMappingMask)throw new Error("Tone mapping mask not set!");e.toneMappingMask.toneMapMask&&(e.gl.activeTexture(e.gl.TEXTURE2),e.gl.bindTexture(e.gl.TEXTURE_2D,e.toneMappingMask.toneMapMask),e.gl.uniform1i(e.shaderProgram.toneMapMaskUniform,2)),e.gl.bindBuffer(e.gl.ELEMENT_ARRAY_BUFFER,e.cubeVertexIndexBuffer),function(e){e.gl.uniformMatrix4fv(e.shaderProgram.pMatrixUniform,!1,e.pMatrix),e.gl.uniformMatrix4fv(e.shaderProgram.mvMatrixUniform,!1,e.mvMatrix)}(e),e.gl.drawElements(e.gl.TRIANGLES,e.cubeVertexIndexBuffer.numItems,e.gl.UNSIGNED_SHORT,0)}(e)}var Qn,$n=function(){function e(){Object(c.a)(this,e),this.temperature=0,this.tint=0,this.exposure=0,this.contrast=0,this.highlights=0,this.shadows=0,this.whites=0,this.blacks=0,this.clarity=0,this.vibrance=0,this.saturation=0,this.vignette_amount=0,this.vignette_roundness=0,this.vignette_midpoint=50,this.vignette_feather=50,this.vignette_highlight=0,this.vignette_mode=0}return Object(u.a)(e,[{key:"reset",value:function(){this.temperature=0,this.tint=0,this.exposure=0,this.contrast=0,this.highlights=0,this.shadows=0,this.whites=0,this.blacks=0,this.clarity=0,this.vibrance=0,this.saturation=0,this.vignette_amount=0,this.vignette_roundness=0,this.vignette_midpoint=50,this.vignette_feather=50,this.vignette_highlight=0,this.vignette_mode=0}},{key:"setParam",value:function(e,t){this[e]=t}},{key:"getParam",value:function(e){return this[e]}}]),e}(),ea=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,[{key:"init",value:function(e){this.context=new Ln(e),Yn(this.context),Vn(this.context)}},{key:"destroy",value:function(){void 0!==this.context&&this.context.destroy()}},{key:"getMapsForImageBitmap",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.context){e.next=2;break}throw new Error("Context not set!");case 2:return e.abrupt("return",Kn(this.context,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setImage",value:function(e,t,n,a,r){if(void 0===this.context)throw new Error("Context not initialized!");qn(this.context,e,t,n,a,r)}},{key:"setParams",value:function(e){if(void 0===this.context)throw new Error("Context not initialized!");this.context.params[0]=e.temperature,this.context.params[1]=e.tint,this.context.params[2]=e.exposure,this.context.params[3]=e.contrast,this.context.params[7]=e.highlights,this.context.params[6]=e.shadows,this.context.params[5]=e.whites,this.context.params[4]=e.blacks,this.context.params[8]=e.clarity,this.context.params[9]=e.vibrance,this.context.params[10]=e.saturation,this.context.params[23]=e.vignette_amount,this.context.params[24]=e.vignette_roundness,this.context.params[25]=e.vignette_midpoint,this.context.params[26]=e.vignette_feather,this.context.params[27]=e.vignette_highlight,this.context.params[28]=e.vignette_mode,Zn(-1,this.context)}},{key:"drawFilter",value:function(){if(void 0===this.context)throw new Error("Context not initialized!");Jn(this.context)}}]),e}(),ta=n(44),na=n.n(ta),aa=n(49),ra=n(185),ia=n.n(ra),oa=n(186),sa=n.n(oa),la=n(71),ca=n.n(la),ua=(n(481),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={showVignetteDetails:!1},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"handleChange",value:function(e,t){this.props.controller.setAdjustParam(e,t,!1)}},{key:"handleChangeEnd",value:function(e,t){this.props.controller.setAdjustParam(e,t,!0),ie("adjust:details:".concat(ca()(e)))}},{key:"toggleVignetteDetails",value:function(){var e=this.state.showVignetteDetails;this.setState({showVignetteDetails:!e})}},{key:"render",value:function(){var e=this,t=this.state.showVignetteDetails,n=this.props.params;return g.a.createElement("div",{className:"details-panel"},g.a.createElement(aa.Accordion,{multiselectable:!0,defaultSelectedIndex:0,style:{width:"100%"}},g.a.createElement(aa.AccordionItem,{header:Ze("AdjustView.Controls.Slider.Header.Light","Light")},g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Exposure","Exposure"),min:-5,max:5,step:.1,filled:!0,fillOffset:.01,value:n.exposure,onChange:function(t){return e.handleChange("exposure",t)},onChangeEnd:function(t){return e.handleChangeEnd("exposure",t)},className:"darkLight"}),g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Contrast","Contrast"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.contrast,onChange:function(t){return e.handleChange("contrast",t)},onChangeEnd:function(t){return e.handleChangeEnd("contrast",t)},className:"lightDark"}),g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Highlights","Highlights"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.highlights,onChange:function(t){return e.handleChange("highlights",t)},onChangeEnd:function(t){return e.handleChangeEnd("highlights",t)},className:"darkLight"}),g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Shadows","Shadows"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.shadows,onChange:function(t){return e.handleChange("shadows",t)},onChangeEnd:function(t){return e.handleChangeEnd("shadows",t)},className:"darkLight"}),g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Whites","Whites"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.whites,onChange:function(t){return e.handleChange("whites",t)},onChangeEnd:function(t){return e.handleChangeEnd("whites",t)},className:"darkLight"}),g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Blacks","Blacks"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.blacks,onChange:function(t){return e.handleChange("blacks",t)},onChangeEnd:function(t){return e.handleChangeEnd("blacks",t)},className:"darkLight"})),g.a.createElement(aa.AccordionItem,{header:Ze("AdjustView.Controls.Slider.Header.Color","Color")},g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Temperature","Temperature"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.temperature,onChange:function(t){return e.handleChange("temperature",t)},onChangeEnd:function(t){return e.handleChangeEnd("temperature",t)},className:"temperature"}),g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Tint","Tint"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.tint,onChange:function(t){return e.handleChange("tint",t)},onChangeEnd:function(t){return e.handleChangeEnd("tint",t)},className:"tint"}),g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Vibrance","Vibrance"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.vibrance,onChange:function(t){return e.handleChange("vibrance",t)},onChangeEnd:function(t){return e.handleChangeEnd("vibrance",t)},className:"vibrance"}),g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Saturation","Saturation"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.saturation,onChange:function(t){return e.handleChange("saturation",t)},onChangeEnd:function(t){return e.handleChangeEnd("saturation",t)},className:"vibrance"})),g.a.createElement(aa.AccordionItem,{header:Ze("AdjustView.Controls.Slider.Header.Effects","Effects")},g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Clarity","Clarity"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.clarity,onChange:function(t){return e.handleChange("clarity",t)},onChangeEnd:function(t){return e.handleChangeEnd("clarity",t)},className:"lightDark"}),g.a.createElement("div",{className:"vignette-slider-group"},g.a.createElement(xe.a,{variant:"tool",icon:t?g.a.createElement(ia.a,null):g.a.createElement(sa.a,null),onClick:function(){return e.toggleVignetteDetails()},className:"vignette-details-button"}),g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Vignette.Title","Vignette"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.vignette_amount,onChange:function(t){return e.handleChange("vignette_amount",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_amount",t)},className:"vignette-amount darkLightDark"}),t&&g.a.createElement("div",{className:"vignette-slider-sub-group"},g.a.createElement(Be.a,Object.assign({renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Vignette.Midpoint","Midpoint"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.vignette_midpoint,onChange:function(t){return e.handleChange("vignette_midpoint",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_midpoint",t)},className:"darkLight"},0===n.vignette_amount&&{disabled:!0})),g.a.createElement(Be.a,Object.assign({renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Vignette.Roundness","Roundness"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.vignette_roundness,onChange:function(t){return e.handleChange("vignette_roundness",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_roundness",t)},className:"darkLightDark"},0===n.vignette_amount&&{disabled:!0})),g.a.createElement(Be.a,Object.assign({renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Vignette.Feather","Feather"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.vignette_feather,onChange:function(t){return e.handleChange("vignette_feather",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_feather",t)},className:"darkLight"},0===n.vignette_amount&&{disabled:!0})),g.a.createElement(Be.a,Object.assign({renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Vignette.Highlights","Highlights"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:n.vignette_highlight,onChange:function(t){return e.handleChange("vignette_highlight",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_highlight",t)}},(!n.vignette_amount||n.vignette_amount>=0)&&{disabled:!0})))))))}}]),n}(v.PureComponent)),da=n(69),ha=n(187),fa=n.n(ha),pa=(n(524),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"renderGroups",value:function(){var e=this,t=this.props,n=t.controller,a=t.params;return n.getPresetGroups().map((function(t){return g.a.createElement(aa.AccordionItem,{key:t.id,header:t.title},t.id===a.groupId&&e.renderPresets(t))}))}},{key:"renderPresets",value:function(e){var t=this.props,n=t.controller,a=t.params,r=[];return e.presets.forEach((function(e){var t=Object(Ft.find)(n.getPresets(),{id:e});t&&r.push(t)})),r.map((function(t){return g.a.createElement(da.Card,{key:t.id,id:"".concat(e.id,"-").concat(t.id),allowsSelection:!1,className:a.presetId===t.id?"image-card selected":"image-card",actionMenu:g.a.createElement(xe.a,{icon:g.a.createElement(fa.a,null),variant:"tool","aria-label":Ze("AdjustView.Presets.ViewMore","View more"),onClick:function(){return n.showDetails()}})},g.a.createElement("div",{className:"spectrum-Card-coverPhoto",onClick:function(){n.setPreset(e,t,ya,!0),ie("adjust:".concat(ca()(e.title).toLowerCase(),":").concat(ca()(t.title)))},role:"presentation",style:{backgroundImage:"url('".concat(n.getPresetPreviewUrl(t),"')"),cursor:"pointer",width:"255px"}}),g.a.createElement(da.CardBody,{className:"presets-card-body",title:t.title},a.presetId===t.id&&t.hasIntensity&&g.a.createElement("div",{className:"base-slider"},g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Amount","Amount"),min:.1,max:2,step:.01,filled:!0,fillOffset:1,value:a.intensity,onChange:function(a){return n.setPreset(e,t,a,!1)},onChangeEnd:function(a){n.setPreset(e,t,a,!0),ie("adjust:details:intensity")},getAriaValueText:function(e){return"".concat(Math.round(100*e)," %")}}))))}))}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.params,a=t.getPresetGroups(),r=n.groupId?Object(Ft.findIndex)(a,{id:n.groupId}):void 0;return g.a.createElement("div",{className:"presets-panel"},g.a.createElement(aa.Accordion,{selectedIndex:r,onChange:function(e){return t.setGroup(null!==e?a[e]:void 0)}},this.renderGroups()))}}]),n}(v.PureComponent)),ma=(n(525),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n);return(a=t.call(this,e)).state={selectedTabIdx:0,params:e.controller.getParams()},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setParams",value:function(e){this.setState({params:e})}},{key:"selectTab",value:function(e){this.setState({selectedTabIdx:e})}},{key:"render",value:function(){var e=this,t=this.props.controller,n=this.state,a=n.selectedTabIdx,r=n.params;return g.a.createElement("div",{className:"editor-panel"},g.a.createElement("div",{className:"settings-right adjust-settings-right"},g.a.createElement("div",{className:"settings-scrolling-content"},g.a.createElement("div",{className:"settings-header",style:{marginBottom:"0"}},g.a.createElement("div",{className:"title"},Ze("AdjustView.Title.AdjustImage","Adjust image")),g.a.createElement("div",{className:"reset-button"},g.a.createElement(xe.a,{quiet:!0,variant:"action",onClick:function(){t.reset()},icon:g.a.createElement(na.a,null),disabled:!t.isDirty()},Ze("AdjustView.Button.Reset","Reset")))),g.a.createElement(_e.TabView,{style:{marginLeft:"8px"},onSelect:function(t){return e.selectTab(t)},selectedIndex:a},g.a.createElement(_e.Tab,{label:Ze("AdjustView.Tab.Presets","Presets"),className:"tab1class"},g.a.createElement(pa,{controller:t,params:r})),g.a.createElement(_e.Tab,{label:Ze("AdjustView.Tab.Details","Details")},g.a.createElement(ua,{controller:t,params:r})))),g.a.createElement("div",{className:"action-button-container"},g.a.createElement(xe.a,{onClick:function(){return t.cancel()},title:Ze("AdjustView.Button.Cancel","Cancel")},Ze("AdjustView.Button.Cancel","Cancel")),g.a.createElement(xe.a,{quiet:!0,variant:"cta",onClick:function(){return t.apply()},disabled:!t.isDirty(),title:Ze("AdjustView.Button.AdjustImage","Adjust image")},Ze("AdjustView.Button.AdjustImage","Adjust image")))))}}]),n}(v.PureComponent)),va=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"getAdjustmentsPresetGroups",value:function(){return[{id:1,deepLinkId:"popular",title:Ze("AdjustView.Presets.Popular.Grouptitle","Popular"),presets:[4,7,16,22,25]},{id:2,deepLinkId:"color",title:Ze("AdjustView.Presets.Color.Grouptitle","Color"),presets:[1,2,3,4,5,6]},{id:3,deepLinkId:"creative",title:Ze("AdjustView.Presets.Creative.Grouptitle","Creative"),presets:[7,8,9,10,11,12,13,14,15,16]},{id:4,deepLinkId:"vintage",title:Ze("AdjustView.Presets.Vintage.Grouptitle","Vintage / Old Photo Filters"),presets:[11,7,16,20,25,29]},{id:5,deepLinkId:"bw",title:Ze("AdjustView.Presets.BW.Grouptitle","B&W"),presets:[17,18,19,20,21,22,23,24,25,26]},{id:6,deepLinkId:"vignette",title:Ze("AdjustView.Presets.Vignetting.Grouptitle","Vignetting"),presets:[27,28,29,30]}]}}]),e}(),ga=function(){function e(){Object(c.a)(this,e),this.glia=void 0,this.canvas=void 0,this.glia=new ea,this.canvas=document.createElement("canvas")}return Object(u.a)(e,[{key:"init",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getGLContext()){e.next=3;break}return e.abrupt("return",Promise.reject(new Error("no GL context")));case 3:return e.prev=3,this.glia.init(n),a=M.createHTMLCanvasElement(t),e.next=8,this.glia.getMapsForImageBitmap(a);case 8:r=e.sent,this.glia.setImage(a,r.blurMap,r.toneMap,r.srcStats,r.dstStats),e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(3),e.abrupt("return",Promise.reject(e.t0));case 15:return e.abrupt("return",Promise.resolve());case 16:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.glia.destroy()}},{key:"renderPreset",value:function(e){var t=Object(Ft.assign)(new $n,e.params);this.glia.setParams(t),this.glia.drawFilter();var n=this.getGLContext();if(n){var a=n.drawingBufferWidth,r=n.drawingBufferHeight,i=new Uint8Array(a*r*4);return n.readPixels(0,0,a,r,n.RGBA,n.UNSIGNED_BYTE,i),M.flipPixels(i,a,r),new ImageData(Uint8ClampedArray.from(i),a,r)}}},{key:"getGLContext",value:function(){return this.canvas.getContext("webgl",{preserveDrawingBuffer:!0,premultipliedAlpha:!1})}}]),e}(),ba=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"getAdjustmentsPresets",value:function(){return[{id:1,title:Ze("AdjustView.Presets.Color.Natural","Natural"),additive:!1,hasIntensity:!0,params:{contrast:10,highlights:-10,shadows:15,whites:-10,blacks:-20,vibrance:10}},{id:2,title:Ze("AdjustView.Presets.Color.Bright","Bright"),additive:!1,hasIntensity:!0,params:{highlights:-30,shadows:50,whites:40,blacks:-10}},{id:3,title:Ze("AdjustView.Presets.Color.HighContrast","High Contrast"),additive:!1,hasIntensity:!0,params:{contrast:70}},{id:4,title:Ze("AdjustView.Presets.Color.HighContrastDetail","High Contrast & Detail"),additive:!1,hasIntensity:!0,params:{contrast:50,highlights:20,blacks:-40,clarity:30}},{id:5,title:Ze("AdjustView.Presets.Color.Vivid","Vivid"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:-10,shadows:25,whites:10,blacks:-10,vibrance:40,saturation:10,clarity:20}},{id:6,title:Ze("AdjustView.Presets.Color.Matte","Matte"),additive:!1,hasIntensity:!0,params:{contrast:-10,highlights:-20,shadows:10,whites:20,blacks:-25,saturation:-25}},{id:7,title:Ze("AdjustView.Presets.Creative.DesaturatedContrast","Desaturated Contrast"),additive:!1,hasIntensity:!0,params:{contrast:20,whites:20,blacks:-25,vibrance:-10,saturation:-50,clarity:40}},{id:8,title:Ze("AdjustView.Presets.Creative.CoolLight","Cool Light"),additive:!1,hasIntensity:!0,params:{contrast:15,whites:45,blacks:-5,temperature:-20,tint:5,vibrance:-15,saturation:-20,clarity:10}},{id:9,title:Ze("AdjustView.Presets.Creative.Turquoise&Red","Turquoise & Red"),additive:!1,hasIntensity:!0,params:{contrast:10,highlights:10,whites:45,blacks:-20,temperature:10,tint:45,vibrance:10,saturation:5,clarity:5}},{id:10,title:Ze("AdjustView.Presets.Creative.SoftMist","Soft Mist"),additive:!1,hasIntensity:!0,params:{contrast:-30,highlights:-40,shadows:55,whites:-30,blacks:30,saturation:-5,clarity:-30}},{id:11,title:Ze("AdjustView.Presets.Creative.VintageInstant","Vintage Instant"),additive:!1,hasIntensity:!0,params:{contrast:25,highlights:35,shadows:-10,whites:-40,blacks:-15,temperature:5,tint:-5,vibrance:10,saturation:10,clarity:5}},{id:12,title:Ze("AdjustView.Presets.Creative.WarmContrast","Warm Contrast"),additive:!1,hasIntensity:!0,params:{contrast:70,highlights:-20,shadows:15,whites:20,blacks:-30,tint:10,vibrance:25,saturation:-15,clarity:-20}},{id:13,title:Ze("AdjustView.Presets.Creative.Flat&Green","Flat & Green"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:-20,shadows:20,whites:-30,blacks:-20,temperature:5,tint:-25,vibrance:-10,saturation:-10,clarity:-20}},{id:14,title:Ze("AdjustView.Presets.Creative.RedLiftMatte","Red Lift Matte"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:40,whites:50,blacks:-15,temperature:5,tint:20,vibrance:-40,saturation:0,clarity:-15}},{id:15,title:Ze("AdjustView.Presets.Creative.WarmShadows","Warm Shadows"),additive:!1,hasIntensity:!0,params:{contrast:15,shadows:-50,whites:-60,blacks:20,temperature:15,tint:15,vibrance:30,saturation:-5,clarity:10}},{id:16,title:Ze("AdjustView.Presets.Creative.AgedPhoto","Aged Photo"),additive:!1,hasIntensity:!0,params:{contrast:15,highlights:-25,shadows:20,blacks:-25,temperature:30,tint:10,vibrance:-40,saturation:-20,clarity:-35}},{id:17,title:Ze("AdjustView.Presets.BW.Landscape","B&W Landscape"),additive:!1,hasIntensity:!0,params:{contrast:15,highlights:30,shadows:-25,whites:50,blacks:10,temperature:30,vibrance:10,saturation:-100,clarity:10}},{id:18,title:Ze("AdjustView.Presets.BW.HighContrast","B&W High Contrast"),additive:!1,hasIntensity:!0,params:{contrast:90,highlights:-25,shadows:-60,whites:-10,blacks:-20,temperature:-15,saturation:-100,clarity:-20}},{id:19,title:Ze("AdjustView.Presets.BW.Punch","B&W Punch"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:15,shadows:-25,whites:65,blacks:15,temperature:-15,tint:30,vibrance:5,saturation:-100,clarity:50}},{id:20,title:Ze("AdjustView.Presets.BW.LowContrast","B&W Low Contrast"),additive:!1,hasIntensity:!0,params:{contrast:-40,highlights:15,shadows:-30,whites:40,tint:20,saturation:-100,clarity:-15}},{id:21,title:Ze("AdjustView.Presets.BW.Flat","B&W Flat"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:-20,shadows:-65,whites:40,blacks:-75,temperature:-45,tint:-90,saturation:-100,clarity:20}},{id:22,title:Ze("AdjustView.Presets.BW.Soft","B&W Soft"),additive:!1,hasIntensity:!0,params:{contrast:15,shadows:-15,whites:15,blacks:-60,temperature:-25,saturation:-100,clarity:-55}},{id:23,title:Ze("AdjustView.Presets.BW.Infrared","B&W Infrared"),additive:!1,hasIntensity:!0,params:{contrast:15,highlights:-100,shadows:55,whites:70,blacks:-40,temperature:20,tint:70,saturation:-100,clarity:-40}},{id:24,title:Ze("AdjustView.Presets.BW.SeleniumTone","B&W Selenium Tone"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:-25,shadows:-45,whites:-10,blacks:-45,temperature:-55,tint:10,vibrance:-25,saturation:-90,clarity:-5}},{id:25,title:Ze("AdjustView.Presets.BW.SepiaTone","B&W Sepia Tone"),additive:!1,hasIntensity:!0,params:{contrast:25,highlights:-50,shadows:-40,whites:-50,blacks:-60,temperature:60,tint:100,vibrance:-30,saturation:-90,clarity:-10}},{id:26,title:Ze("AdjustView.Presets.BW.SplitTone","B&W Split Tone"),additive:!1,hasIntensity:!0,params:{contrast:5,highlights:-35,shadows:-40,whites:-60,blacks:-70,temperature:40,tint:-90,vibrance:40,saturation:-90,clarity:-10}},{id:27,title:Ze("AdjustView.Presets.Vignetting.None","None"),additive:!0,hasIntensity:!1,params:{vignette_amount:0}},{id:28,title:Ze("AdjustView.Presets.Vignetting.VLight","Vignette Light"),additive:!0,hasIntensity:!1,params:{vignette_amount:-20}},{id:29,title:Ze("AdjustView.Presets.Vignetting.VMedium","Vignette Medium"),additive:!0,hasIntensity:!1,params:{vignette_amount:-35}},{id:30,title:Ze("AdjustView.Presets.Vignetting.VHeavy","Vignette Heavy"),additive:!0,hasIntensity:!1,params:{vignette_amount:-50}}]}}]),e}(),ya=1,Ea=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,T.adjust,e)).undostack=void 0,a.glia=void 0,a.gliaDefaults=new $n,a.params=void 0,a.presetGroups=void 0,a.presets=void 0,a.presetRenderer=void 0,a.hasShownCompareInfo=void 0,a.adjustmentsParamsMinMax={temperature:{min:-100,max:100},tint:{min:-100,max:100},exposure:{min:-5,max:5},contrast:{min:-100,max:100},highlights:{min:-100,max:100},shadows:{min:-100,max:100},whites:{min:-100,max:100},blacks:{min:-100,max:100},clarity:{min:-100,max:100},vibrance:{min:-100,max:100},saturation:{min:-100,max:100},vignette_amount:{min:-100,max:100},vignette_roundness:{min:-100,max:100},vignette_midpoint:{min:-100,max:100},vignette_feather:{min:-100,max:100},vignette_highlight:{min:-100,max:100}},a.presetGroups=va.getAdjustmentsPresetGroups(),a.presets=ba.getAdjustmentsPresets(),a.glia=new ea,a.params=Object(Ft.defaults)({},a.gliaDefaults),a.params.groupId=a.presetGroups[0].id,a.undostack=new ut(Object(Ft.clone)(a.params),100),a.presetRenderer=new ga,a.checkDeepLinks(),a.hasShownCompareInfo=null!==sessionStorage.getItem("fps_adjust_compare_info"),a}return Object(u.a)(n,[{key:"createView",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,t),!(a=M.resizeImageDataToWidth(this.doc.getImageData(),256))){e.next=5;break}return e.next=5,this.presetRenderer.init(a);case 5:y.a.render(g.a.createElement(ma,{controller:this}),t);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"startEditor",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"startEditor",this).call(this,e)}},{key:"endEditor",value:function(){this.presetRenderer.destroy(),Object(h.a)(Object(f.a)(n.prototype),"endEditor",this).call(this),this.clearMaskCanvas()}},{key:"initStage",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.doc.getStage().ensureWebGLCanvas({preserveDrawingBuffer:!0,premultipliedAlpha:!1}),e.next=3,this.initGlia();case 3:this.params.groupId&&this.params.presetId&&(t=Object(Ft.find)(this.presetGroups,{id:this.params.groupId}),n=Object(Ft.find)(this.presets,{id:this.params.presetId}),t&&n&&this.setPreset(t,n,ya,!0)),this.initMaskCanvas();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initMaskCanvas",value:function(){this.doc.getStage().setMaskData(this.doc.getImageData());var e=this.doc.getStage().getMaskCanvas();e&&(e.style.opacity="0")}},{key:"clearMaskCanvas",value:function(){this.doc.getStage().setMaskData()}},{key:"isDirty",value:function(){var e=this,t=!1;return Object(Ft.keys)(this.gliaDefaults).forEach((function(n){e.params[n]!==e.gliaDefaults.getParam(n)&&(t=!0)})),t}},{key:"hasUndoStack",value:function(){return!0}},{key:"undo",value:function(){this.undostack.undo(),this.params=Object(Ft.clone)(this.undostack.getCurrent()),this.update()}},{key:"redo",value:function(){this.undostack.redo(),this.params=Object(Ft.clone)(this.undostack.getCurrent()),this.update()}},{key:"canUndo",value:function(){return this.undostack.canUndo()}},{key:"canRedo",value:function(){return this.undostack.canRedo()}},{key:"reset",value:function(){if(this.isDirty()){var e=this.params.groupId;this.params=Object(Ft.defaults)({},this.gliaDefaults),this.params.groupId=e,this.addUndoStep(),this.update()}}},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty()){e.next=3;break}return this.cancel(),e.abrupt("return");case 3:if(!(t=this.getGLContext())){e.next=14;break}return n=t.drawingBufferWidth,a=t.drawingBufferHeight,r=new Uint8Array(n*a*4),t.readPixels(0,0,n,a,t.RGBA,t.UNSIGNED_BYTE,r),M.flipPixels(r,n,a),i=new ImageData(Uint8ClampedArray.from(r),n,a),e.next=13,this.doc.editorApply(i,"Adjusted image");case 13:(new Ee).showSurveyEditor("adjust");case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.isDirty()&&(new Ee).showSurveyEditor("adjust"),this.doc.editorCancel()}},{key:"onPointerMove",value:function(e){this.isDirty()&&!this.hasShownCompareInfo&&(Object(E.info)(Ze("AdjustView.ClickCompare.Message","Click and hold image to compare"),{timeout:3e3}),this.hasShownCompareInfo=!0,sessionStorage.setItem("fps_adjust_compare_info","true"))}},{key:"onPointerDown",value:function(e){var t=this.doc.getStage().getMaskCanvas();t&&(t.style.opacity="1")}},{key:"onPointerUp",value:function(e){var t=this.doc.getStage().getMaskCanvas();t&&(t.style.opacity="0")}},{key:"getParams",value:function(){return this.params}},{key:"setAdjustParam",value:function(e,t,n){this.setParam(e,t,ya),n&&this.addUndoStep(),this.update()}},{key:"setGroup",value:function(e){var t;this.params.groupId=null===e||void 0===e?void 0:e.id,null===(t=this.getAdjustmentsEditorView())||void 0===t||t.setParams(Object(Ft.clone)(this.params))}},{key:"setPreset",value:function(e,t,n,a){var r=this;this.params.groupId=e.id,this.params.presetId=t.id,this.params.intensity=n,t.additive||Object(Ft.assign)(this.params,this.gliaDefaults),Object(Ft.keys)(t.params).forEach((function(e){var a=t.params[e];if(void 0===a)throw Error("unknown param key");r.setParam(e,a,n)})),a&&this.addUndoStep(),this.update()}},{key:"getPresetGroups",value:function(){return this.presetGroups}},{key:"getPresets",value:function(){return this.presets}},{key:"selectTab",value:function(e){var t;null===(t=this.getAdjustmentsEditorView())||void 0===t||t.selectTab(e)}},{key:"showPresets",value:function(){this.selectTab(0)}},{key:"showDetails",value:function(){this.selectTab(1)}},{key:"getPresetPreviewUrl",value:function(e){if(e.previewUrl)return e.previewUrl;var t=this.presetRenderer.renderPreset(e);return t&&(e.previewUrl=M.createDataUrl(t)),e.previewUrl}},{key:"setParam",value:function(e,t,n){var a=this.adjustmentsParamsMinMax[e];if(!a)throw Error("unknown minMax key");this.params[e]=Math.max(a.min,Math.min(a.max,t*n))}},{key:"addUndoStep",value:function(){this.undostack.add(Object(Ft.clone)(this.params))}},{key:"update",value:function(){var e;this.applyParams(),null===(e=this.getAdjustmentsEditorView())||void 0===e||e.setParams(Object(Ft.clone)(this.params)),this.doc.getDocActions().update()}},{key:"initGlia",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.getGLContext())){e.next=9;break}return this.glia.init(t),n=M.createHTMLCanvasElement(this.doc.getImageData()),e.next=6,this.glia.getMapsForImageBitmap(n);case 6:(a=e.sent)&&this.glia.setImage(n,a.blurMap,a.toneMap,a.srcStats,a.dstStats),this.applyParams();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyParams",value:function(){this.glia.setParams(this.params),this.glia.drawFilter()}},{key:"getGLContext",value:function(){var e=this.doc.getStage().getCanvas();return e?e.getContext("webgl",{preserveDrawingBuffer:!0,premultipliedAlpha:!1}):null}},{key:"checkDeepLinks",value:function(){var e,t,n=K.getParams();if(null===(e=n.adjustments)||void 0===e?void 0:e.group){var a,r=Object(Ft.find)(this.presetGroups,{deepLinkId:null===(a=n.adjustments)||void 0===a?void 0:a.group});r&&(this.params.groupId=r.id,n.adjustments.group=void 0,K.setParams(n))}if(null===(t=n.adjustments)||void 0===t?void 0:t.presetid){var i,o=Object(Ft.find)(this.presets,{id:null===(i=n.adjustments)||void 0===i?void 0:i.presetid}),s=Object(Ft.find)(this.presetGroups,(function(e){return void 0!==(null===o||void 0===o?void 0:o.id)&&e.presets.includes(null===o||void 0===o?void 0:o.id)}));s&&o&&(this.params.presetId=o.id,this.params.groupId=s.id,n.adjustments.presetid=void 0,K.setParams(n))}}},{key:"getAdjustmentsEditorView",value:function(){return this.view}}]),n}(U),wa=["number","text"];!function(e){e.PAN="pan",e.ZOOM="zoom",e.UNDOREDO="undoredo",e.APPLYCANCEL="applycancel"}(Qn||(Qn={}));var xa=function(){function e(t){Object(c.a)(this,e),this.doc=void 0,this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.doc=t}return Object(u.a)(e,[{key:"addEventListener",value:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)}},{key:"removeEventListener",value:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}},{key:"onKeyDown",value:function(e){if(!this.ignoreKeyEvent(e)&&this.doc){var t=this.doc.getEditorIds(),n=this.doc.getCurrentEditor(),a=this.doc.getHotKeysEnabled();switch(e.key.toLowerCase()){case"c":!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("crop"))&&this.doc.setEditor(T.crop);break;case"j":!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("spotheal"))&&this.doc.setEditor(T.spotheal);break;case"r":!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("resize"))&&this.doc.setEditor(T.resize);break;case"e":!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("adjust"))&&this.doc.setEditor(T.adjust);break;case"b":!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("cutout"))&&this.doc.setEditor(T.cutout);break;case"z":e.metaKey||e.ctrlKey?e.shiftKey&&this.doc.canRedo()&&a.includes(Qn.UNDOREDO)?(this.doc.redo(),pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"redo"},{},{"ui.view_type":"shortcut"})):!e.shiftKey&&this.doc.canUndo()&&a.includes(Qn.UNDOREDO)&&(this.doc.undo(),pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"undo"},{},{"ui.view_type":"shortcut"})):this.isSingleKey(e)&&this.doc.getStage().getZoomMode()===qe.NONE&&a.includes(Qn.ZOOM)?(this.doc.getStage().setZoomMode(qe.ZOOMIN),e.preventDefault()):this.isSingleKey(e)&&this.doc.getStage().getZoomMode()!==qe.NONE&&a.includes(Qn.ZOOM)&&(this.doc.getStage().setZoomMode(qe.NONE),e.preventDefault());break;case"o":(e.metaKey||e.ctrlKey)&&(pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"open-image"},{},{"ui.view_type":"shortcut"}),this.doc.showOpenImage(),e.preventDefault());break;case"s":(e.metaKey||e.ctrlKey)&&(pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"download"},{},{"ui.view_type":"shortcut"}),this.doc.showSaveImage(),e.preventDefault());break;case"enter":(e.metaKey||e.ctrlKey)&&a.includes(Qn.APPLYCANCEL)&&(null===n||void 0===n||n.apply());break;case"escape":a.includes(Qn.APPLYCANCEL)&&(null===n||void 0===n||n.cancel(),document.activeElement instanceof HTMLElement&&document.activeElement.blur());break;case" ":this.isIgnoredInputEvent(e)||this.doc.getStage().isPanningMode()||!a.includes(Qn.PAN)||(this.doc.getStage().togglePanning(),e.preventDefault());break;case"+":(e.metaKey||e.ctrlKey)&&a.includes(Qn.ZOOM)&&(this.doc.getStage().zoomIn(),e.preventDefault());break;case"-":(e.metaKey||e.ctrlKey)&&a.includes(Qn.ZOOM)&&(this.doc.getStage().zoomOut(),e.preventDefault());break;case"0":(e.metaKey||e.ctrlKey)&&a.includes(Qn.ZOOM)&&(this.doc.getStage().zoomToggleFit(),e.preventDefault());break;case"alt":!this.isIgnoredInputEvent(e)&&this.doc.getStage().getZoomMode()===qe.ZOOMIN&&a.includes(Qn.ZOOM)&&(this.doc.getStage().setZoomMode(qe.ZOOMOUT),e.preventDefault())}}}},{key:"onKeyUp",value:function(e){if(!this.ignoreKeyEvent(e)&&this.doc){var t=this.doc.getHotKeysEnabled();switch(e.key.toLowerCase()){case" ":!this.isIgnoredInputEvent(e)&&this.doc.getStage().isPanningMode()&&t.includes(Qn.PAN)&&(this.doc.getStage().togglePanning(),e.preventDefault());break;case"alt":!this.isIgnoredInputEvent(e)&&this.doc.getStage().getZoomMode()===qe.ZOOMOUT&&t.includes(Qn.ZOOM)&&(this.doc.getStage().setZoomMode(qe.ZOOMIN),e.preventDefault())}}}},{key:"isIgnoredInputEvent",value:function(e){if(e.target instanceof HTMLInputElement){var t=e.target;return wa.some((function(e){return t.type.includes(e)}))}return!1}},{key:"ignoreKeyEvent",value:function(e){if(e.target instanceof HTMLDivElement&&"dialog"===e.target.getAttribute("role"))return!0;var t=document.getElementsByClassName("spectrum-Underlay is-open");if(t&&t.length>0)return!0;var n=document.getElementsByClassName("spectrum-Popover spectrum-Dialog--default is-open");return!!(n&&n.length>0)}},{key:"isSingleKey",value:function(e){return!e.ctrlKey&&!e.metaKey&&!e.shiftKey}}]),e}(),ka=n(188),Sa=n.n(ka);function Ca(){return(Ca=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Oa(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Pa=g.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},g.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},g.a.createElement("circle",{cx:19.9,cy:19.9,r:19.9}))),Ta=function(e){var t=e.svgRef,n=e.title,a=Oa(e,["svgRef","title"]);return g.a.createElement("svg",Ca({viewBox:"0 0 39.8 39.8",ref:t},a),n?g.a.createElement("title",null,n):null,Pa)},Ma=g.a.forwardRef((function(e,t){return g.a.createElement(Ta,Ca({svgRef:t},e))}));n.p;function Ia(){return(Ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Aa(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ra=g.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},g.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},g.a.createElement("g",{id:"redheart"},g.a.createElement("g",{id:"heart"},g.a.createElement("path",{d:"M120.71,220.71c-35-75-65-60-100-100a70.71,70.71,0,0,1,100-100,70.71,70.71,0,0,1,100,100c-35,40-65,25-100,100"}))))),Da=function(e){var t=e.svgRef,n=e.title,a=Aa(e,["svgRef","title"]);return g.a.createElement("svg",Ia({viewBox:"0 0 241.42 220.71",ref:t},a),n?g.a.createElement("title",null,n):null,Ra)},ja=g.a.forwardRef((function(e,t){return g.a.createElement(Da,Ia({svgRef:t},e))}));n.p;function _a(){return(_a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function La(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Na=g.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},g.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},g.a.createElement("path",{d:"M277.44,80.64,197.68.88A3,3,0,0,0,195.55,0H82.76a3,3,0,0,0-2.13.88L.88,80.64A3,3,0,0,0,0,82.76v112.8a3,3,0,0,0,.88,2.12l79.75,79.77a3,3,0,0,0,2.13.87h112.8a3,3,0,0,0,2.12-.87l79.77-79.77a3,3,0,0,0,.87-2.12V82.76A3,3,0,0,0,277.44,80.64Z"}))),Va=function(e){var t=e.svgRef,n=e.title,a=La(e,["svgRef","title"]);return g.a.createElement("svg",_a({viewBox:"0 0 278.32 278.32",ref:t},a),n?g.a.createElement("title",null,n):null,Na)},Fa=g.a.forwardRef((function(e,t){return g.a.createElement(Va,_a({svgRef:t},e))}));n.p;function Ua(){return(Ua=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ba(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ha=g.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},g.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},g.a.createElement("rect",{width:40,height:40}))),za=function(e){var t=e.svgRef,n=e.title,a=Ba(e,["svgRef","title"]);return g.a.createElement("svg",Ua({viewBox:"0 0 40 40",ref:t},a),n?g.a.createElement("title",null,n):null,Ha)},Ga=g.a.forwardRef((function(e,t){return g.a.createElement(za,Ua({svgRef:t},e))}));n.p;function Wa(){return(Wa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Za(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ya=g.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},g.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},g.a.createElement("rect",{width:40,height:40,rx:6}))),Ka=function(e){var t=e.svgRef,n=e.title,a=Za(e,["svgRef","title"]);return g.a.createElement("svg",Wa({viewBox:"0 0 40 40",ref:t},a),n?g.a.createElement("title",null,n):null,Ya)},Xa=g.a.forwardRef((function(e,t){return g.a.createElement(Ka,Wa({svgRef:t},e))}));n.p;function qa(){return(qa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ja(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Qa=g.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},g.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},g.a.createElement("path",{d:"M149.76,4.15l34.38,91,97.16,4.6a6.44,6.44,0,0,1,3.75,11.46l-75.9,60.84,25.63,93.84A6.44,6.44,0,0,1,225,273l-81.29-53.39L62.42,273a6.44,6.44,0,0,1-9.75-7.08l25.62-93.84L2.41,111.21A6.44,6.44,0,0,1,6.16,99.75l97.14-4.6,34.42-91a6.44,6.44,0,0,1,12,0Z"}))),$a=function(e){var t=e.svgRef,n=e.title,a=Ja(e,["svgRef","title"]);return g.a.createElement("svg",qa({viewBox:"0 0 287.46 274.03",ref:t},a),n?g.a.createElement("title",null,n):null,Qa)},er=g.a.forwardRef((function(e,t){return g.a.createElement($a,qa({svgRef:t},e))})),tr=(n.p,n(52)),nr=n.n(tr),ar=function(e){var t=e.icon,n=e.size;return g.a.createElement(nr.a,{size:n},t)};function rr(){return(rr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ir(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var or=g.a.createElement("rect",{className:"fill",x:16,y:2,width:2,height:2,rx:.5}),sr=g.a.createElement("rect",{className:"fill",x:16,y:6,width:2,height:2,rx:.5}),lr=g.a.createElement("rect",{className:"fill",x:16,y:10,width:2,height:2,rx:.5}),cr=g.a.createElement("rect",{className:"fill",x:16,y:14,width:2,height:2,rx:.5}),ur=g.a.createElement("rect",{className:"fill",x:16,y:18,width:2,height:2,rx:.5}),dr=g.a.createElement("rect",{className:"fill",x:16,y:22,width:2,height:2,rx:.5}),hr=g.a.createElement("rect",{className:"fill",x:16,y:26,width:2,height:2,rx:.5}),fr=g.a.createElement("rect",{className:"fill",x:16,y:30,width:2,height:2,rx:.5}),pr=g.a.createElement("path",{className:"fill",d:"M30.276,28.7,20.2,17.8a1.01,1.01,0,0,1,0-1.428L30.276,5.3A1.01,1.01,0,0,1,32,6.012V27.988A1.01,1.01,0,0,1,30.276,28.7Z"}),mr=g.a.createElement("path",{className:"fill",d:"M3.845,8.079l8.168,8.843L3.845,25.9ZM3.044,5A1.009,1.009,0,0,0,2.027,6.012V27.988A1.009,1.009,0,0,0,3.045,29a.987.987,0,0,0,.706-.3L13.823,17.633a1.01,1.01,0,0,0,0-1.428L3.751,5.3A.989.989,0,0,0,3.044,5Z"}),vr=function(e){var t=e.svgRef,n=e.title,a=ir(e,["svgRef","title"]);return g.a.createElement("svg",rr({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,or,sr,lr,cr,ur,dr,hr,fr,pr,mr)},gr=g.a.forwardRef((function(e,t){return g.a.createElement(vr,rr({svgRef:t},e))}));n.p;function br(){return(br=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function yr(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Er=g.a.createElement("rect",{className:"fill",x:2,y:16,width:2,height:2,rx:.5}),wr=g.a.createElement("rect",{className:"fill",x:6,y:16,width:2,height:2,rx:.5}),xr=g.a.createElement("rect",{className:"fill",x:10,y:16,width:2,height:2,rx:.5}),kr=g.a.createElement("rect",{className:"fill",x:14,y:16,width:2,height:2,rx:.5}),Sr=g.a.createElement("rect",{className:"fill",x:18,y:16,width:2,height:2,rx:.5}),Cr=g.a.createElement("rect",{className:"fill",x:22,y:16,width:2,height:2,rx:.5}),Or=g.a.createElement("rect",{className:"fill",x:26,y:16,width:2,height:2,rx:.5}),Pr=g.a.createElement("rect",{className:"fill",x:30,y:16,width:2,height:2,rx:.5}),Tr=g.a.createElement("path",{className:"fill",d:"M5.3,30.249,16.2,20.177a1.01,1.01,0,0,1,1.428,0L28.7,30.249a1.01,1.01,0,0,1-.714,1.724H6.012A1.01,1.01,0,0,1,5.3,30.249Z"}),Mr=g.a.createElement("path",{className:"fill",d:"M25.921,3.818l-8.843,8.168L8.1,3.818ZM29,3.017A1.009,1.009,0,0,0,27.988,2H6.012A1.009,1.009,0,0,0,5,3.018a.987.987,0,0,0,.3.706L16.367,13.8a1.01,1.01,0,0,0,1.428,0L28.7,3.724A.989.989,0,0,0,29,3.017Z"}),Ir=function(e){var t=e.svgRef,n=e.title,a=yr(e,["svgRef","title"]);return g.a.createElement("svg",br({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,Er,wr,xr,kr,Sr,Cr,Or,Pr,Tr,Mr)},Ar=g.a.forwardRef((function(e,t){return g.a.createElement(Ir,br({svgRef:t},e))}));n.p;function Rr(){return(Rr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Dr(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var jr=g.a.createElement("path",{className:"fill",d:"M18,2A16.03,16.03,0,0,0,4.644,9.228L1,7.521a.69.69,0,0,0-.531-.027.7.7,0,0,0-.424.9L3.053,16.7a.5.5,0,0,0,.589.276l8.311-3.008a.7.7,0,0,0,.42-.9.686.686,0,0,0-.361-.39L8.335,10.958a11.971,11.971,0,1,1-.161,13.917,2,2,0,0,0-3.274,2.3A16,16,0,1,0,18,2Z"}),_r=function(e){var t=e.svgRef,n=e.title,a=Dr(e,["svgRef","title"]);return g.a.createElement("svg",Rr({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,jr)},Lr=g.a.forwardRef((function(e,t){return g.a.createElement(_r,Rr({svgRef:t},e))}));n.p;function Nr(){return(Nr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Vr(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Fr=g.a.createElement("path",{className:"fill",d:"M18,2A16.03,16.03,0,0,1,31.356,9.228L35,7.521a.69.69,0,0,1,.531-.027.7.7,0,0,1,.424.9L32.947,16.7a.5.5,0,0,1-.589.276l-8.311-3.008a.7.7,0,0,1-.42-.9.686.686,0,0,1,.361-.39l3.677-1.723a11.971,11.971,0,1,0,.161,13.917,2,2,0,0,1,3.274,2.3A16,16,0,1,1,18,2Z"}),Ur=function(e){var t=e.svgRef,n=e.title,a=Vr(e,["svgRef","title"]);return g.a.createElement("svg",Nr({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,Fr)},Br=g.a.forwardRef((function(e,t){return g.a.createElement(Ur,Nr({svgRef:t},e))}));n.p;function Hr(){return(Hr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function zr(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Gr,Wr=g.a.createElement("path",{className:"fill",d:"M33,10H11a1,1,0,0,0-1,1V33a1,1,0,0,0,1,1H33a1,1,0,0,0,1-1V11A1,1,0,0,0,33,10Z"}),Zr=g.a.createElement("path",{className:"fill",d:"M7.5,15h-2V12a6,6,0,0,1,6-6h2a1,1,0,0,0,1-1V4a1,1,0,0,0-1-1h-2a9,9,0,0,0-9,9v3H.5a.5.5,0,0,0-.5.5.49.49,0,0,0,.147.35l3.537,4.033a.5.5,0,0,0,.632,0l3.537-4.033A.49.49,0,0,0,8,15.5.5.5,0,0,0,7.5,15Z"}),Yr=function(e){var t=e.svgRef,n=e.title,a=zr(e,["svgRef","title"]);return g.a.createElement("svg",Hr({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,Wr,Zr)},Kr=g.a.forwardRef((function(e,t){return g.a.createElement(Yr,Hr({svgRef:t},e))}));n.p,n(528);!function(e){e[e.RECT=1]="RECT",e[e.ELLIPSE=2]="ELLIPSE",e[e.ROUNDED_RECT=3]="ROUNDED_RECT",e[e.HEART=4]="HEART",e[e.OCTAGON=5]="OCTAGON",e[e.STAR=6]="STAR"}(Gr||(Gr={}));var Xr=function e(){Object(c.a)(this,e)};function qr(){return(qr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Jr(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}Xr.HEART='<svg xmlns="http://www.w3.org/2000/svg"\n                          viewBox="0 0 241.42 220.71">\n                          <g id="Layer_2"\n                            data-name="Layer 2">\n                            <g id="Layer_1-2"\n                              data-name="Layer 1">\n                              <g id="redheart">\n                                <g id="heart">\n                                  <path d="M120.71,220.71c-35-75-65-60-100-100a70.71,70.71,0,0,1,100-100,70.71,70.71,0,0,1,100,100c-35,40-65,25-100,100"/>\n                                </g>\n                              </g>\n                            </g>\n                          </g>\n                        </svg>',Xr.OCTAGON='<svg xmlns="http://www.w3.org/2000/svg"\n                            viewBox="0 0 278.32 278.32">\n                            <g id="Layer_2"\n                              data-name="Layer 2">\n                              <g id="Layer_1-2"\n                                data-name="Layer 1">\n                                <path d="M277.44,80.64,197.68.88A3,3,0,0,0,195.55,0H82.76a3,3,0,0,0-2.13.88L.88,80.64A3,3,0,0,0,0,82.76v112.8a3,3,0,0,0,.88,2.12l79.75,79.77a3,3,0,0,0,2.13.87h112.8a3,3,0,0,0,2.12-.87l79.77-79.77a3,3,0,0,0,.87-2.12V82.76A3,3,0,0,0,277.44,80.64Z"/>\n                              </g>\n                            </g>\n                          </svg>',Xr.STAR='<svg xmlns="http://www.w3.org/2000/svg"\n                          viewBox="0 0 287.46 274.03">\n                          <g id="Layer_2"\n                            data-name="Layer 2">\n                            <g id="Layer_1-2"\n                              data-name="Layer 1">\n                              <path d="M149.76,4.15l34.38,91,97.16,4.6a6.44,6.44,0,0,1,3.75,11.46l-75.9,60.84,25.63,93.84A6.44,6.44,0,0,1,225,273l-81.29-53.39L62.42,273a6.44,6.44,0,0,1-9.75-7.08l25.62-93.84L2.41,111.21A6.44,6.44,0,0,1,6.16,99.75l97.14-4.6,34.42-91a6.44,6.44,0,0,1,12,0Z"/>\n                            </g>\n                          </g>\n                        </svg>',Xr.ROUNDED_RECT='<svg xmlns="http://www.w3.org/2000/svg"\n                                viewBox="0 0 40 40">\n                                <g id="Layer_2"\n                                  data-name="Layer 2">\n                                  <g id="Layer_1-2"\n                                    data-name="Layer 1">\n                                    <rect width="40"\n                                      height="40"\n                                      rx="6"/>\n                                  </g>\n                                </g>\n                              </svg>',Xr.HEART_BASE64=btoa(Xr.HEART),Xr.OCTAGON_BASE64=btoa(Xr.OCTAGON),Xr.STAR_BASE64=btoa(Xr.STAR),Xr.ROUNDED_RECT_BASE64=btoa(Xr.ROUNDED_RECT);var Qr=g.a.createElement("defs",null,g.a.createElement("clipPath",{id:"a"},g.a.createElement("path",{d:"M.06-981.96h36v-36H.06Z",transform:"translate(-0.06 1017.96)",fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"b"},g.a.createElement("rect",{width:36.002,height:36.009,fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"c"},g.a.createElement("path",{d:"M36-999.889A18.056,18.056,0,0,0,18-1018,18.056,18.056,0,0,0,0-999.889,18.082,18.082,0,0,0,15.188-982v-12.655H10.618v-5.235h4.571v-3.99c0-4.539,2.687-7.046,6.8-7.046a27.521,27.521,0,0,1,4.029.354v4.457h-2.27a2.61,2.61,0,0,0-2.934,2.828v3.4h4.992l-.8,5.235H20.814V-982A18.082,18.082,0,0,0,36-999.889",transform:"translate(0 1018)",fill:"#6e6e6e",clipRule:"evenodd"})),g.a.createElement("clipPath",{id:"d"},g.a.createElement("path",{d:"M0-981.991H36V-1018H0Z",transform:"translate(0 1018)",fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"f"},g.a.createElement("rect",{width:36,height:36}))),$r=g.a.createElement("g",{clipPath:"url(#b)"},g.a.createElement("g",{clipPath:"url(#c)"},g.a.createElement("g",{clipPath:"url(#d)"},g.a.createElement("path",{d:"M-5-1023H31.354v36.355H-5Z",transform:"translate(4.824 1022.823)",fill:"#6e6e6e"})))),ei=function(e){var t=e.svgRef,n=e.title,a=Jr(e,["svgRef","title"]);return g.a.createElement("svg",qr({width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,Qr,g.a.createElement("g",{id:"e",clipPath:"url(#f)"},g.a.createElement("g",{transform:"translate(-0.06 1017.96)"},g.a.createElement("g",{transform:"translate(0.06 -1017.96)",clipPath:"url(#a)"},g.a.createElement("g",{transform:"translate(-0.002 -0.001)",style:{isolation:"isolate"}},$r)))))},ti=g.a.forwardRef((function(e,t){return g.a.createElement(ei,qr({svgRef:t},e))}));n.p;function ni(){return(ni=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ai(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ri=g.a.createElement("defs",null,g.a.createElement("clipPath",{id:"a"},g.a.createElement("path",{d:"M0-467.845H36v-36H0Z",transform:"translate(0 503.841)",fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"b"},g.a.createElement("rect",{width:36.011,height:36.011,fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"c"},g.a.createElement("path",{d:"M18-503.841c-4.889,0-5.5.021-7.421.108a13.212,13.212,0,0,0-4.369.837,8.823,8.823,0,0,0-3.188,2.076,8.822,8.822,0,0,0-2.076,3.188,13.209,13.209,0,0,0-.837,4.369C.021-491.342,0-490.729,0-485.841s.021,5.5.108,7.421a13.21,13.21,0,0,0,.837,4.369,8.823,8.823,0,0,0,2.076,3.188,8.826,8.826,0,0,0,3.188,2.076,13.213,13.213,0,0,0,4.369.837c1.92.088,2.533.108,7.421.108s5.5-.021,7.421-.108a13.213,13.213,0,0,0,4.369-.837,8.826,8.826,0,0,0,3.188-2.076,8.825,8.825,0,0,0,2.076-3.188,13.212,13.212,0,0,0,.837-4.369c.088-1.92.108-2.533.108-7.421s-.021-5.5-.108-7.421a13.212,13.212,0,0,0-.837-4.369,8.823,8.823,0,0,0-2.076-3.188,8.823,8.823,0,0,0-3.188-2.076,13.212,13.212,0,0,0-4.369-.837C23.5-503.82,22.889-503.841,18-503.841Zm0,3.243c4.806,0,5.375.018,7.274.1a9.959,9.959,0,0,1,3.342.62,5.576,5.576,0,0,1,2.07,1.347,5.576,5.576,0,0,1,1.346,2.07,9.959,9.959,0,0,1,.62,3.342c.087,1.9.1,2.467.1,7.274s-.018,5.375-.1,7.273a9.959,9.959,0,0,1-.62,3.342,5.576,5.576,0,0,1-1.346,2.07,5.577,5.577,0,0,1-2.07,1.346,9.959,9.959,0,0,1-3.342.62c-1.9.087-2.467.1-7.274.1s-5.376-.018-7.274-.1a9.959,9.959,0,0,1-3.342-.62,5.577,5.577,0,0,1-2.07-1.346,5.577,5.577,0,0,1-1.346-2.07,9.959,9.959,0,0,1-.62-3.342c-.087-1.9-.1-2.467-.1-7.273s.018-5.376.1-7.274a9.959,9.959,0,0,1,.62-3.342,5.576,5.576,0,0,1,1.346-2.07,5.576,5.576,0,0,1,2.07-1.347,9.959,9.959,0,0,1,3.342-.62c1.9-.087,2.467-.1,7.274-.1Z",transform:"translate(0 503.841)",fill:"#6e6e6e",clipRule:"evenodd"})),g.a.createElement("clipPath",{id:"d"},g.a.createElement("path",{d:"M0-467.989H36.011V-504H0Z",transform:"translate(0 504)",fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"e"},g.a.createElement("path",{d:"M131.8-366.042a6,6,0,0,1-6-6,6,6,0,0,1,6-6,6,6,0,0,1,6,6A6,6,0,0,1,131.8-366.042Zm0-15.243a9.243,9.243,0,0,0-9.243,9.243A9.243,9.243,0,0,0,131.8-362.8a9.243,9.243,0,0,0,9.243-9.243,9.243,9.243,0,0,0-9.243-9.243Z",transform:"translate(-122.556 381.285)",fill:"#6e6e6e",clipRule:"evenodd"})),g.a.createElement("clipPath",{id:"g"},g.a.createElement("path",{d:"M360.486-414.467a2.16,2.16,0,0,1-2.16,2.16,2.16,2.16,0,0,1-2.16-2.16,2.16,2.16,0,0,1,2.16-2.16,2.16,2.16,0,0,1,2.16,2.16",transform:"translate(-356.166 416.627)",fill:"#6e6e6e",clipRule:"evenodd"})),g.a.createElement("clipPath",{id:"j"},g.a.createElement("rect",{width:36,height:36}))),ii=g.a.createElement("g",{clipPath:"url(#b)"},g.a.createElement("g",{transform:"translate(0 0.011)",clipPath:"url(#c)"},g.a.createElement("g",{transform:"translate(0 -0.011)",clipPath:"url(#d)"},g.a.createElement("path",{d:"M-5-508.841H31.715v36.715H-5Z",transform:"translate(4.643 508.495)",fill:"#6e6e6e"})))),oi=g.a.createElement("g",{transform:"translate(8.757 8.757)",clipPath:"url(#e)"},g.a.createElement("g",{transform:"translate(-8.757 -8.768)",clipPath:"url(#d)"},g.a.createElement("path",{d:"M117.556-386.285h19.2v19.2h-19.2Z",transform:"translate(-109.156 394.696)",fill:"#6e6e6e"}))),si=g.a.createElement("g",{transform:"translate(25.448 6.232)",clipPath:"url(#g)"},g.a.createElement("g",{transform:"translate(-25.448 -6.243)",clipPath:"url(#d)"},g.a.createElement("path",{d:"M351.166-421.627H356.2v5.035h-5.035Z",transform:"translate(-326.075 427.513)",fill:"#6e6e6e"}))),li=function(e){var t=e.svgRef,n=e.title,a=ai(e,["svgRef","title"]);return g.a.createElement("svg",ni({width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,ri,g.a.createElement("g",{id:"i",clipPath:"url(#j)"},g.a.createElement("g",{transform:"translate(240 240)"},g.a.createElement("g",{transform:"translate(-240 -240)"},g.a.createElement("g",{transform:"translate(0 0)",clipPath:"url(#a)"},g.a.createElement("g",{transform:"translate(0 -0.011)",style:{isolation:"isolate"}},ii)),oi,si))))},ci=g.a.forwardRef((function(e,t){return g.a.createElement(li,ni({svgRef:t},e))}));n.p;function ui(){return(ui=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function di(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var hi=g.a.createElement("defs",null,g.a.createElement("clipPath",{id:"a"},g.a.createElement("path",{d:"M0-108H36v-36H0Z",transform:"translate(0 144)",fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"b"},g.a.createElement("rect",{width:36.249,height:36.015,fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"c"},g.a.createElement("path",{d:"M30.682-113.305H25.27V-122.7c0-2.772-1.178-3.626-2.7-3.626-1.606,0-3.18,1.209-3.18,3.7v9.326H13.981v-17.2h5.2v2.383h.069a5.9,5.9,0,0,1,5.144-2.867c3.02,0,6.283,1.792,6.283,7.046ZM8.024-132.9A3.064,3.064,0,0,1,4.9-136.01a3.065,3.065,0,0,1,3.12-3.109,3.066,3.066,0,0,1,3.12,3.109A3.064,3.064,0,0,1,8.024-132.9ZM5.318-113.318H10.73v-17.2H5.318ZM33.343-144H2.657A2.658,2.658,0,0,0,0-141.341v30.7a2.658,2.658,0,0,0,2.657,2.659H33.343A2.658,2.658,0,0,0,36-110.644v-30.7A2.658,2.658,0,0,0,33.343-144Z",transform:"translate(0 144)",fill:"#6e6e6e",clipRule:"evenodd"})),g.a.createElement("clipPath",{id:"d"},g.a.createElement("path",{d:"M0-107.985H36V-144H0Z",transform:"translate(0 144)",fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"f"},g.a.createElement("rect",{width:36,height:36}))),fi=g.a.createElement("g",{clipPath:"url(#b)"},g.a.createElement("g",{clipPath:"url(#c)"},g.a.createElement("g",{clipPath:"url(#d)"},g.a.createElement("path",{d:"M-5-149H33.5v38.516H-5Z",transform:"translate(3.75 147.749)",fill:"#6e6e6e"})))),pi=function(e){var t=e.svgRef,n=e.title,a=di(e,["svgRef","title"]);return g.a.createElement("svg",ui({width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,hi,g.a.createElement("g",{id:"e",clipPath:"url(#f)"},g.a.createElement("g",{transform:"translate(0 144)"},g.a.createElement("g",{transform:"translate(0 -144)",clipPath:"url(#a)"},g.a.createElement("g",{transform:"translate(0 0)",style:{isolation:"isolate"}},fi)))))},mi=g.a.forwardRef((function(e,t){return g.a.createElement(pi,ui({svgRef:t},e))}));n.p;function vi(){return(vi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function gi(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var bi=g.a.createElement("defs",null,g.a.createElement("clipPath",{id:"a"},g.a.createElement("path",{d:"M.06-206.991h36V-243H.06Z",transform:"translate(-0.06 243)",fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"b"},g.a.createElement("rect",{width:36.009,height:36.009,fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"c"},g.a.createElement("path",{d:"M18-243A18,18,0,0,0,0-225a18.014,18.014,0,0,0,11.443,16.772,17.3,17.3,0,0,1,.062-5.17c.327-1.405,2.111-8.949,2.111-8.949a6.5,6.5,0,0,1-.539-2.673c0-2.5,1.451-4.372,3.258-4.372a2.262,2.262,0,0,1,2.278,2.536c0,1.545-.984,3.854-1.491,5.995a2.614,2.614,0,0,0,2.666,3.254c3.2,0,5.66-3.374,5.66-8.245,0-4.311-3.1-7.325-7.521-7.325a7.793,7.793,0,0,0-8.13,7.813,7,7,0,0,0,1.34,4.109.538.538,0,0,1,.125.516c-.137.569-.44,1.792-.5,2.042-.079.33-.261.4-.6.241-2.249-1.047-3.655-4.334-3.655-6.975,0-5.68,4.127-10.9,11.9-10.9,6.246,0,11.1,4.451,11.1,10.4,0,6.205-3.912,11.2-9.343,11.2a4.819,4.819,0,0,1-4.126-2.067s-.9,3.438-1.122,4.28a20.111,20.111,0,0,1-2.238,4.72,18,18,0,0,0,5.331.8,18,18,0,0,0,18-18,18,18,0,0,0-18-18",transform:"translate(0 243)",fill:"#6e6e6e",clipRule:"evenodd"})),g.a.createElement("clipPath",{id:"d"},g.a.createElement("path",{d:"M0-206.991H36.009V-243H0Z",transform:"translate(0 243)",fill:"#6e6e6e"})),g.a.createElement("clipPath",{id:"f"},g.a.createElement("rect",{width:36,height:36}))),yi=g.a.createElement("g",{clipPath:"url(#b)"},g.a.createElement("g",{clipPath:"url(#c)"},g.a.createElement("g",{clipPath:"url(#d)"},g.a.createElement("path",{d:"M-5-248H32.491v37.491H-5Z",transform:"translate(4.259 247.259)",fill:"#6e6e6e"})))),Ei=function(e){var t=e.svgRef,n=e.title,a=gi(e,["svgRef","title"]);return g.a.createElement("svg",vi({width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,bi,g.a.createElement("g",{id:"e",clipPath:"url(#f)"},g.a.createElement("g",{transform:"translate(-0.06 243)"},g.a.createElement("g",{transform:"translate(0.06 -243)",clipPath:"url(#a)"},g.a.createElement("g",{transform:"translate(-0.009 0)",style:{isolation:"isolate"}},yi)))))},wi=g.a.forwardRef((function(e,t){return g.a.createElement(Ei,vi({svgRef:t},e))}));n.p;function xi(){return(xi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ki(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Si=g.a.createElement("defs",null,g.a.createElement("clipPath",{id:"b"},g.a.createElement("rect",{width:36,height:36}))),Ci=g.a.createElement("g",{id:"a",clipPath:"url(#b)"},g.a.createElement("g",{transform:"translate(-54.305 -55.32)"},g.a.createElement("path",{d:"M90.176,81.252a2.5,2.5,0,0,0-1.269-1.347c-.1-.06-.2-.108-.276-.144-.162-.084-.327-.165-.492-.25a10.742,10.742,0,0,1-3.928-3.369,7.639,7.639,0,0,1-.674-1.2.566.566,0,0,1-.018-.466.759.759,0,0,1,.216-.225c.291-.192.59-.387.794-.519.362-.235.649-.42.834-.552a4.549,4.549,0,0,0,1.484-1.578A3.143,3.143,0,0,0,87,69a3.087,3.087,0,0,0-2.988-1.962,4.117,4.117,0,0,0-.869.092c-.076.017-.153.034-.227.053.013-.828-.006-1.7-.079-2.562a9.341,9.341,0,0,0-2.424-5.872,9.658,9.658,0,0,0-2.464-1.983,11.753,11.753,0,0,0-11.282,0A9.623,9.623,0,0,0,64.2,58.749a9.348,9.348,0,0,0-2.424,5.872c-.074.86-.092,1.738-.08,2.562-.075-.019-.15-.037-.226-.053a4.116,4.116,0,0,0-.869-.092A3.086,3.086,0,0,0,57.61,69a3.147,3.147,0,0,0,.152,2.613,4.561,4.561,0,0,0,1.485,1.578c.184.129.472.315.834.552.2.127.482.313.763.5a.819.819,0,0,1,.245.246.58.58,0,0,1-.027.489,7.57,7.57,0,0,1-.663,1.171,10.712,10.712,0,0,1-3.815,3.311c-.867.46-1.769.767-2.15,1.8a2.277,2.277,0,0,0,.63,2.418h0a3.646,3.646,0,0,0,.92.7,9.965,9.965,0,0,0,2.251.9,1.487,1.487,0,0,1,.454.2c.266.233.228.583.582,1.1a2.557,2.557,0,0,0,.666.677,4.371,4.371,0,0,0,2.463.579,9.369,9.369,0,0,1,2.74.407,7.037,7.037,0,0,1,1.39.736A10.157,10.157,0,0,0,78.1,88.965a7.164,7.164,0,0,1,1.371-.724,9.339,9.339,0,0,1,2.74-.407,4.371,4.371,0,0,0,2.463-.579,2.565,2.565,0,0,0,.758-.828c.255-.433.248-.736.488-.947a1.409,1.409,0,0,1,.427-.2,10,10,0,0,0,2.281-.909,3.587,3.587,0,0,0,.966-.756l.009-.011A2.248,2.248,0,0,0,90.176,81.252Zm-2.523,1.356c-1.539.85-2.562.759-3.357,1.271-.676.435-.276,1.373-.767,1.712-.6.417-2.387-.029-4.691.731-1.9.628-3.113,2.435-6.531,2.435s-4.6-1.8-6.533-2.439c-2.3-.761-4.087-.315-4.691-.731-.49-.338-.092-1.277-.767-1.712-.8-.512-1.819-.421-3.357-1.267-.98-.541-.424-.876-.1-1.034,5.574-2.7,6.463-6.865,6.5-7.174a.985.985,0,0,0-.311-1.049c-.4-.368-2.165-1.462-2.655-1.8-.811-.567-1.168-1.132-.905-1.828a1.091,1.091,0,0,1,1.1-.662,2.051,2.051,0,0,1,.442.05c.89.193,1.755.639,2.254.76a.8.8,0,0,0,.184.025c.267,0,.361-.134.342-.44a32.55,32.55,0,0,1-.041-4.647,7.367,7.367,0,0,1,1.932-4.72A9.311,9.311,0,0,1,78.9,60.073a7.352,7.352,0,0,1,1.932,4.72,31.744,31.744,0,0,1-.041,4.647c-.021.321.075.44.342.44a.788.788,0,0,0,.184-.025c.5-.12,1.365-.567,2.255-.76a2.052,2.052,0,0,1,.442-.05,1.092,1.092,0,0,1,1.1.662c.263.7-.092,1.261-.9,1.828-.49.342-2.257,1.435-2.655,1.8a.983.983,0,0,0-.311,1.049c.04.314.928,4.48,6.5,7.174C88.077,81.728,88.633,82.063,87.653,82.608Z",fill:"#6e6e6e"}))),Oi=function(e){var t=e.svgRef,n=e.title,a=ki(e,["svgRef","title"]);return g.a.createElement("svg",xi({width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,Si,Ci)},Pi=g.a.forwardRef((function(e,t){return g.a.createElement(Oi,xi({svgRef:t},e))}));n.p;function Ti(){return(Ti=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Mi(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ii=g.a.createElement("rect",{className:"cls-1",x:28,y:22,width:2,height:36}),Ai=g.a.createElement("rect",{className:"cls-1",x:50,y:22,width:2,height:36}),Ri=g.a.createElement("path",{className:"fill",d:"M78,18H2a2,2,0,0,0-2,2V60a2,2,0,0,0,2,2H78a2,2,0,0,0,2-2V20A2,2,0,0,0,78,18ZM76,58H4V22H76Z"}),Di=function(e){var t=e.svgRef,n=e.title,a=Mi(e,["svgRef","title"]);return g.a.createElement("svg",Ti({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},a),n?g.a.createElement("title",null,n):null,Ii,Ai,Ri)},ji=g.a.forwardRef((function(e,t){return g.a.createElement(Di,Ti({svgRef:t},e))}));n.p;function _i(){return(_i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Li(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ni=g.a.createElement("rect",{className:"cls-1",x:24,y:20,width:2,height:40}),Vi=g.a.createElement("rect",{className:"cls-1",x:54,y:20,width:2,height:40}),Fi=g.a.createElement("path",{className:"fill",d:"M74,16H6a2,2,0,0,0-2,2V62a2,2,0,0,0,2,2H74a2,2,0,0,0,2-2V18A2,2,0,0,0,74,16ZM72,60H8V20H72Z"}),Ui=function(e){var t=e.svgRef,n=e.title,a=Li(e,["svgRef","title"]);return g.a.createElement("svg",_i({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},a),n?g.a.createElement("title",null,n):null,Ni,Vi,Fi)},Bi=g.a.forwardRef((function(e,t){return g.a.createElement(Ui,_i({svgRef:t},e))}));n.p;function Hi(){return(Hi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function zi(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Gi=g.a.createElement("rect",{className:"cls-1",x:22,y:20,width:2,height:40}),Wi=g.a.createElement("rect",{className:"cls-1",x:56,y:20,width:2,height:40}),Zi=g.a.createElement("path",{className:"fill",d:"M70,16H10a2,2,0,0,0-2,2V62a2,2,0,0,0,2,2H70a2,2,0,0,0,2-2V18A2,2,0,0,0,70,16ZM68,60H12V20H68Z"}),Yi=function(e){var t=e.svgRef,n=e.title,a=zi(e,["svgRef","title"]);return g.a.createElement("svg",Hi({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},a),n?g.a.createElement("title",null,n):null,Gi,Wi,Zi)},Ki=g.a.forwardRef((function(e,t){return g.a.createElement(Yi,Hi({svgRef:t},e))}));n.p;function Xi(){return(Xi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function qi(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ji=g.a.createElement("rect",{className:"cls-1",x:22,y:20,width:2,height:40}),Qi=g.a.createElement("rect",{className:"cls-1",x:56,y:20,width:2,height:40}),$i=g.a.createElement("path",{className:"fill",d:"M68,16H12a2,2,0,0,0-2,2V62a2,2,0,0,0,2,2H68a2,2,0,0,0,2-2V18A2,2,0,0,0,68,16ZM66,60H14V20H66Z"}),eo=function(e){var t=e.svgRef,n=e.title,a=qi(e,["svgRef","title"]);return g.a.createElement("svg",Xi({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},a),n?g.a.createElement("title",null,n):null,Ji,Qi,$i)},to=g.a.forwardRef((function(e,t){return g.a.createElement(eo,Xi({svgRef:t},e))}));n.p;function no(){return(no=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ao(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ro=g.a.createElement("rect",{className:"cls-1",x:24,y:20,width:2,height:40}),io=g.a.createElement("rect",{className:"cls-1",x:54,y:20,width:2,height:40}),oo=g.a.createElement("path",{className:"fill",d:"M72,16H8a2,2,0,0,0-2,2V62a2,2,0,0,0,2,2H72a2,2,0,0,0,2-2V18A2,2,0,0,0,72,16ZM70,60H10V20H70Z"}),so=function(e){var t=e.svgRef,n=e.title,a=ao(e,["svgRef","title"]);return g.a.createElement("svg",no({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},a),n?g.a.createElement("title",null,n):null,ro,io,oo)},lo=g.a.forwardRef((function(e,t){return g.a.createElement(so,no({svgRef:t},e))}));n.p;function co(){return(co=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function uo(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ho=g.a.createElement("path",{className:"fill",d:"M69.63,16H10.37A2.385,2.385,0,0,0,8,18.4V61.6A2.385,2.385,0,0,0,10.37,64H69.63A2.385,2.385,0,0,0,72,61.6V18.4A2.385,2.385,0,0,0,69.63,16ZM68,60H12V20H68Z"}),fo=g.a.createElement("path",{id:"arrow_fill","data-name":"arrow fill",className:"fill",d:"M33.373,34.622,28.242,29.49l1.975-1.978a.5.5,0,0,0-.354-.854H24v5.864a.5.5,0,0,0,.854.354L26.829,30.9l5.134,5.132a.5.5,0,0,0,.707,0l.7-.711A.5.5,0,0,0,33.373,34.622Z"}),po=g.a.createElement("path",{id:"arrow_fill-2","data-name":"arrow fill",className:"fill",d:"M44.627,46.694l5.131,5.132L47.783,53.8a.5.5,0,0,0,0,.707.494.494,0,0,0,.355.147H54V48.794a.5.5,0,0,0-.854-.354l-1.975,1.975-5.134-5.132a.5.5,0,0,0-.707,0l-.7.711A.5.5,0,0,0,44.627,46.694Z"}),mo=g.a.createElement("path",{id:"arrow_fill-3","data-name":"arrow fill",className:"fill",d:"M44.627,34.622l5.131-5.132-1.975-1.978a.5.5,0,0,1,.354-.854H54v5.864a.5.5,0,0,1-.854.354L51.171,30.9l-5.134,5.132a.5.5,0,0,1-.707,0l-.7-.711A.5.5,0,0,1,44.627,34.622Z"}),vo=g.a.createElement("path",{id:"arrow_fill-4","data-name":"arrow fill",className:"fill",d:"M33.373,46.694l-5.131,5.132L30.217,53.8a.5.5,0,0,1,0,.707.494.494,0,0,1-.355.147H24V48.794a.5.5,0,0,1,.854-.354l1.975,1.975,5.134-5.132a.5.5,0,0,1,.707,0l.7.711A.5.5,0,0,1,33.373,46.694Z"}),go=function(e){var t=e.svgRef,n=e.title,a=uo(e,["svgRef","title"]);return g.a.createElement("svg",co({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},a),n?g.a.createElement("title",null,n):null,ho,fo,po,mo,vo)},bo=g.a.forwardRef((function(e,t){return g.a.createElement(go,co({svgRef:t},e))}));n.p;function yo(){return(yo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Eo(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var wo=g.a.createElement("rect",{className:"cls-1",x:23,y:20,width:2,height:40}),xo=g.a.createElement("rect",{className:"cls-1",x:55,y:20,width:2,height:40}),ko=g.a.createElement("path",{className:"fill",d:"M69.63,16H10.37A2.385,2.385,0,0,0,8,18.4V61.6A2.385,2.385,0,0,0,10.37,64H69.63A2.385,2.385,0,0,0,72,61.6V18.4A2.385,2.385,0,0,0,69.63,16ZM68,60H12V20H68Z"}),So=function(e){var t=e.svgRef,n=e.title,a=Eo(e,["svgRef","title"]);return g.a.createElement("svg",yo({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},a),n?g.a.createElement("title",null,n):null,wo,xo,ko)},Co=g.a.forwardRef((function(e,t){return g.a.createElement(So,yo({svgRef:t},e))}));n.p;function Oo(){return(Oo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Po(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var To=g.a.createElement("path",{className:"fill",d:"M61.63,16H18.37A2.385,2.385,0,0,0,16,18.4V61.6A2.385,2.385,0,0,0,18.37,64H61.63A2.385,2.385,0,0,0,64,61.6V18.4A2.385,2.385,0,0,0,61.63,16ZM60,60H20V20H60Z"}),Mo=function(e){var t=e.svgRef,n=e.title,a=Po(e,["svgRef","title"]);return g.a.createElement("svg",Oo({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},a),n?g.a.createElement("title",null,n):null,To)},Io=g.a.forwardRef((function(e,t){return g.a.createElement(Mo,Oo({svgRef:t},e))}));n.p;function Ao(){return(Ao=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ro(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Do=g.a.createElement("defs",null,g.a.createElement("clipPath",{id:"b"},g.a.createElement("rect",{width:36,height:36}))),jo=g.a.createElement("g",{id:"a",clipPath:"url(#b)"},g.a.createElement("rect",{width:36,height:36,fill:"none"}),g.a.createElement("path",{d:"M82.076,116.733A13.045,13.045,0,0,0,95.21,103.6c0-.2,0-.4-.014-.6a9.392,9.392,0,0,0,2.3-2.389,9.214,9.214,0,0,1-2.651.726,4.632,4.632,0,0,0,2.029-2.553,9.251,9.251,0,0,1-2.931,1.12,4.621,4.621,0,0,0-7.867,4.21,13.106,13.106,0,0,1-9.514-4.823A4.62,4.62,0,0,0,78,105.455a4.582,4.582,0,0,1-2.1-.578v.059a4.618,4.618,0,0,0,3.7,4.525,4.609,4.609,0,0,1-2.084.079,4.621,4.621,0,0,0,4.313,3.206,9.263,9.263,0,0,1-5.733,1.98,9.393,9.393,0,0,1-1.1-.067,13.069,13.069,0,0,0,7.076,2.07",transform:"translate(-68.25 -89.59)",fill:"#6e6e6e"})),_o=function(e){var t=e.svgRef,n=e.title,a=Ro(e,["svgRef","title"]);return g.a.createElement("svg",Ao({width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,Do,jo)},Lo=g.a.forwardRef((function(e,t){return g.a.createElement(_o,Ao({svgRef:t},e))}));n.p;function No(){return(No=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Vo(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Fo,Uo=g.a.createElement("defs",null,g.a.createElement("clipPath",{id:"b"},g.a.createElement("rect",{width:36,height:36}))),Bo=g.a.createElement("g",{id:"a",clipPath:"url(#b)"},g.a.createElement("g",{transform:"translate(-0.06 128.959)"},g.a.createElement("path",{d:"M17.994,25.364c-.028,0-2.852,0-5.982-.095-1.839-.055-3.421-.131-4.7-.225a20.861,20.861,0,0,1-3.383-.438A4.525,4.525,0,0,1,.74,21.4a23.468,23.468,0,0,1-.567-3.98C.064,15.988.018,14.591,0,13.672V11.684c.018-.919.064-2.316.173-3.75A23.462,23.462,0,0,1,.74,3.954,4.524,4.524,0,0,1,3.924.749C6.116.158,13.481.028,16.545,0h2.9c3.064.028,10.428.158,12.621.749a4.524,4.524,0,0,1,3.184,3.2,27.833,27.833,0,0,1,.659,5.422c.093,1.807.094,3.287.094,3.3s0,1.5-.094,3.3a30.576,30.576,0,0,1-.659,5.422,4.525,4.525,0,0,1-3.184,3.2,20.862,20.862,0,0,1-3.383.438c-1.283.094-2.866.17-4.7.225C20.845,25.363,18.022,25.364,17.994,25.364ZM14.311,7.323V18.032l9.412-5.354Z",transform:"translate(0.06 -123.959)",fill:"#6e6e6e"}))),Ho=function(e){var t=e.svgRef,n=e.title,a=Vo(e,["svgRef","title"]);return g.a.createElement("svg",No({width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,Uo,Bo)},zo=g.a.forwardRef((function(e,t){return g.a.createElement(Ho,No({svgRef:t},e))}));n.p;!function(e){e[e.KEEP=0]="KEEP",e[e.CUTOUT=1]="CUTOUT"}(Fo||(Fo={}));var Go=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"getUIAspectRatios",value:function(e,t){return[{key:"photos",name:e("CropView.Controls.Select.AspectRatio.Group.Photos","Photos"),aspectRatios:[{icon:g.a.createElement(ar,{size:"M",icon:g.a.createElement(Co,null)}),key:"original",label:e("CropView.Controls.Select.AspectRatio.Original","Original"),ratio:t},{icon:g.a.createElement(ar,{size:"M",icon:g.a.createElement(bo,null)}),key:"custom",label:e("CropView.Controls.Select.AspectRatio.Custom","Custom"),ratio:0},{icon:g.a.createElement(ar,{size:"M",icon:g.a.createElement(Io,null)}),key:"square",label:e("CropView.Controls.Select.AspectRatio.Square","Square"),ratio:1},{icon:g.a.createElement(ar,{size:"M",icon:g.a.createElement(to,null)}),key:"5x4",label:e("CropView.Controls.Select.AspectRatio.5x4","5:4"),ratio:1.25},{icon:g.a.createElement(ar,{size:"M",icon:g.a.createElement(Ki,null)}),key:"4x3",label:e("CropView.Controls.Select.AspectRatio.4x3","4:3"),ratio:1.3333333333333333},{icon:g.a.createElement(ar,{size:"M",icon:g.a.createElement(Bi,null)}),key:"3x2",label:e("CropView.Controls.Select.AspectRatio.3x2","3:2"),ratio:1.5},{icon:g.a.createElement(ar,{size:"M",icon:g.a.createElement(lo,null)}),key:"7x5",label:e("CropView.Controls.Select.AspectRatio.7x5","7:5"),ratio:1.4},{icon:g.a.createElement(ar,{size:"M",icon:g.a.createElement(ji,null)}),key:"16x9",label:e("CropView.Controls.Select.AspectRatio.16x9","16:9"),ratio:1.7777777777777777}]},{key:"facebook",name:e("CropView.Controls.Select.AspectRatio.Group.Facebook","Facebook"),aspectRatios:[{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(ti,null)}),key:"fb_profile",label:e("CropView.Controls.Select.AspectRatio.FBProfile","Facebook profile"),ratio:1,width:180,height:180},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(ti,null)}),key:"fb_profile_cover",label:e("CropView.Controls.Select.AspectRatio.FBProfileCover","Facebook profile cover"),ratio:2.628205128205128,width:820,height:312},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(ti,null)}),key:"fb_event",label:e("CropView.Controls.Select.AspectRatio.FBEvent","Facebook event"),ratio:1.7777777777777777,width:1920,height:1080}]},{key:"linkedin",name:e("CropView.Controls.Select.AspectRatio.Group.LinkedIn","LinkedIn"),aspectRatios:[{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(mi,null)}),key:"li_profile",label:e("CropView.Controls.Select.AspectRatio.LIProfile","LinkedIn profile"),ratio:1,width:400,height:400},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(mi,null)}),key:"li_background",label:e("CropView.Controls.Select.AspectRatio.LIBackground","LinkedIn background"),ratio:4,width:1584,height:396}]},{key:"youtube",name:e("CropView.Controls.Select.AspectRatio.Group.Youtube","Youtube"),aspectRatios:[{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(zo,null)}),key:"yt_profile",label:e("CropView.Controls.Select.AspectRatio.YTProfile","Youtube profile"),ratio:1,width:800,height:800},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(zo,null)}),key:"yt_cover",label:e("CropView.Controls.Select.AspectRatio.YTCover","Youtube cover"),ratio:1.7777777777777777,width:2560,height:1440},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(zo,null)}),key:"yt_thumbnail",label:e("CropView.Controls.Select.AspectRatio.YTThumbnail","Youtube thumbnail"),ratio:1.7777777777777777,width:1280,height:720}]},{key:"twitter",name:e("CropView.Controls.Select.AspectRatio.Group.Twitter","Twitter"),aspectRatios:[{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(Lo,null)}),key:"tw_header",label:e("CropView.Controls.Select.AspectRatio.TWHeader","Twitter header"),ratio:3,width:1500,height:500},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(Lo,null)}),key:"tw_post",label:e("CropView.Controls.Select.AspectRatio.TWPost","Twitter post"),ratio:2,width:440,height:220},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(Lo,null)}),key:"tw_profile",label:e("CropView.Controls.Select.AspectRatio.TWProfile","Twitter profile"),ratio:1,width:400,height:400}]},{key:"instagram",name:e("CropView.Controls.Select.AspectRatio.Group.Instagram","Instagram"),aspectRatios:[{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(ci,null)}),key:"ig_profile",label:e("CropView.Controls.Select.AspectRatio.IGProfile","Instagram profile"),ratio:1,width:110,height:110},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(ci,null)}),key:"ig_stories",label:e("CropView.Controls.Select.AspectRatio.IGStories","Instagram stories"),ratio:.5625,width:1080,height:1920},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(ci,null)}),key:"ig_post",label:e("CropView.Controls.Select.AspectRatio.IGPost","Instagram post"),ratio:1,width:1080,height:1080}]},{key:"pinterest",name:e("CropView.Controls.Select.AspectRatio.Group.Pinterest","Pinterest"),aspectRatios:[{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(wi,null)}),key:"p_profile",label:e("CropView.Controls.Select.AspectRatio.PProfile","Pinterest profile"),ratio:1,width:165,height:165}]},{key:"snapchat",name:e("CropView.Controls.Select.AspectRatio.Group.Snapchat","Snapchat"),aspectRatios:[{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(Pi,null)}),key:"sc_snap",label:e("CropView.Controls.Select.AspectRatio.SCSnap","Snapchat snap"),ratio:.5625,width:1080,height:1920},{icon:g.a.createElement(ar,{size:"S",icon:g.a.createElement(Pi,null)}),key:"sc_story",label:e("CropView.Controls.Select.AspectRatio.SCStory","Snapchat story"),ratio:.5625,width:1080,height:1920}]}]}},{key:"loadShapes",value:function(){this.images.heart.src="data:image/svg+xml;base64,".concat(Xr.HEART_BASE64),this.images.octagon.src="data:image/svg+xml;base64,".concat(Xr.OCTAGON_BASE64),this.images.roundedRect.src="data:image/svg+xml;base64,".concat(Xr.ROUNDED_RECT_BASE64),this.images.star.src="data:image/svg+xml;base64,".concat(Xr.STAR_BASE64)}},{key:"applyShape",value:function(e,t,n,a,r,i,o){var s;switch(t){case Gr.HEART:s=this.images.heart;break;case Gr.OCTAGON:s=this.images.octagon;break;case Gr.ROUNDED_RECT:s=this.images.roundedRect;break;case Gr.STAR:s=this.images.star;break;default:return}var l=e.globalCompositeOperation,c=e.globalAlpha;switch(n){case Fo.CUTOUT:e.globalAlpha=1,e.globalCompositeOperation="destination-out";break;case Fo.KEEP:default:e.globalAlpha=1,e.globalCompositeOperation="destination-in"}e.drawImage(s,a,r,i,o),e.globalCompositeOperation=l,e.globalAlpha=c}}]),e}();Go.images={heart:document.createElement("img"),octagon:document.createElement("img"),roundedRect:document.createElement("img"),star:document.createElement("img")},Go.loadShapes();var Wo,Zo=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).uiAspectRatios=void 0,a.rotateLeft=function(){a.props.controller.changeOrientation(-90)},a.rotateRight=function(){a.props.controller.changeOrientation(90)},a.flipHorizontally=function(){a.props.controller.flipHorizontally()},a.flipVertically=function(){a.props.controller.flipVertically()},a.setCropShape=function(e){a.props.controller.setCropShape(e)},a.changeAspectRatio=function(e){if("string"===typeof e||e instanceof String){var t,n=a.getAspectRatioInfoByKey(e);if(n)null===(t=a.props.controller)||void 0===t||t.changeAspectRatio(n.key,n.ratio)}},a.rotateAspectRatio=function(){a.props.controller.rotateAspectRatio()},a.uiAspectRatios=Go.getUIAspectRatios(Ze,a.props.imageAspectRatio),a.state={straightening:0,aspectRatioKey:"",canReset:!1,cropShape:Gr.RECT},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"getAspectRatioInfoByKey",value:function(e){return Object(Ft.flatMap)(this.uiAspectRatios,(function(e){return e.aspectRatios})).find((function(t){return t.key===e}))}},{key:"refresh",value:function(){var e,t=this.props.controller.getEditorState();this.setState({straightening:t.straightening,aspectRatioKey:null!==(e=t.aspectRatioKey)&&void 0!==e?e:"",canReset:this.props.controller.isDirty(),cropShape:t.cropShape})}},{key:"render",value:function(){var e,t=this,n=this.props.controller,a=this.state,r=a.straightening,i=a.aspectRatioKey,o=a.canReset,s=a.cropShape,l=null===(e=K.getParams().crop)||void 0===e?void 0:e.enableCropShapes;return g.a.createElement("div",{className:"editor-panel"},g.a.createElement("div",{className:"settings-right crop-settings-right"},g.a.createElement("div",{className:"settings-scrolling-content"},g.a.createElement("div",{className:"settings-header"},g.a.createElement("div",{className:"title"},Ze("CropView.Title.CropImage","Crop image")),g.a.createElement("div",{className:"reset-button"},g.a.createElement(xe.a,{quiet:!0,variant:"action",onClick:function(){n.reset()},icon:g.a.createElement(na.a,null),disabled:!o},Ze("CropView.Button.Reset","Reset")))),g.a.createElement("section",null,g.a.createElement(Se.a,{label:Ze("CropView.Controls.ButtonGroup.Label.RotateAndFlip","Rotate & flip"),labelFor:"__"},g.a.createElement(xe.a,{quiet:!0,variant:"action",title:Ze("CropView.Controls.Button.RotateL","Rotate Left"),onClick:this.rotateLeft,icon:g.a.createElement(ar,{icon:g.a.createElement(Lr,null),size:"S"})}),g.a.createElement(xe.a,{quiet:!0,variant:"action",title:Ze("CropView.Controls.Button.RotateR","Rotate Right"),onClick:this.rotateRight,icon:g.a.createElement(ar,{icon:g.a.createElement(Br,null),size:"S"})}),g.a.createElement(xe.a,{quiet:!0,variant:"action",title:Ze("CropView.Controls.Button.FlipH","Flip Horizontal"),onClick:this.flipHorizontally,icon:g.a.createElement(ar,{icon:g.a.createElement(gr,null),size:"S"})}),g.a.createElement(xe.a,{quiet:!0,variant:"action",title:Ze("CropView.Controls.Button.FlipV","Flip Vertical"),onClick:this.flipVertically,icon:g.a.createElement(ar,{icon:g.a.createElement(Ar,null),size:"S"})}))),g.a.createElement("section",null,g.a.createElement(Be.a,{renderLabel:!0,label:Ze("CropView.Controls.Slider.Label.Straighten","Straighten"),min:-45,max:45,step:.1,filled:!0,fillOffset:.01,value:r,onChange:function(e){return n.setStraightening(e)},onChangeEnd:function(e){return n.setStraightening(e,!0)}})),g.a.createElement("div",{className:"settings-section-divider"}),g.a.createElement(Se.a,{label:Ze("CropView.Controls.Select.Label.AspectRatio","Aspect ratio"),className:"sectionless-fieldlabel",labelFor:"__"},g.a.createElement(xe.a,{quiet:!0,variant:"action",icon:g.a.createElement(ar,{icon:g.a.createElement(Kr,null),size:"S"}),"aria-label":"Rotate aspect ratio",className:"fieldlabel-button",onClick:this.rotateAspectRatio},Ze("CropView.Button.RotateAspectRatio","Rotate")),g.a.createElement(aa.Accordion,{defaultSelectedIndex:l?void 0:0},this.uiAspectRatios.map((function(e){return g.a.createElement(aa.AccordionItem,{key:e.key,header:e.name},g.a.createElement(Sa.a,{orientation:"vertical",className:"w-100",onChange:t.changeAspectRatio,value:"".concat(i)},e.aspectRatios.map((function(e){return g.a.createElement(xe.a,{key:e.key,label:e.label,value:e.key,icon:e.icon})}))))})))),l&&g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:"settings-section-divider"}),g.a.createElement(Se.a,{label:Ze("CropView.Controls.Select.Label.Shapes","Shapes"),className:"sectionless-fieldlabel shapes",labelFor:"__"},g.a.createElement("section",null,g.a.createElement(xe.a,{variant:"action",selected:s===Gr.RECT,title:Ze("CropView.Controls.Button.ShapeRectangle","Rectangle"),onClick:function(){return t.setCropShape(Gr.RECT)},icon:g.a.createElement(ar,{icon:g.a.createElement(Ga,null),size:"XXL"})}),g.a.createElement(xe.a,{variant:"action",selected:s===Gr.ROUNDED_RECT,title:Ze("CropView.Controls.Button.ShapeRoundedRectangle","Rounded Rectangle"),onClick:function(){return t.setCropShape(Gr.ROUNDED_RECT)},icon:g.a.createElement(ar,{icon:g.a.createElement(Xa,null),size:"XXL"})}),g.a.createElement(xe.a,{variant:"action",selected:s===Gr.ELLIPSE,title:Ze("CropView.Controls.Button.ShapeCircle","Circle"),onClick:function(){return t.setCropShape(Gr.ELLIPSE)},icon:g.a.createElement(ar,{icon:g.a.createElement(Ma,null),size:"XXL"})}),g.a.createElement(xe.a,{variant:"action",selected:s===Gr.HEART,title:Ze("CropView.Controls.Button.ShapeHeart","Heart"),onClick:function(){return t.setCropShape(Gr.HEART)},icon:g.a.createElement(ar,{icon:g.a.createElement(ja,null),size:"XXL"})}),g.a.createElement(xe.a,{variant:"action",selected:s===Gr.STAR,title:Ze("CropView.Controls.Button.ShapeStar","Star"),onClick:function(){return t.setCropShape(Gr.STAR)},icon:g.a.createElement(ar,{icon:g.a.createElement(er,null),size:"XXL"})}),g.a.createElement(xe.a,{variant:"action",selected:s===Gr.OCTAGON,title:Ze("CropView.Controls.Button.ShapeOctagon","Octagon"),onClick:function(){return t.setCropShape(Gr.OCTAGON)},icon:g.a.createElement(ar,{icon:g.a.createElement(Fa,null),size:"XXL"})}))))),g.a.createElement("div",{className:"action-button-container"},g.a.createElement(xe.a,{onClick:function(){ie("cropCancel"),n.cancel()}},Ze("CropView.Button.Cancel","Cancel")),g.a.createElement(xe.a,{quiet:!0,variant:"cta",onClick:function(){ie("crop"),n.apply()},disabled:!o,title:Ze("CropView.Button.CropImage","Crop image")},Ze("CropView.Button.CropImage","Crop image")))))}}]),n}(v.PureComponent),Yo=(n(529),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).cropContainer=void 0,a.cropBox=void 0,a.cropOverlay=void 0,a.cropHandleTL=void 0,a.cropHandleT=void 0,a.cropHandleTR=void 0,a.cropHandleR=void 0,a.cropHandleBR=void 0,a.cropHandleB=void 0,a.cropHandleBL=void 0,a.cropHandleL=void 0,a.state={isStraightening:!1,hideHorizontalEdgeHandles:!1,hideVerticalEdgeHandles:!1},a.cropContainer=g.a.createRef(),a.cropBox=g.a.createRef(),a.cropOverlay=g.a.createRef(),a.cropHandleTL=g.a.createRef(),a.cropHandleT=g.a.createRef(),a.cropHandleTR=g.a.createRef(),a.cropHandleR=g.a.createRef(),a.cropHandleBR=g.a.createRef(),a.cropHandleB=g.a.createRef(),a.cropHandleBL=g.a.createRef(),a.cropHandleL=g.a.createRef(),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),this.refresh()}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setIsStraighening",value:function(e){this.setState({isStraightening:e})}},{key:"checkHit",value:function(e,t){return this.isHit(this.cropHandleTL.current,e,t)?Wo.TL:this.isHit(this.cropHandleTR.current,e,t)?Wo.TR:this.isHit(this.cropHandleBL.current,e,t)?Wo.BL:this.isHit(this.cropHandleBR.current,e,t)?Wo.BR:this.isHit(this.cropHandleT.current,e,t)?Wo.T:this.isHit(this.cropHandleL.current,e,t)?Wo.L:this.isHit(this.cropHandleR.current,e,t)?Wo.R:this.isHit(this.cropHandleB.current,e,t)?Wo.B:this.isHit(this.cropBox.current,e,t)?Wo.BOX_INSIDE:Wo.BOX_OUTSIDE}},{key:"isHit",value:function(e,t,n){var a=null===e||void 0===e?void 0:e.getBoundingClientRect();return void 0!==a&&a.left<=t&&a.right>=t&&a.top<=n&&a.bottom>=n}},{key:"refresh",value:function(){}},{key:"draw",value:function(e,t,n,a){var r,i,o,s,l={width:null!==(r=null===(i=this.cropContainer.current)||void 0===i?void 0:i.clientWidth)&&void 0!==r?r:0,height:null!==(o=null===(s=this.cropContainer.current)||void 0===s?void 0:s.clientHeight)&&void 0!==o?o:0};if(this.cropBox.current&&(this.cropBox.current.style.left="".concat(t[0],"px"),this.cropBox.current.style.top="".concat(t[1],"px"),this.cropBox.current.style.width="".concat(Math.floor(e[0]),"px"),this.cropBox.current.style.height="".concat(Math.floor(e[1]),"px")),this.cropOverlay.current){this.cropOverlay.current.width=l.width,this.cropOverlay.current.height=l.height;var c=this.cropOverlay.current.getContext("2d");if(c)switch(c.clearRect(0,0,l.width,l.height),c.globalAlpha=.5,c.globalCompositeOperation="source-over",c.fillStyle="var(--spectrum-global-color-gray-700)",c.fillRect(0,0,l.width,l.height),c.globalAlpha=1,c.globalCompositeOperation="destination-out",a){case Gr.RECT:c.fillRect(t[0]+0,t[1]+0,e[0],e[1]);break;case Gr.ELLIPSE:var u=t[0]+e[0]/2+0,d=t[1]+e[1]/2+0,h=Math.abs(e[0]/2),f=Math.abs(e[1]/2);c.beginPath(),c.ellipse(u,d,h,f,0,0,2*Math.PI,!1),c.fill();break;case Gr.HEART:case Gr.OCTAGON:case Gr.ROUNDED_RECT:case Gr.STAR:Go.applyShape(c,a,Fo.CUTOUT,t[0],t[1],e[0],e[1])}}this.setState({hideHorizontalEdgeHandles:e[0]<100,hideVerticalEdgeHandles:e[1]<100})}},{key:"render",value:function(){var e=this.state,t=e.isStraightening,n=e.hideHorizontalEdgeHandles,a=e.hideVerticalEdgeHandles,r=t?["crop-box","straightening"]:["crop-box"];return n&&r.push("hide-horizontal"),a&&r.push("hide-vertical"),g.a.createElement(g.a.Fragment,null,g.a.createElement("canvas",{id:"cropOverlay",className:"crop-overlay",ref:this.cropOverlay}),g.a.createElement("div",{id:"cropContainer",className:"crop-container",ref:this.cropContainer},g.a.createElement("div",{className:"crop-center"}),g.a.createElement("div",{id:"cropBox",className:r.join(" "),ref:this.cropBox},g.a.createElement("div",{className:"crop-corner crop-tl",ref:this.cropHandleTL},g.a.createElement("div",null)),g.a.createElement("div",{className:"crop-edge horizontal crop-t",ref:this.cropHandleT},g.a.createElement("div",null)),g.a.createElement("div",{className:"crop-corner crop-tr",ref:this.cropHandleTR},g.a.createElement("div",null)),g.a.createElement("div",{className:"crop-edge vertical crop-l",ref:this.cropHandleL},g.a.createElement("div",null)),g.a.createElement("div",{className:"crop-edge vertical crop-r",ref:this.cropHandleR},g.a.createElement("div",null)),g.a.createElement("div",{className:"crop-corner crop-bl",ref:this.cropHandleBL},g.a.createElement("div",null)),g.a.createElement("div",{className:"crop-edge horizontal crop-b",ref:this.cropHandleB},g.a.createElement("div",null)),g.a.createElement("div",{className:"crop-corner crop-br",ref:this.cropHandleBR},g.a.createElement("div",null)),g.a.createElement("div",{className:"crop-rough-grid horizontal"}),g.a.createElement("div",{className:"crop-rough-grid vertical"}),g.a.createElement("div",{className:"crop-fine-grid"}),g.a.createElement("div",{className:"crop-center"}))))}}]),n}(v.PureComponent));!function(e){e[e.TL=1]="TL",e[e.TR=2]="TR",e[e.BL=3]="BL",e[e.BR=4]="BR",e[e.T=5]="T",e[e.R=6]="R",e[e.B=7]="B",e[e.L=8]="L",e[e.BOX_INSIDE=9]="BOX_INSIDE",e[e.BOX_OUTSIDE=10]="BOX_OUTSIDE"}(Wo||(Wo={}));var Ko,Xo=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).editor=void 0,a.editor=e,a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Yo,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"getCropToolView",value:function(){return this.view}},{key:"refresh",value:function(){var e,t=this.editor.getEditorState(),n=this.editor.getCropBoxDetails();null===(e=this.getCropToolView())||void 0===e||e.draw(n.dimensions,n.offset,n.editorCenter,t.cropShape)}},{key:"move",value:function(){}},{key:"checkHit",value:function(e){var t;return null===(t=this.getCropToolView())||void 0===t?void 0:t.checkHit(e[0],e[1])}},{key:"setIsStraighening",value:function(e){var t;null===(t=this.getCropToolView())||void 0===t||t.setIsStraighening(e)}}]),n}(F);!function(e){e[e.NONE=1]="NONE",e[e.CROP_EDGE=2]="CROP_EDGE",e[e.CROP_CORNER=3]="CROP_CORNER",e[e.MOVE_CANVAS=4]="MOVE_CANVAS",e[e.STRAIGHTENING=5]="STRAIGHTENING",e[e.STRAIGHTENING_CONSTRAINED=6]="STRAIGHTENING_CONSTRAINED"}(Ko||(Ko={}));var qo=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n),(a=t.call(this,T.crop,e)).undostack=void 0,a.cropTool=void 0,a.toolLayerWidth=void 0,a.toolLayerHeight=void 0,a.initialToolLayerWidth=void 0,a.initialToolLayerHeight=void 0,a.stageZoomFactor=void 0,a.editorState=void 0,a.originalImageDimensions=void 0,a.currentAction=void 0,a.cropTool=new Xo(Object(d.a)(a)),a.toolLayerWidth=0,a.toolLayerHeight=0,a.stageZoomFactor=1,a.initialToolLayerWidth=0,a.initialToolLayerHeight=0;var r=a.doc.getImageData(),i=r.width,o=r.height;return a.originalImageDimensions=$e.e.fromValues(i,o),a.editorState={straightening:0,orientation:0,flipScaleXFactor:1,flipScaleYFactor:1,aspectRatio:0,aspectRatioKey:"custom",aspectRatioRotated:!1,cropShape:Gr.RECT,cropBoxDimensions:$e.e.create(),stageOffset:$e.e.create(),stageRotationRadian:0},a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Zo,{controller:this,imageAspectRatio:this.originalImageDimensions[0]/this.originalImageDimensions[1]}),e);var t=this.doc.getStage().getToolLayer();t&&this.cropTool.createView(t)}},{key:"destroyView",value:function(){this.cropTool.destroyView(),this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"startEditor",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"startEditor",this).call(this,e);var t,a=this.doc.getStage(),r=a.getToolLayer();r&&(this.toolLayerWidth=r.clientWidth,this.toolLayerHeight=r.clientHeight,this.initialToolLayerWidth=this.toolLayerWidth,this.initialToolLayerHeight=this.toolLayerHeight,a.setStageActionsVisible(!1),a.setTransformMode(Xe.CORE),this.stageZoomFactor=this.getMaximumStageZoomFactor(this.toolLayerWidth,this.toolLayerHeight),this.editorState=this.getInitialEditorState(),this.undostack=new ut(this.getEditorState(),100),this.updateStage(),this.cropTool.refresh(),null===(t=this.view)||void 0===t||t.refresh());this.doc.setHotKeysDisabled([Qn.PAN,Qn.ZOOM])}},{key:"endEditor",value:function(){Object(h.a)(Object(f.a)(n.prototype),"endEditor",this).call(this);var e=this.doc.getStage();e.setTransformMode(Xe.NORMAL),e.setStageActionsVisible(!0),this.doc.setHotKeysEnabled([Qn.PAN,Qn.ZOOM])}},{key:"hasUndoStack",value:function(){return!0}},{key:"canUndo",value:function(){var e,t;return null!==(e=null===(t=this.undostack)||void 0===t?void 0:t.canUndo())&&void 0!==e&&e}},{key:"canRedo",value:function(){var e,t;return null!==(e=null===(t=this.undostack)||void 0===t?void 0:t.canRedo())&&void 0!==e&&e}},{key:"undo",value:function(){var e;this.undostack&&(this.undostack.undo(),this.setEditorState(this.undostack.getCurrent())),this.doc.getDocActions().update(),null===(e=this.view)||void 0===e||e.refresh(),this.cropTool.refresh(),this.updateStage()}},{key:"redo",value:function(){var e;this.undostack&&(this.undostack.redo(),this.setEditorState(this.undostack.getCurrent())),this.doc.getDocActions().update(),null===(e=this.view)||void 0===e||e.refresh(),this.cropTool.refresh(),this.updateStage()}},{key:"isDirty",value:function(){return!Object(Ft.isEqual)(this.editorState,this.getInitialEditorState())}},{key:"reset",value:function(){var e;this.editorState=this.getInitialEditorState(),this.addUndoStep(),null===(e=this.view)||void 0===e||e.refresh(),this.cropTool.refresh(),this.updateStage()}},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty()){e.next=3;break}return this.cancel(),e.abrupt("return");case 3:if(!(t=this.getCroppedImageData())){e.next=10;break}return this.doc.getStage().setImageData(t),this.doc.getStage().setTransformMode(Xe.NORMAL),this.doc.getStage().centerContent(),e.next=10,this.doc.editorApply(t,Ze("CropView.InfoToast.Message","Your image was cropped"));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.doc.editorCancel()}},{key:"onPointerDown",value:function(e){if(0===e.button){var t=this.doc.getStage().eventToLocal(e),n=$e.e.fromValues(e.clientX,e.clientY),a=this.cropTool.checkHit(n),r=this.getCropBoxDetails(),i=this.getEditorState();if(a){var o;switch(this.currentAction={target:a,startPoint:t,startCropBoxOffset:r.offset,startCropBoxDimensions:r.dimensions,startStageOffset:i.stageOffset,startStageRotationRadian:i.stageRotationRadian,mode:Ko.NONE,pointerTrackingEnabled:!1},a){case Wo.TR:case Wo.TL:case Wo.BL:case Wo.BR:this.currentAction.mode=Ko.CROP_CORNER,this.currentAction.pointerTrackingEnabled=!0;break;case Wo.T:case Wo.L:case Wo.R:case Wo.B:this.currentAction.mode=Ko.CROP_EDGE,this.currentAction.pointerTrackingEnabled=!0;break;case Wo.BOX_INSIDE:case Wo.BOX_OUTSIDE:this.currentAction.mode=Ko.MOVE_CANVAS,this.currentAction.pointerTrackingEnabled=!0;break;default:this.currentAction.mode=Ko.NONE}this.cropTool.refresh(),null===(o=this.view)||void 0===o||o.refresh()}}}},{key:"onPointerMove",value:function(e){if(this.currentAction&&this.currentAction.pointerTrackingEnabled){var t=this.doc.getStage().eventToLocal(e),n=$e.e.fromValues(t[0]-this.currentAction.startPoint[0],t[1]-this.currentAction.startPoint[1]),a=e.shiftKey?this.currentAction.startCropBoxDimensions[0]/this.currentAction.startCropBoxDimensions[1]:this.editorState.aspectRatio;if(this.currentAction.mode===Ko.CROP_CORNER||this.currentAction.mode===Ko.CROP_EDGE){var r=[Wo.TR,Wo.R,Wo.BR].indexOf(this.currentAction.target)>-1,i=[Wo.BL,Wo.B,Wo.BR].indexOf(this.currentAction.target)>-1,o=[Wo.T,Wo.B].indexOf(this.currentAction.target)>-1,s=[Wo.L,Wo.R].indexOf(this.currentAction.target)>-1,l=r?-1:1,c=i?-1:1;o&&(n[0]=0),s&&(n[1]=0);var u=this.getCurrentEditorCenter(),d=this.getCropBoxDetails().offset,h=$e.e.create();e.shiftKey||"custom"!==this.editorState.aspectRatioKey?(this.currentAction.mode===Ko.CROP_CORNER&&(d[1]=this.currentAction.startCropBoxOffset[1]+n[1]*c,(h=this.getCropBoxDimensions(d,u))[0]=h[1]*a,h=this.constrainCropBoxMinMaxSize(h,a)),this.currentAction.mode===Ko.CROP_EDGE&&(o&&(d[1]=this.currentAction.startCropBoxOffset[1]+n[1]*c,(h=this.getCropBoxDimensions(d,u))[0]=h[1]*a,h=this.constrainCropBoxMinMaxSize(h,a)),s&&(d[0]=this.currentAction.startCropBoxOffset[0]+n[0]*l,(h=this.getCropBoxDimensions(d,u))[1]=h[0]/a,h=this.constrainCropBoxMinMaxSize(h,a)))):(d=$e.e.fromValues(this.currentAction.startCropBoxOffset[0]+n[0]*l,this.currentAction.startCropBoxOffset[1]+n[1]*c),h=this.getCropBoxDimensions(d,u),h=this.constrainCropBoxMinMaxSize(h,a)),e.altKey?(n[0]=0,n[1]=0):(o||(n[0]=(this.currentAction.startCropBoxDimensions[0]-h[0])/2*l),s||(n[1]=(this.currentAction.startCropBoxDimensions[1]-h[1])/2*c)),$e.e.copy(this.editorState.cropBoxDimensions,h)}else this.currentAction.mode===Ko.MOVE_CANVAS&&e.shiftKey&&(Math.abs(n[0])>Math.abs(n[1])?n[1]=0:n[0]=0);var f=this.currentAction.mode===Ko.MOVE_CANVAS?-1:1,p=$e.e.fromValues(this.currentAction.startStageOffset[0]-n[0]*f,this.currentAction.startStageOffset[1]-n[1]*f);$e.e.copy(this.editorState.stageOffset,p),this.updateStage(),this.cropTool.refresh()}}},{key:"onPointerUp",value:function(){var e;this.currentAction&&this.currentAction.pointerTrackingEnabled&&this.addUndoStep(),this.currentAction=void 0,null===(e=this.view)||void 0===e||e.refresh()}},{key:"onContainerSizeChanged",value:function(){this.doc.getStage().getToolLayer()&&this.cropTool.refresh()}},{key:"getEditorState",value:function(){return Object(Ft.cloneDeep)(this.editorState)}},{key:"setEditorState",value:function(e){this.editorState=Object(Ft.cloneDeep)(e)}},{key:"startStraightening",value:function(){var e=this.getCropBoxDetails();this.currentAction={mode:this.cropBoxInImage(e.offset,e.dimensions)?Ko.STRAIGHTENING_CONSTRAINED:Ko.STRAIGHTENING,pointerTrackingEnabled:!1,startCropBoxOffset:e.offset,startCropBoxDimensions:e.dimensions,startPoint:$e.e.create(),startStageOffset:$e.e.clone(this.editorState.stageOffset),startStageRotationRadian:0,target:Wo.BOX_OUTSIDE},this.cropTool.setIsStraighening(!0)}},{key:"endStraightening",value:function(){this.currentAction=void 0,this.cropTool.setIsStraighening(!1)}},{key:"setStraightening",value:function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.currentAction||this.startStraightening(),this.editorState.straightening=e;var r=this.getCurrentRadian();this.editorState.stageOffset=this.calculateRotatedStageOffset(r),this.editorState.stageRotationRadian=r,(null===(t=this.currentAction)||void 0===t?void 0:t.mode)===Ko.STRAIGHTENING_CONSTRAINED&&this.constrainCropBoxInImage(this.currentAction.startCropBoxDimensions,this.currentAction.startCropBoxOffset),a&&(this.endStraightening(),this.addUndoStep()),this.updateStage(),null===(n=this.view)||void 0===n||n.refresh(),this.cropTool.refresh()}},{key:"changeOrientation",value:function(e){var t;this.editorState.orientation+=e*this.editorState.flipScaleXFactor*this.editorState.flipScaleYFactor;var n=this.getCurrentRadian();this.calculateAspectRatioRotation(),this.editorState.stageOffset=this.calculateRotatedStageOffset(n),this.editorState.stageRotationRadian=n,this.addUndoStep(),this.updateStage(),null===(t=this.view)||void 0===t||t.refresh(),this.cropTool.refresh()}},{key:"rotateAspectRatio",value:function(){var e;this.calculateAspectRatioRotation(),this.addUndoStep(),null===(e=this.view)||void 0===e||e.refresh(),this.cropTool.refresh()}},{key:"flipHorizontally",value:function(){var e;this.editorState.flipScaleXFactor*=-1;var t=$e.e.ceil($e.e.create(),$e.e.fromValues(this.getCurrentEditorCenter()[0],this.editorState.stageOffset[1]));this.editorState.stageOffset=$e.e.round($e.e.create(),$e.e.rotate(this.editorState.stageOffset,this.editorState.stageOffset,t,$e.a.toRadian(180))),this.editorState.stageRotationRadian*=-1,this.addUndoStep(),this.updateStage(),null===(e=this.view)||void 0===e||e.refresh()}},{key:"flipVertically",value:function(){var e;this.editorState.flipScaleYFactor*=-1;var t=$e.e.fromValues(this.editorState.stageOffset[0],this.getCurrentEditorCenter()[1]);this.editorState.stageOffset=$e.e.round($e.e.create(),$e.e.rotate(this.editorState.stageOffset,this.editorState.stageOffset,t,$e.a.toRadian(180))),this.editorState.stageRotationRadian*=-1,this.addUndoStep(),this.updateStage(),null===(e=this.view)||void 0===e||e.refresh()}},{key:"setCropShape",value:function(e){var t;this.editorState.cropShape=e,this.addUndoStep(),this.cropTool.refresh(),null===(t=this.view)||void 0===t||t.refresh()}},{key:"changeAspectRatio",value:function(e,t){var n;if(0!==t){var a=null;a=$e.e.clone(this.editorState.cropBoxDimensions);var r=$e.e.create();t>a[0]/a[1]?(r[1]=a[0]/t,r[0]=a[0]):(r[0]=a[1]*t,r[1]=a[1]),r=this.constrainCropBoxMinMaxSize(r,t),this.editorState.cropBoxDimensions=r}this.editorState.aspectRatio=t,this.editorState.aspectRatioKey=e,this.addUndoStep(),null===(n=this.view)||void 0===n||n.refresh(),this.cropTool.refresh()}},{key:"getCurrentEditorCenter",value:function(){return $e.e.fromValues(this.toolLayerWidth/2,this.toolLayerHeight/2)}},{key:"getCropBoxDetails",value:function(){var e=this.getCurrentEditorCenter(),t=$e.e.clone(this.editorState.cropBoxDimensions);return{dimensions:t,offset:this.getCropBoxOffsetFromDimensions(t,e),editorCenter:e}}},{key:"getInitialEditorState",value:function(){var e=this.getScaledImageDimensions(),t=this.getCropBoxOffsetFromDimensions(e,this.getCurrentEditorCenter());return{straightening:0,orientation:0,flipScaleXFactor:1,flipScaleYFactor:1,aspectRatio:0,aspectRatioKey:"custom",aspectRatioRotated:!1,cropShape:Gr.RECT,cropBoxDimensions:$e.e.clone(e),stageOffset:$e.e.clone(t),stageRotationRadian:0}}},{key:"getMaximumStageZoomFactor",value:function(e,t){return this.floorDecimalNumber(Math.min(e,t)/Math.sqrt(Math.pow(this.originalImageDimensions[0],2)+Math.pow(this.originalImageDimensions[1],2))*.95,2)}},{key:"getScaledImageDimensions",value:function(){return $e.e.fromValues(this.roundDecimalNumber(this.originalImageDimensions[0]*this.stageZoomFactor,2),this.roundDecimalNumber(this.originalImageDimensions[1]*this.stageZoomFactor,2))}},{key:"getCropBoxDimensions",value:function(e,t){var n=$e.e.subtract($e.e.create(),t,e);return $e.e.round($e.e.create(),$e.e.scale(n,n,2))}},{key:"getCropBoxOffsetFromDimensions",value:function(e,t){var n=$e.e.fromValues(t[0]-e[0]/2,t[1]-e[1]/2);return $e.e.round(n,n)}},{key:"constrainCropBoxMinMaxSize",value:function(e,t){var n=$e.e.clone(e),a=Math.min(5e3*this.stageZoomFactor,this.toolLayerWidth),r=Math.min(5e3*this.stageZoomFactor,this.toolLayerHeight),i=n[0]/a,o=n[1]/r;(i>1||o>1)&&(n=0===t?$e.e.fromValues(Math.min(n[0],a),Math.min(n[1],r)):t<1?$e.e.scale(n,n,1/o):$e.e.scale(n,n,1/i));var s=Math.max(32*this.stageZoomFactor,32),l=n[0]/s,c=n[1]/s;return(l<1||c<1)&&(n=0===t?$e.e.fromValues(Math.max(n[0],s),Math.max(n[1],s)):t<1?$e.e.fromValues(s,s/t):$e.e.fromValues(s*t,s)),n}},{key:"calculateAspectRatioRotation",value:function(){var e=1/(this.editorState.cropBoxDimensions[0]/this.editorState.cropBoxDimensions[1]);this.editorState.cropBoxDimensions=$e.e.fromValues(this.editorState.cropBoxDimensions[1],this.editorState.cropBoxDimensions[0]),"custom"!==this.editorState.aspectRatioKey&&(this.editorState.aspectRatio=e)}},{key:"addUndoStep",value:function(){var e;null===(e=this.undostack)||void 0===e||e.add(this.getEditorState()),this.doc.getDocActions().update()}},{key:"calculateRotatedStageOffset",value:function(e){var t=$e.e.ceil($e.e.create(),this.getCurrentEditorCenter()),n=$e.e.clone(this.editorState.stageOffset);return n=$e.e.subtract(n,n,t),n=$e.e.rotate(n,n,$e.e.create(),e-this.editorState.stageRotationRadian),n=$e.e.add(n,n,t),$e.e.clone(n)}},{key:"constrainPointToStage",value:function(e,t,n){var a=this.pointToStage(e);return a[0]<2&&(a[0]=0),a[0]>t-2&&(a[0]=t),a[1]<2&&(a[1]=0),a[1]>n-2&&(a[1]=n),this.pointFromStage(a)}},{key:"testPointInStage",value:function(e,t,n){var a=this.pointToStage(e);return!(a[0]<-2)&&(!(a[0]>t+2)&&(!(a[1]<-2)&&!(a[1]>n+2)))}},{key:"cropBoxInImage",value:function(e,t){var n=this.originalImageDimensions[0],a=this.originalImageDimensions[1],r=$e.e.fromValues(e[0],e[1]),i=$e.e.fromValues(e[0]+t[0],e[1]),o=$e.e.fromValues(e[0]+t[0],e[1]+t[1]),s=$e.e.fromValues(e[0],e[1]+t[1]);return this.testPointInStage(r,n,a)&&this.testPointInStage(i,n,a)&&this.testPointInStage(o,n,a)&&this.testPointInStage(s,n,a)}},{key:"constrainCropBoxInImage",value:function(e,t){var n=this.originalImageDimensions[0],a=this.originalImageDimensions[1],r=$e.e.fromValues(t[0],t[1]),i=$e.e.fromValues(t[0]+e[0],t[1]),o=$e.e.fromValues(t[0]+e[0],t[1]+e[1]),s=$e.e.fromValues(t[0],t[1]+e[1]),l=this.constrainPointToStage(r,n,a);$e.e.copy(r,l),l=this.constrainPointToStage(i,n,a),$e.e.copy(i,l),l=this.constrainPointToStage(o,n,a),$e.e.copy(o,l),l=this.constrainPointToStage(s,n,a),$e.e.copy(s,l);var c=Math.max(r[0],s[0]),u=Math.max(r[1],i[1]),d=Math.min(i[0],o[0]),h=Math.min(s[1],o[1]),f=t[0]+e[0]/2,p=t[1]+e[1]/2,m=$e.e.fromValues(c,u),v=d-c,g=h-u,b=$e.e.fromValues(v,g),y=m[0]+b[0]/2-f,E=m[1]+b[1]/2-p;this.editorState.cropBoxDimensions[0]=b[0],this.editorState.cropBoxDimensions[1]=b[1],this.editorState.stageOffset[0]-=y,this.editorState.stageOffset[1]-=E}},{key:"pointRectDist",value:function(e,t,n){var a=Math.max(Math.min(e[0],t[0]+n[0]),t[0]),r=Math.max(Math.min(e[1],t[1]+n[1]),t[1]);return Math.sqrt((e[0]-a)*(e[0]-a)+(e[1]-r)*(e[1]-r))}},{key:"pointToStage",value:function(e){var t=this.calculateTransformMatrix();return $e.b.invert(t,t),$e.e.transformMat2d($e.e.create(),e,t)}},{key:"pointFromStage",value:function(e){var t=this.calculateTransformMatrix();return $e.e.transformMat2d($e.e.create(),e,t)}},{key:"calculateTransformMatrix",value:function(){var e=$e.b.create();return e=$e.b.translate(e,e,$e.e.round($e.e.create(),this.editorState.stageOffset)),e=$e.b.scale(e,e,$e.e.fromValues(this.stageZoomFactor*this.editorState.flipScaleXFactor,this.stageZoomFactor*this.editorState.flipScaleYFactor)),e=$e.b.rotate(e,e,this.editorState.stageRotationRadian*this.editorState.flipScaleXFactor*this.editorState.flipScaleYFactor)}},{key:"getCroppedImageData",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),n=this.getCropBoxDetails();e.width=Math.floor(n.dimensions[0]/this.stageZoomFactor),e.height=Math.floor(n.dimensions[1]/this.stageZoomFactor);var a=this.doc.getStage().getCanvas();if(t&&a){var r=$e.b.fromTranslation($e.b.create(),$e.e.fromValues(-n.offset[0],-n.offset[1])),i=$e.b.fromScaling($e.b.create(),$e.e.fromValues(1/this.stageZoomFactor,1/this.stageZoomFactor)),o=this.calculateTransformMatrix();switch($e.b.multiply(o,r,o),$e.b.multiply(o,i,o),t.save(),t.transform(o[0],o[1],o[2],o[3],o[4],o[5]),t.drawImage(a,0,0),t.restore(),this.editorState.cropShape){case Gr.RECT:break;case Gr.ELLIPSE:var s=e.width/2,l=e.height/2,c=s,u=l;t.globalAlpha=1,t.globalCompositeOperation="destination-in",t.beginPath(),t.ellipse(s,l,c,u,0,0,2*Math.PI,!1),t.fill();break;case Gr.HEART:case Gr.OCTAGON:case Gr.ROUNDED_RECT:case Gr.STAR:Go.applyShape(t,this.editorState.cropShape,Fo.KEEP,0,0,e.width,e.height)}return t.getImageData(0,0,e.width,e.height)}}},{key:"updateStage",value:function(){var e=this.calculateTransformMatrix();this.doc.getStage().setTransformMatrix(e),this.doc.getStage().updateTransform()}},{key:"getCurrentRadian",value:function(){return $e.a.toRadian((this.editorState.orientation+this.editorState.straightening)*this.editorState.flipScaleXFactor*this.editorState.flipScaleYFactor)}},{key:"roundDecimalNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}},{key:"floorDecimalNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;return Math.floor(e*Math.pow(10,t))/Math.pow(10,t)}}]),n}(U),Jo=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Qo=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function $o(e,t,n,a){if(Number.isNaN(a)||a<1)return e;var r,i,o,s,l,c,u,d,h,f,p,m,v,g,b,y,E,w,x,k,S=new ImageData(new Uint8ClampedArray(e.data),e.width,e.height),C=S.data,O=a+a+1,P=t-1,T=n-1,M=a+1,I=M*(M+1)/2,A=new es,R=A;for(o=1;o<O;o++)if(R=R.next=new es,o===M)var D=R;R.next=A;var j=null,_=null;u=c=0;var L=Jo[a],N=Qo[a];for(i=0;i<n;i++){for(g=b=y=d=h=f=0,p=M*(E=C[c]),m=M*(w=C[c+1]),v=M*(x=C[c+2]),d+=I*E,h+=I*w,f+=I*x,R=A,o=0;o<M;o++)R.r=E,R.g=w,R.b=x,R=R.next;for(o=1;o<M;o++)s=c+((P<o?P:o)<<2),d+=(R.r=E=C[s])*(k=M-o),h+=(R.g=w=C[s+1])*k,f+=(R.b=x=C[s+2])*k,g+=E,b+=w,y+=x,R=R.next;for(j=A,_=D,r=0;r<t;r++)C[c]=d*L>>N,C[c+1]=h*L>>N,C[c+2]=f*L>>N,d-=p,h-=m,f-=v,p-=j.r,m-=j.g,v-=j.b,s=u+((s=r+a+1)<P?s:P)<<2,d+=g+=j.r=C[s],h+=b+=j.g=C[s+1],f+=y+=j.b=C[s+2],j=j.next,p+=E=_.r,m+=w=_.g,v+=x=_.b,g-=E,b-=w,y-=x,_=_.next,c+=4;u+=t}for(r=0;r<t;r++){for(b=y=g=h=f=d=0,p=M*(E=C[c=r<<2]),m=M*(w=C[c+1]),v=M*(x=C[c+2]),d+=I*E,h+=I*w,f+=I*x,R=A,o=0;o<M;o++)R.r=E,R.g=w,R.b=x,R=R.next;for(l=t,o=1;o<=a;o++)c=l+r<<2,d+=(R.r=E=C[c])*(k=M-o),h+=(R.g=w=C[c+1])*k,f+=(R.b=x=C[c+2])*k,g+=E,b+=w,y+=x,R=R.next,o<T&&(l+=t);for(c=r,j=A,_=D,i=0;i<n;i++)C[s=c<<2]=d*L>>N,C[s+1]=h*L>>N,C[s+2]=f*L>>N,d-=p,h-=m,f-=v,p-=j.r,m-=j.g,v-=j.b,s=r+((s=i+M)<T?s:T)*t<<2,d+=g+=j.r=C[s],h+=b+=j.g=C[s+1],f+=y+=j.b=C[s+2],j=j.next,p+=E=_.r,m+=w=_.g,v+=x=_.b,g-=E,b-=w,y-=x,_=_.next,c+=t}return S}function es(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var ts=n(197),ns=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a){var r;return Object(c.a)(this,n),(r=t.call(this,a)).status=void 0,r.status=e,r}return Object(u.a)(n,null,[{key:"fromResponse",value:function(e){return new n(e.status,e.statusText)}}]),n}(Object(ts.a)(Error)),as=function(){function e(t){Object(c.a)(this,e),this.imsToken=void 0,this.imsToken=t}return Object(u.a)(e,[{key:"createOrUpdateResource",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return e.next=4,fetch("".concat("https://cc-api-storage-creativesdk.adobe.io").concat(t),{method:"PUT",headers:{"x-api-key":"FrictionlessPSWebApp1",authorization:this.imsToken,"content-type":n},body:a});case 4:if(201===(r=e.sent).status){e.next=7;break}throw ns.fromResponse(r);case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"getResource",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return e.next=4,fetch("".concat("https://cc-api-storage-creativesdk.adobe.io").concat(t),{method:"GET",headers:{"x-api-key":"FrictionlessPSWebApp1",authorization:this.imsToken}});case 4:if(200===(n=e.sent).status){e.next=7;break}throw ns.fromResponse(n);case 7:return e.abrupt("return",n.blob());case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),rs=function(){function e(t){Object(c.a)(this,e),this.imsToken=void 0,this.cancelled=void 0,this.storageService=void 0,this.imsToken=t,this.cancelled=!1,this.storageService=new as(t)}return Object(u.a)(e,[{key:"createMask",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.create("mask",t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createCutout",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.create("cutout",t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.cancelled=!0}},{key:"isCancelled",value:function(){return this.cancelled}},{key:"create",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r,i,o,l,c,u,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=V()(),o="/temp/cutout_upload_".concat(i),l="/temp/cutout_result_".concat(i),this.cancelled=!1,a&&a(Ze("CutoutService.ProgressState.Upload","Upload"),0),e.next=7,this.uploadInput(n,o);case 7:if(!this.cancelled){e.next=9;break}return e.abrupt("return",Promise.resolve(null));case 9:return a&&a(Ze("CutoutService.ProgressState.Process","Process"),25),e.next=12,this.startJob(t,o,l);case 12:if(c=e.sent,!this.cancelled){e.next=15;break}return e.abrupt("return",Promise.resolve(null));case 15:return e.next=17,this.checkJobFinished(c._links.self.href,a);case 17:if(u=e.sent,console.debug(u),u){e.next=21;break}return e.abrupt("return",Promise.resolve(null));case 21:if(!this.cancelled){e.next=23;break}return e.abrupt("return",Promise.resolve(null));case 23:if("succeeded"!==u.status){e.next=34;break}return a&&a(Ze("CutoutService.ProgressState.Download","Download"),75),e.next=27,this.downloadOutput(l);case 27:return d=e.sent,e.next=30,this.wait(100);case 30:if(!this.cancelled){e.next=32;break}return e.abrupt("return",Promise.resolve(null));case 32:return a&&a(Ze("CutoutService.ProgressState.Done","Done"),100),e.abrupt("return",this.cancelled?Promise.resolve(null):Promise.resolve(d));case 34:throw console.error((null===(r=u.errors)||void 0===r?void 0:r.reason)||"Unknown error"),new Error("Job failed");case 36:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"startJob",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:console.debug("startJob",n,a),r=0,i=3;case 5:if(!(r<i)){e.next=20;break}return e.next=8,fetch("".concat("https://image.adobe.io","/sensei/").concat(t),{method:"POST",headers:{"x-api-key":"FrictionlessPSWebApp1",authorization:this.imsToken,"content-type":"application/json"},body:JSON.stringify({input:{storage:"adobe",href:n},output:{storage:"adobe",href:a,mask:{format:"soft"}}})});case 8:if(202===(o=e.sent).status){e.next=17;break}if((r+=1)!==i){e.next=13;break}throw new Error(o.statusText);case 13:return e.next=15,this.wait(200*r);case 15:e.next=18;break;case 17:return e.abrupt("return",o.json());case 18:e.next=5;break;case 20:throw new Error("unspecified error");case 21:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"getJobStatus",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return console.debug("getJobStatus",t),e.next=5,fetch(t,{method:"GET",headers:{"x-api-key":"FrictionlessPSWebApp1",authorization:this.imsToken}});case 5:if(200===(n=e.sent).status){e.next=8;break}throw new Error(n.statusText);case 8:return e.abrupt("return",n.json());case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkJobFinished",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cancelled){e.next=2;break}return e.abrupt("return",Promise.resolve(null));case 2:return e.next=4,this.getJobStatus(t);case 4:if("running"!==(a=e.sent).status&&"pending"!==a.status){e.next=10;break}return n&&n("running"===a.status?Ze("CutoutService.ProgressState.Running","Running"):Ze("CutoutService.ProgressState.Pending","Pending"),30),e.next=9,this.wait(1e3);case 9:return e.abrupt("return",this.checkJobFinished(a._links.self.href));case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"uploadInput",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("updloadInput",n),e.next=3,M.createBlob(t,"image/jpeg",.75);case 3:return a=e.sent,e.abrupt("return",this.storageService.createOrUpdateResource(n,"image/jpeg",a));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"downloadOutput",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("downloadOutput",t),e.next=3,this.storageService.getResource(t);case 3:return n=e.sent,e.abrupt("return",M.createImageData(n));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"wait",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),e}(),is=(n(530),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.message;return g.a.createElement(fe.a,{title:Ze("SigninDialog.Title","Sign In Required"),cancelLabel:Ze("SigninDialog.Button.Cancel","Cancel"),confirmLabel:Ze("SigninDialog.Button.Signin","Sign In"),onConfirm:function(){return t.signin()},onCancel:function(){return t.close()},disableEscKey:!1},g.a.createElement("span",null,n))}}]),n}(v.PureComponent)),os=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a,r){var i;return Object(c.a)(this,n),(i=t.call(this)).dialogId=void 0,i.message=void 0,i.targetSigninEditor=void 0,i.onCancel=void 0,i.message=e,i.targetSigninEditor=a,i.onCancel=r,i}return Object(u.a)(n,[{key:"show",value:function(){this.dialogId=j.a.show(g.a.createElement(is,{controller:this,message:this.message}))}},{key:"close",value:function(){this.dialogId&&(j.a.hide(this.dialogId),this.onCancel&&this.onCancel())}},{key:"signin",value:function(){P.getInstance().loginUser(this.targetSigninEditor)}}]),n}(F),ss=(n(531),n(45)),ls=n(85),cs=n.n(ls),us=n(55),ds=n.n(us);function hs(){return(hs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function fs(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ps=g.a.createElement("g",{id:"Group_151830","data-name":"Group 151830"},g.a.createElement("g",{id:"Group_151828","data-name":"Group 151828"},g.a.createElement("path",{id:"Path_60995","data-name":"Path 60995",d:"M5.629,13.482a.241.241,0,0,1-.324-.1L4.723,12.3c.088-.047.177-.093.266-.138-.037-.091-.073-.183-.107-.276l1.151-.427a.242.242,0,0,1,.309.14c.083.207.174.41.27.607l.229.468a.244.244,0,0,1-.127.333l-.482.2C6.03,13.29,5.828,13.382,5.629,13.482Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),g.a.createElement("path",{id:"Path_60996","data-name":"Path 60996",d:"M4.594,9.748a.248.248,0,0,1-.281-.212c-.028-.238-.049-.477-.06-.713v-.14c0-.294.012-.578.037-.856a.244.244,0,0,1,.272-.218l.974.113a.241.241,0,0,1,.212.262c-.02.225-.029.453-.029.682v.1c.008.18.025.372.047.565A.244.244,0,0,1,5.56,9.6ZM17.41,9.724l-.967-.138a.244.244,0,0,1-.206-.271c.022-.189.038-.378.047-.564v-.1c0-.225-.01-.458-.03-.688a.241.241,0,0,1,.212-.263l.971-.113a.246.246,0,0,1,.275.22c.025.283.038.571.038.862v.137c-.012.241-.032.475-.059.706a.247.247,0,0,1-.281.212ZM5.99,5.9l-.908-.366A.247.247,0,0,1,4.947,5.2a7.151,7.151,0,0,1,.888-1.5.247.247,0,0,1,.352-.034l.751.628a.24.24,0,0,1,.033.333A5.694,5.694,0,0,0,6.3,5.767a.242.242,0,0,1-.31.133Zm9.71-.154a5.582,5.582,0,0,0-.664-1.113.24.24,0,0,1,.029-.33l.928-.817.018.02a7.07,7.07,0,0,1,1.04,1.674.248.248,0,0,1-.134.327l-.908.368a.242.242,0,0,1-.309-.129ZM8.34,3.117l-.487-.846a.249.249,0,0,1,.1-.342,6.374,6.374,0,0,1,1.666-.593.248.248,0,0,1,.291.2l.161.963a.244.244,0,0,1-.193.278,4.906,4.906,0,0,0-1.208.429A.244.244,0,0,1,8.34,3.117Zm4.981.085a4.941,4.941,0,0,0-1.212-.425.244.244,0,0,1-.194-.277l.158-.964a.248.248,0,0,1,.291-.2,6.415,6.415,0,0,1,1.667.586.247.247,0,0,1,.1.341l-.482.849a.244.244,0,0,1-.328.088Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),g.a.createElement("path",{id:"Path_60997","data-name":"Path 60997",d:"M16.7,13.38a.242.242,0,0,1-.324.1q-.3-.15-.6-.275l-.482-.2a.244.244,0,0,1-.127-.333L15.4,12.2c.1-.2.187-.4.27-.607a.242.242,0,0,1,.309-.14l1.151.426c-.034.093-.07.186-.107.278.089.044.178.09.266.137Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),g.a.createElement("path",{id:"Path_60998","data-name":"Path 60998",d:"M.3,19.673a3.687,3.687,0,0,1-.05-.583c0-.068,0-.136.006-.2l.007-.1a8.313,8.313,0,0,1,.2-1.2.246.246,0,0,1,.306-.176l.941.262a.241.241,0,0,1,.169.292,6.9,6.9,0,0,0-.154.945v.177a2.149,2.149,0,0,0,.028.348Zm21.412-.04-1.449-.219a2.178,2.178,0,0,0,.024-.324c0-.039,0-.079,0-.119l-.006-.075a6.785,6.785,0,0,0-.16-.961.241.241,0,0,1,.169-.292l.94-.265a.247.247,0,0,1,.307.175,8.409,8.409,0,0,1,.2,1.221l.008.1c0,.081.006.147.006.212a3.666,3.666,0,0,1-.047.547ZM2.476,15.946l-.827-.524a.248.248,0,0,1-.074-.345A8.212,8.212,0,0,1,2.7,13.755a.247.247,0,0,1,.352.017l.654.728a.242.242,0,0,1-.016.337A6.762,6.762,0,0,0,2.8,15.876a.24.24,0,0,1-.327.07Zm16.7-.1a6.763,6.763,0,0,0-.891-1.035.242.242,0,0,1-.018-.338l.651-.731a.248.248,0,0,1,.352-.017,8.218,8.218,0,0,1,1.133,1.318.248.248,0,0,1-.074.345l-.824.527a.241.241,0,0,1-.329-.069Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"})),g.a.createElement("g",{id:"Group_151829","data-name":"Group 151829"},g.a.createElement("path",{id:"Path_60999","data-name":"Path 60999",d:"M5.629,13.482a.241.241,0,0,1-.324-.1L4.723,12.3c.088-.047.177-.093.266-.138-.037-.091-.073-.183-.107-.276l1.151-.427a.242.242,0,0,1,.309.14c.083.207.174.41.27.607l.229.468a.244.244,0,0,1-.127.333l-.482.2C6.03,13.29,5.828,13.382,5.629,13.482Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),g.a.createElement("path",{id:"Path_61000","data-name":"Path 61000",d:"M4.594,9.748a.248.248,0,0,1-.281-.212c-.028-.238-.049-.477-.06-.713v-.14c0-.294.012-.578.037-.856a.244.244,0,0,1,.272-.218l.974.113a.241.241,0,0,1,.212.262c-.02.225-.029.453-.029.682v.1c.008.18.025.372.047.565A.244.244,0,0,1,5.56,9.6ZM17.41,9.724l-.967-.138a.244.244,0,0,1-.206-.271c.022-.189.038-.378.047-.564v-.1c0-.225-.01-.458-.03-.688a.241.241,0,0,1,.212-.263l.971-.113a.246.246,0,0,1,.275.22c.025.283.038.571.038.862v.137c-.012.241-.032.475-.059.706a.247.247,0,0,1-.281.212ZM5.99,5.9l-.908-.366A.247.247,0,0,1,4.947,5.2a7.151,7.151,0,0,1,.888-1.5.247.247,0,0,1,.352-.034l.751.628a.24.24,0,0,1,.033.333A5.694,5.694,0,0,0,6.3,5.767a.242.242,0,0,1-.31.133Zm9.71-.154a5.582,5.582,0,0,0-.664-1.113.24.24,0,0,1,.029-.33l.928-.817.018.02a7.07,7.07,0,0,1,1.04,1.674.248.248,0,0,1-.134.327l-.908.368a.242.242,0,0,1-.309-.129ZM8.34,3.117l-.487-.846a.249.249,0,0,1,.1-.342,6.374,6.374,0,0,1,1.666-.593.248.248,0,0,1,.291.2l.161.963a.244.244,0,0,1-.193.278,4.906,4.906,0,0,0-1.208.429A.244.244,0,0,1,8.34,3.117Zm4.981.085a4.941,4.941,0,0,0-1.212-.425.244.244,0,0,1-.194-.277l.158-.964a.248.248,0,0,1,.291-.2,6.415,6.415,0,0,1,1.667.586.247.247,0,0,1,.1.341l-.482.849a.244.244,0,0,1-.328.088Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),g.a.createElement("path",{id:"Path_61001","data-name":"Path 61001",d:"M16.7,13.38a.242.242,0,0,1-.324.1q-.3-.15-.6-.275l-.482-.2a.244.244,0,0,1-.127-.333L15.4,12.2c.1-.2.187-.4.27-.607a.242.242,0,0,1,.309-.14l1.151.426c-.034.093-.07.186-.107.278.089.044.178.09.266.137Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),g.a.createElement("path",{id:"Path_61002","data-name":"Path 61002",d:"M.3,19.673a3.687,3.687,0,0,1-.05-.583c0-.068,0-.136.006-.2l.007-.1a8.313,8.313,0,0,1,.2-1.2.246.246,0,0,1,.306-.176l.941.262a.241.241,0,0,1,.169.292,6.9,6.9,0,0,0-.154.945v.177a2.149,2.149,0,0,0,.028.348Zm21.412-.04-1.449-.219a2.178,2.178,0,0,0,.024-.324c0-.039,0-.079,0-.119l-.006-.075a6.785,6.785,0,0,0-.16-.961.241.241,0,0,1,.169-.292l.94-.265a.247.247,0,0,1,.307.175,8.409,8.409,0,0,1,.2,1.221l.008.1c0,.081.006.147.006.212a3.666,3.666,0,0,1-.047.547ZM2.476,15.946l-.827-.524a.248.248,0,0,1-.074-.345A8.212,8.212,0,0,1,2.7,13.755a.247.247,0,0,1,.352.017l.654.728a.242.242,0,0,1-.016.337A6.762,6.762,0,0,0,2.8,15.876a.24.24,0,0,1-.327.07Zm16.7-.1a6.763,6.763,0,0,0-.891-1.035.242.242,0,0,1-.018-.338l.651-.731a.248.248,0,0,1,.352-.017,8.218,8.218,0,0,1,1.133,1.318.248.248,0,0,1-.074.345l-.824.527a.241.241,0,0,1-.329-.069Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}))),ms=g.a.createElement("path",{id:"Path_61003","data-name":"Path 61003",d:"M18.264,19.777a.49.49,0,0,0,.353-.151.483.483,0,0,0,.132-.361c-.321-3.489-3.9-4.679-4.993-4.774-.8-.07-.813-.713-.813-1.516a7.31,7.31,0,0,0,1.716-4.352c0-2.636-1.5-4.393-3.658-4.393S7.342,5.987,7.342,8.623a7.3,7.3,0,0,0,1.716,4.352c0,.8-.013,1.446-.814,1.516-1.094.1-4.671,1.285-4.993,4.774a.486.486,0,0,0,.484.512Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),vs=function(e){var t=e.svgRef,n=e.title,a=fs(e,["svgRef","title"]);return g.a.createElement("svg",hs({id:"mockups_exploration","data-name":"mockups / exploration",width:21,height:18,viewBox:"0 0 21 18",ref:t},a),n?g.a.createElement("title",null,n):null,ps,ms)},gs=g.a.forwardRef((function(e,t){return g.a.createElement(vs,hs({svgRef:t},e))})),bs=(n.p,n(189)),ys=n.n(bs),Es=n(190),ws=n.n(Es),xs=(n(541),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n),a=t.call(this,e);var r=ds()(e.startColorCode||"ff0000").toHsv();return a.state={hexColorHue:e.startColorCode||"ff0000",hexColor:e.startColorCode||"ff0000",h:r.h,s:100*r.s,v:100*r.v},a.handleHueChange=a.handleHueChange.bind(Object(d.a)(a)),a.handleHSVChange=a.handleHSVChange.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"handleHueChange",value:function(e,t){var n=this.state,a=n.s,r=n.v,i=ds.a.fromRatio({h:t/360,s:a/100,v:r/100,a:1}).toHex();this.setState({hexColorHue:e,h:t,hexColor:i}),this.props.onColorChange(i)}},{key:"handleHSVChange",value:function(e,t){var n=this.state.h,a=ds.a.fromRatio({h:n/360,s:e/100,v:t/100}).toHex();this.setState({s:e,v:t,hexColor:a}),this.props.onColorChange(a)}},{key:"render",value:function(){var e=this,t=this.state,n=t.hexColorHue,a=t.hexColor,r=t.h,i=t.s,o=t.v;return g.a.createElement("div",{className:"cp-container"},g.a.createElement("span",{className:"cp-area"},g.a.createElement(ys.a,{hsvHue:r,hsvSaturation:i,hsvValue:o,onChange:function(t,n){e.handleHSVChange(t,n)}})),g.a.createElement(ws.a,{orientation:"vertical",colorValue:n,variant:"h",onChange:function(t,n){e.handleHueChange(t,n)}}),this.props.debug&&g.a.createElement("div",null,"Hex ColorCode Hue: ",n,g.a.createElement("br",null),"HSV Hue Value: ",r,g.a.createElement("br",null),"HSV Saturation Value: ",i,g.a.createElement("br",null),"HSV Lightning / V Value: ",o,g.a.createElement("br",null),g.a.createElement("br",null),"Final Hex ColorCode: ",a))}}]),n}(v.PureComponent)),ks=n(119),Ss=n.n(ks),Cs=(n(546),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setProgress",value:function(e,t){this.setState({label:e,value:t})}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.title,a=e.confirmLabel,r=e.isIndeterminate,i=this.state,o=i.label,s=i.value;return g.a.createElement(fe.a,{open:!0,title:n,onConfirm:function(){return t.cancel()},confirmLabel:a||Ze("ProgressDialog.Label.Cancel","Cancel"),role:"dialog"},r?g.a.createElement(Ss.a,{label:o,isIndeterminate:!0,labelPosition:"top"}):g.a.createElement(Ss.a,{label:o,value:s,labelPosition:"top",showPercent:!0}))}}]),n}(v.PureComponent)),Os=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a,r,i){var o;return Object(c.a)(this,n),(o=t.call(this)).dialogId=void 0,o.title=void 0,o.confirmLabel=void 0,o.onCancel=void 0,o.isIndeterminate=void 0,o.title=e,o.confirmLabel=r,o.onCancel=a,o.isIndeterminate=i,o}return Object(u.a)(n,[{key:"show",value:function(){this.dialogId=j.a.show(g.a.createElement(Cs,{controller:this,title:this.title,confirmLabel:this.confirmLabel,isIndeterminate:this.isIndeterminate}))}},{key:"close",value:function(){this.dialogId&&j.a.hide(this.dialogId)}},{key:"cancel",value:function(){this.onCancel&&this.onCancel(),this.close()}},{key:"setProgress",value:function(e,t){var n;null===(n=this.getProgressView())||void 0===n||n.setProgress(e,t)}},{key:"getProgressView",value:function(){return this.view}}]),n}(F),Ps=(n(547),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).progressDialogRef=void 0,a.loginDialogId=void 0,a.colorList=["transparent","#000000","#FFFFFF","#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#D4C4FB","multi"],a.state={params:e.controller.getParams()},a.loginDialogId=0,a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),this.initEditorView()}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setParams",value:function(e){this.setState({params:e});var t,n=e.autoCutoutProgress;n&&(null===(t=this.progressDialogRef)||void 0===t||t.setProgress(n.state,n.percentage))}},{key:"refresh",value:function(){}},{key:"initEditorView",value:function(){var e,t=K.getParams(),n=sessionStorage.getItem("fps_cutout_color_return")||(null===(e=t.cutout)||void 0===e?void 0:e.bgColor),a=!1;if(n){var r;sessionStorage.removeItem("fps_cutout_color_return");var i=!1;(null===(r=t.cutout)||void 0===r?void 0:r.bgColor)&&(t.cutout.bgColor=void 0,K.setParams(t),i=!0),(P.getInstance().isSignedInUser()||i)&&(a=!0,this.process(n))}else{var o,s=sessionStorage.getItem("fps_cutout_blur_return")||(null===(o=t.cutout)||void 0===o?void 0:o.blurRadius);if(s){var l;sessionStorage.removeItem("fps_cutout_blur_return");var c=!1;(null===(l=t.cutout)||void 0===l?void 0:l.blurRadius)&&(t.cutout.blurRadius=void 0,K.setParams(t),c=!0),(P.getInstance().isSignedInUser()||c)&&(a=!0,this.process(void 0,parseInt(s,10)))}}!a&&P.getInstance().isSignedInUser()&&this.applyBackgroundColor("transparent")}},{key:"process",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a,r,i,o,l,c,u=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props.controller,(r=t)&&!Ts.includes(r)&&(i=ds()(r)).isValid()&&(r=i.toHexString().toUpperCase()),null===a||void 0===a?void 0:a.isProcessing()){e.next=18;break}return o=!1,this.progressDialogRef||(O.isEnOrRunningInLocEnv()?this.progressDialogRef=new Os(r&&r.startsWith("#")?Ze("CutoutView.ProgressDialog.Title.ReplaceBackground","Replace background"):Ze("CutoutView.ProgressDialog.Title.RemoveBackground","Remove background"),(function(){o=!0,null===a||void 0===a||a.cancelAutoCutout(),u.progressDialogRef=void 0})):this.progressDialogRef=new Os(r&&r.startsWith("#")?Ze("CutoutView.ProgressDialog.Title.ReplaceBG","Auto-replace background"):Ze("CutoutView.ProgressDialog.Title.RemoveBG","Auto-remove background"),(function(){o=!0,null===a||void 0===a||a.cancelAutoCutout(),u.progressDialogRef=void 0}))),this.progressDialogRef.show(),e.prev=7,e.next=10,null===a||void 0===a?void 0:a.autoCutout(r,n);case 10:e.next=17;break;case 12:e.prev=12,e.t0=e.catch(7),console.error(e.t0),l=Ze("CutoutView.ModalDialog.Error.GenericErrorMessage","An error occured"),j.a.show(g.a.createElement(fe.a,{title:Ze("CutoutView.ModalDialog.Error.Title","Error"),variant:"error",confirmLabel:Ze("CutoutView.ModalDialog.Error.Confirm","OK"),role:"dialog",onClose:function(){return null===a||void 0===a?void 0:a.cancelAutoCutout()}},g.a.createElement("span",null,l)));case 17:o||(null===(c=this.progressDialogRef)||void 0===c||c.close(),this.progressDialogRef=void 0);case 18:return e.abrupt("return",Promise.resolve());case 19:case"end":return e.stop()}}),e,this,[[7,12]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"applyBackgroundColor",value:function(e){var t=this.props.controller;this.state.params.hasMask?t.applyBackgroundColor(e):this.process(e)}},{key:"applyBackgroundBlur",value:function(e,t){var n=this.props.controller;this.state.params.hasMask?n.applyBlurredBackground(e,t):this.process(void 0,e)}},{key:"applyChanges",value:function(){var e,t=this.props.controller,n=this.state.params;(null===t||void 0===t?void 0:t.isDirty())&&(t.apply(),e="transparent"===n.backgroundColor?Ze("CutoutView.InfoToast.Message.BGRemoved","The background of your image was removed"):void 0!==n.blurRadius?Ze("CutoutView.InfoToast.Message.BGRemoved","The background of your image was blured"):Ze("CutoutView.InfoToast.Message.BGReplaced","The background of your image was replaced"),Object(E.info)(e,{timeout:3e3}))}},{key:"renderColorRow",value:function(e,t){var n=this,a=this.state.params,r=void 0!==a.blurRadius,i=a.backgroundColor&&"string"===typeof a.backgroundColor&&a.backgroundColor.startsWith("#")?a.backgroundColor:"ff0000";return t.map((function(t){return"multi"===t?g.a.createElement(je.a,{trigger:"click",placement:"top"},g.a.createElement("div",{id:"color-picker-container",className:"multicolor-box bg-box ".concat(r||!a.backgroundColor||"string"!==typeof a.backgroundColor||n.colorList.includes(a.backgroundColor)?"":"selected"),key:"".concat(t,"-bg")}),g.a.createElement(cs.a,{variant:"default",style:{minWidth:"0px",padding:"0"}},g.a.createElement(xs,{startColorCode:i,onColorChange:function(e){return n.applyBackgroundColor("#".concat(e.toUpperCase()))}}))):g.a.createElement("div",{className:"bg-box ".concat("transparent"===t?"bg-box bg-box-transparent":""," ").concat(r||a.backgroundColor!==t?"":"selected"),key:"".concat(t,"-bg"),onClick:function(){return n.applyBackgroundColor(t)},role:"presentation",style:Object(X.a)({},"transparent"!==t?{background:t}:{})},g.a.createElement("div",{className:e?"grid-box grid-box-bg-image":"grid-box",key:"".concat(t,"-bg-img"),style:Object(X.a)({},e?{backgroundImage:"url('".concat(e,"')")}:{})}))}))}},{key:"renderGridColorRows",value:function(){for(var e=this.props.controller,t=null===e||void 0===e?void 0:e.getAppliedMaskDataUrl150(),n=[],a=0;a<this.colorList.length;a+=3)n.push(g.a.createElement(ss.GridRow,{key:"colorrow_".concat(a),align:"left",valign:"top",distribution:"between",className:"grid-row"},this.renderColorRow(t,this.colorList.slice(a,a+3))));return n}},{key:"renderBlurPresetRow",value:function(e){var t=this,n=this.props.controller,a=null===n||void 0===n?void 0:n.getAppliedMaskDataUrl150(),r=null===n||void 0===n?void 0:n.getOriginalImageDataUrl150(),i=this.state.params;return e.map((function(e){return g.a.createElement("div",{key:"".concat(e,"-blur-bg-mask"),className:"grid-box bg-box blur-box ".concat(e===i.blurRadius?"selected":""),role:"presentation",onClick:function(){t.applyBackgroundBlur(e,e!==i.blurRadius)}},g.a.createElement("img",{src:r,alt:"blur preset",className:"grid-box-blur-image",style:{filter:"blur(".concat(e/10,"px)")}}),g.a.createElement("img",{className:"grid-box-blur-image",src:a,alt:"blur preset"}))}))}},{key:"render",value:function(){var e=this,t=this.props.controller,n=this.state.params,a=void 0!==n.blurRadius,r=void 0!==n.backgroundColor,i=a||r;return g.a.createElement("div",{className:"editor-panel"},g.a.createElement("div",{className:"settings-right cutout-settings-right"},g.a.createElement("div",{className:"settings-scrolling-content"},g.a.createElement("div",{className:"settings-header"},g.a.createElement("div",{className:"title"},Ze("CutoutView.Title.RemoveBackground","Remove background")),g.a.createElement("div",{className:"reset-button"},g.a.createElement(xe.a,{quiet:!0,variant:"action",onClick:function(){t.reset()},icon:g.a.createElement(na.a,null),disabled:!t.isDirty()},Ze("CutoutView.Button.Reset","Reset")))),g.a.createElement("div",{className:"editor-button-bar"},n.hasMask?g.a.createElement("div",null,g.a.createElement(Se.a,{label:Ze("CutoutView.Settings.Label.BGBlur","Blur background"),className:"sectionless-fieldlabel",labelFor:"__"},g.a.createElement(ss.Grid,{style:{marginTop:"15px"}},g.a.createElement(ss.GridRow,{align:"left",valign:"top",distribution:"between",className:"grid-row"},this.renderBlurPresetRow([0,50,100]))),g.a.createElement("section",{style:{marginBottom:"0.5rem"}},g.a.createElement(Be.a,{renderLabel:!0,label:Ze("AdjustView.Controls.Slider.Amount","Amount"),filled:!0,fillOffset:0,min:0,max:100,value:n.blurRadius||0,onChange:function(t){e.applyBackgroundBlur(t,!1)},onChangeEnd:function(t){return e.applyBackgroundBlur(t,!0)},className:a?"blur-slider":"blur-slider hidden"}))),g.a.createElement(Se.a,{label:Ze("CutoutView.Settings.Label.BGColor","Replace background"),className:"sectionless-fieldlabel",labelFor:"__"},g.a.createElement(ss.Grid,{style:{marginTop:"15px"}},this.renderGridColorRows()))):g.a.createElement("section",null,g.a.createElement(xe.a,{variant:"action",onClick:function(){e.applyBackgroundColor("transparent")},icon:g.a.createElement(ar,{icon:g.a.createElement(gs,null),size:"S"})},O.isEnOrRunningInLocEnv()?Ze("CutoutView.Settings.Button.RemoveBackground","Remove background"):Ze("CutoutView.Settings.Button.AutoRemove","Auto-remove background"))))),g.a.createElement("div",{className:"action-button-container"},g.a.createElement(xe.a,{onClick:function(){ie("cutoutCancel"),t.cancel()}},Ze("CutoutView.Button.Cancel.RemoveBackground","Cancel")),g.a.createElement(xe.a,{quiet:!0,variant:"cta",onClick:function(){ie("cutout"),e.applyChanges()},disabled:!i},Ze("CutoutView.Button.Apply.RemoveBackground","Apply")))))}}]),n}(v.PureComponent)),Ts=["transparent","multi"],Ms=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,T.cutout,e)).undostack=void 0,a.cutoutService=void 0,a.autoCutoutProgress=void 0,a.backgroundColor=void 0,a.blurCanvas=void 0,a.appliedMaskDataUrl150=void 0,a.originalImageDataUrl150=void 0,a.blurRadius=void 0,a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Ps,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"isDirty",value:function(){return this.canUndo()}},{key:"startEditor",value:function(e){var t=this;P.getInstance().isSignedInUser()?(this.resetResources(),this.doc.getStage().setMaskData(void 0),this.blurCanvas=void 0,this.appliedMaskDataUrl150=void 0,this.originalImageDataUrl150=void 0,this.undostack=new ut({backgroundColor:null},10),Object(h.a)(Object(f.a)(n.prototype),"startEditor",this).call(this,e)):new os(Ze("SigninDialog.Message.PremiumSignin","This is a premium feature, please sign in for access."),T.cutout,(function(){t.endEditor(),t.doc.setEditor(null)})).show()}},{key:"endEditor",value:function(){this.resetResources(),this.doc.getStage().setMaskData(void 0),Object(h.a)(Object(f.a)(n.prototype),"endEditor",this).call(this)}},{key:"hasUndoStack",value:function(){return!0}},{key:"undo",value:function(){var e,t,n,a;null===(e=this.undostack)||void 0===e||e.undo(),this.backgroundColor=null!==(t=null===(n=this.undostack)||void 0===n?void 0:n.getCurrent().backgroundColor)&&void 0!==t?t:void 0,this.blurRadius=null===(a=this.undostack)||void 0===a?void 0:a.getCurrent().blurRadius,this.update()}},{key:"redo",value:function(){var e,t,n,a;null===(e=this.undostack)||void 0===e||e.redo(),this.backgroundColor=null!==(t=null===(n=this.undostack)||void 0===n?void 0:n.getCurrent().backgroundColor)&&void 0!==t?t:void 0,this.blurRadius=null===(a=this.undostack)||void 0===a?void 0:a.getCurrent().blurRadius,this.update()}},{key:"canUndo",value:function(){var e,t,n;return null!==(e=(null===(t=this.undostack)||void 0===t?void 0:t.canUndo())&&(null===(n=this.undostack)||void 0===n?void 0:n.getLength())>1)&&void 0!==e&&e}},{key:"canRedo",value:function(){var e,t;return null!==(e=null===(t=this.undostack)||void 0===t?void 0:t.canRedo())&&void 0!==e&&e}},{key:"canReset",value:function(){return this.canUndo()}},{key:"reset",value:function(){var e,t,n;this.resetResources(),null===(e=this.undostack)||void 0===e||e.clear(),null===(t=this.undostack)||void 0===t||t.add({backgroundColor:null,blurRadius:void 0}),null===(n=this.undostack)||void 0===n||n.setCurrentStep(0),this.update()}},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.undostack){e.next=8;break}if(!(n=null===(t=this.doc.getStage().getCanvas())||void 0===t?void 0:t.getContext("2d"))){e.next=8;break}if(!this.isDirty()){e.next=8;break}return a=this.doc.getImageData(),e.next=7,this.doc.editorApply(n.getImageData(0,0,a.width,a.height));case 7:(new Ee).showSurveyEditor("cutout");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.isDirty()&&(new Ee).showSurveyEditor("cutout"),this.doc.editorCancel()}},{key:"getParams",value:function(){return{backgroundColor:this.backgroundColor,blurRadius:this.blurRadius,hasMask:!this.doc.getStage().isMaskCanvasEmpty(),autoCutoutProgress:this.autoCutoutProgress}}},{key:"autoCutout",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a,r,i,o,l=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.getInstance().isSignedInUser()){e.next=2;break}return e.abrupt("return",Promise.reject(new Error("Unauthenticated user.")));case 2:if(this.isProcessing()){e.next=19;break}if(!this.doc.getStage().isMaskCanvasEmpty()){e.next=17;break}if(!(r=P.getInstance().getUserAccessToken())){e.next=17;break}return e.prev=6,this.cutoutService=new rs(r),e.next=10,this.cutoutService.createMask(this.doc.getImageData(),(function(e,t){l.autoCutoutProgress={state:e,percentage:t},l.updateViewParams()}));case 10:(o=e.sent)&&!1===(null===(i=this.cutoutService)||void 0===i?void 0:i.isCancelled())&&this.setAppliedMaskCanvas(M.applyMask(this.doc.getImageData(),o)),e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(6),e.abrupt("return",Promise.reject(e.t0));case 17:this.doc.getStage().isMaskCanvasEmpty()||!1!==(null===(a=this.cutoutService)||void 0===a?void 0:a.isCancelled())||(n?this.setBlurredBackground(n):this.setBackgroundColor(t),this.update()),this.cutoutService=void 0;case 19:return e.abrupt("return",Promise.resolve());case 20:case"end":return e.stop()}}),e,this,[[6,14]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"isProcessing",value:function(){return void 0!==this.cutoutService}},{key:"cancelAutoCutout",value:function(){var e;null===(e=this.cutoutService)||void 0===e||e.cancel(),this.cutoutService=void 0}},{key:"getAutoCutoutProgress",value:function(){return this.autoCutoutProgress}},{key:"applyBackgroundColor",value:function(e){this.setBackgroundColor(e),this.blurRadius=void 0,this.update()}},{key:"applyBlurredBackground",value:function(e,t){this.blurRadius!==e?(this.setBlurredBackground(e,t),this.update()):t&&this.addUndo()}},{key:"getAppliedMaskDataUrl150",value:function(){if(!this.appliedMaskDataUrl150){var e=this.getAppliedMaskImageData();if(e){var t,n=M.getNonAlphaBoundingRect(e);n&&(t=M.copyImageData(e,n));var a=M.resizeImageDataMaxSize(t||e,150);a&&(this.appliedMaskDataUrl150=M.createDataUrl(a))}}return this.appliedMaskDataUrl150}},{key:"getOriginalImageDataUrl150",value:function(){if(!this.originalImageDataUrl150&&this.doc.getImageData()){var e,t=this.doc.getImageData(),n=this.getAppliedMaskImageData();if(n){var a=M.getNonAlphaBoundingRect(n);a&&(e=M.copyImageData(t,a))}var r=M.resizeImageDataMaxSize(e||t,150);r&&(this.originalImageDataUrl150=M.createDataUrl(r))}return this.originalImageDataUrl150}},{key:"addUndo",value:function(){var e;null===(e=this.undostack)||void 0===e||e.add({backgroundColor:this.backgroundColor,blurRadius:this.blurRadius})}},{key:"update",value:function(){this.drawImageData(),this.updateViewParams(),this.doc.getDocActions().update()}},{key:"updateViewParams",value:function(){this.view.setParams(this.getParams())}},{key:"getAppliedMaskImageData",value:function(){if(!this.doc.getStage().isMaskCanvasEmpty()){var e=this.doc.getStage().getMaskCanvas();if(e){var t=e.getContext("2d");if(t)return t.getImageData(0,0,e.width,e.height)}}}},{key:"setAppliedMaskCanvas",value:function(e){this.doc.getStage().setMaskData(e)}},{key:"resetResources",value:function(){this.autoCutoutProgress=void 0,this.backgroundColor=void 0,this.blurRadius=void 0,this.cutoutService=void 0}},{key:"setBackgroundColor",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.backgroundColor!==e&&(this.backgroundColor=e||void 0,t&&this.addUndo())}},{key:"setBlurredBackground",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.doc.getImageData();this.blurCanvas||(this.blurCanvas=document.createElement("canvas"),this.blurCanvas.width=n.width,this.blurCanvas.height=n.height);var a=this.blurCanvas.getContext("2d");if(null!==a){a.putImageData($o(n,n.width,n.height,e),0,0);var r=a.createPattern(this.blurCanvas,"no-repeat");this.blurRadius=e,this.setBackgroundColor(r,t)}}},{key:"drawImageData",value:function(){var e=this.doc.getStage().getCanvas();if(e){var t=e.getContext("2d");if(t){var n,a=this.doc.getStage().getMaskCanvas(),r=this.backgroundColor;null===(null===(n=this.undostack)||void 0===n?void 0:n.getCurrent().backgroundColor)||null==a||this.doc.getStage().isMaskCanvasEmpty()?t.putImageData(this.doc.getImageData(),0,0):"transparent"!==r&&r?(t.fillStyle=r,t.fillRect(0,0,a.width,a.height),t.drawImage(a,0,0)):(t.clearRect(0,0,a.width,a.height),t.drawImage(a,0,0))}}}}]),n}(U),Is=function(){function e(t){Object(c.a)(this,e),this.imsToken=void 0,this.cancelled=void 0,this.storageService=void 0,this.imsToken=t,this.cancelled=!1,this.storageService=new as(t)}return Object(u.a)(e,[{key:"createInput",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=V()(),a="/temp/ps_upload_".concat(n,".jpg"),e.next=4,M.createBlob(t,"image/jpeg",.75);case 4:if(r=e.sent,!this.cancelled){e.next=7;break}return e.abrupt("return",Promise.resolve(null));case 7:return e.next=9,this.storageService.createOrUpdateResource(a,"image/jpeg",r);case 9:return e.abrupt("return",{href:a,storage:"adobe"});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.cancelled=!0}},{key:"isCancelled",value:function(){return this.cancelled}},{key:"runAction",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r,i,o,l,c,u,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:if(i=V()(),o="/temp/ps_result_".concat(i,".jpg"),a&&a(Ze("PhotoshopService.ProgressState.Process","Process"),25),l={inputs:[t],options:{actions:[n]},outputs:[{href:o,storage:"adobe",type:"image/jpeg",overwrite:!0,width:0,quality:7}]},!this.cancelled){e.next=8;break}return e.abrupt("return",Promise.resolve(null));case 8:return e.next=10,fetch("".concat("https://image.adobe.io","/pie/psdService/batchPlay"),{method:"POST",headers:{"x-api-key":"FrictionlessPSWebApp1",authorization:this.imsToken,"content-type":"application/json"},body:JSON.stringify(l)});case 10:if(202===(c=e.sent).status){e.next=13;break}return e.abrupt("return",null);case 13:return e.next=15,c.json();case 15:if(u=e.sent,!this.cancelled){e.next=18;break}return e.abrupt("return",Promise.resolve(null));case 18:return e.next=20,this.checkJobFinished(u._links.self.href,a);case 20:if(d=e.sent){e.next=23;break}return e.abrupt("return",Promise.resolve(null));case 23:if(!this.cancelled){e.next=25;break}return e.abrupt("return",Promise.resolve(null));case 25:if("succeeded"!==d.outputs[0].status){e.next=31;break}return a&&a(Ze("PhotoshopService.ProgressState.Download","Download"),75),e.next=29,this.storageService.getResource(o);case 29:return h=e.sent,e.abrupt("return",M.createImageData(h));case 31:throw console.error((null===(r=d.outputs[0].errors)||void 0===r?void 0:r.title)||"Unknown error"),new Error("Job failed");case 33:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"getJobStatus",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return console.debug("getJobStatus",t),e.next=5,fetch(t,{method:"GET",headers:{"x-api-key":"FrictionlessPSWebApp1",authorization:this.imsToken}});case 5:if(200===(n=e.sent).status){e.next=8;break}throw new Error(n.statusText);case 8:return e.abrupt("return",n.json());case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkJobFinished",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cancelled){e.next=2;break}return e.abrupt("return",Promise.resolve(null));case 2:return e.next=4,this.getJobStatus(t);case 4:if(a=e.sent,console.log(a),a.outputs){e.next=8;break}return e.abrupt("return",a);case 8:if("running"!==a.outputs[0].status&&"pending"!==a.outputs[0].status){e.next=13;break}return n&&n("running"===a.outputs[0].status?Ze("PhotoshopService.ProgressState.Running","Running"):Ze("PhotoshopService.ProgressState.Pending","Pending"),30),e.next=12,this.wait(1e3);case 12:return e.abrupt("return",this.checkJobFinished(a._links.self.href));case 13:return e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"wait",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),e}(),As=function(e,t,n){var a=e.createShader(n);return null==a||(e.shaderSource(a,t),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS))?a:(alert("An error occurred compiling the shaders: ".concat(e.getShaderInfoLog(a))),null)},Rs=function(e,t){e.clearColor(0,0,0,0),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0);var n=function(e,t,n){var a=e.createProgram();if(null!==a){var r=As(e,t,e.VERTEX_SHADER),i=As(e,n,e.FRAGMENT_SHADER);null!==r&&e.attachShader(a,r),null!==i&&e.attachShader(a,i),e.linkProgram(a)}return null!==a&&e.getProgramParameter(a,e.LINK_STATUS)||alert("Unable to initialize the shader program."),a}(e,"\nattribute vec4 a_position;\nvarying vec2 v_position;\n\nvoid main() {\n  v_position = vec2(a_position.z, 1.0 - a_position.w);\n  gl_Position = vec4(a_position.x, a_position.y, 0, 1);\n}\n","\nprecision highp float;\n\nuniform vec2 u_outsize;\nvarying vec2 v_position;\nuniform sampler2D textureData;\nuniform vec2 textureSize;\nuniform float intensity;\nuniform int filterID;\nuniform vec2 control1;\nuniform vec2 control2;\nuniform vec2 control3;\nuniform vec2 control4;\n\nvec4 getTextureColorAt(vec2 position) {\n  vec2 texPosition = position/textureSize;\n\n  return texture2D(textureData, texPosition);\n}\n\n@textureFunction\n\nvoid main(void)\n{\n  vec2 outPixelDelta = vec2(1.0, 1.0) / u_outsize;\n  vec2 outPos = v_position * u_outsize;\n\n  vec2 texDelta = vec2(1.0,1.0)/textureSize;\n\n  vec2 texPosition = v_position * u_outsize;\n  vec4 col = processPixelAt(texPosition);\n\n  gl_FragColor = col;\n}\n".replace("@textureFunction",t));if(n){e.useProgram(n);var a=e.getAttribLocation(n,"a_position");return e.enableVertexAttribArray(a),function(e){var t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t);e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,-1,1,0,1,1,-1,1,0,1,1,1,1]),e.STATIC_DRAW)}(e),{shaderProgram:n,vertexPositionAttribute:a}}return null},Ds=function(){function e(t){if(Object(c.a)(this,e),this.canvas=void 0,this.gl=void 0,this.texture=void 0,this.textureData=void 0,this.shaderProgram=void 0,this.canvas=document.createElement("canvas"),this.textureData=document.createElement("canvas"),this.gl=function(e){var t=null;try{t=e.getContext("webgl",{alpha:!0})||e.getContext("experimental-webgl")}catch(n){alert("Error: No Web GL")}return t}(this.canvas),this.texture=null,this.gl){var n=Rs(this.gl,t);n&&(this.shaderProgram=n.shaderProgram,this.gl.vertexAttribPointer(n.vertexPositionAttribute,4,this.gl.FLOAT,!1,0,0))}}return Object(u.a)(e,[{key:"setImageData",value:function(e,t,n,a,r){var i;if(this.gl){var o=Math.floor(a),s=Math.floor(r);this.textureData.width===o&&this.textureData.height===s||(this.textureData.width=o,this.textureData.height=s),null===(i=this.textureData.getContext("2d"))||void 0===i||i.putImageData(n,Math.floor(e),Math.floor(t))}}},{key:"getImageData",value:function(){if(this.gl){var e=new ImageData(this.canvas.width,this.canvas.height);return this.gl.readPixels(0,0,this.canvas.width,this.canvas.height,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e.data),e}}},{key:"drawGL",value:function(e,t,n){if(this.gl&&this.shaderProgram){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);var a=this.textureData;if(a){this.gl.useProgram(this.shaderProgram),this.texture=function(e,t){var n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),n}(this.gl,a);var r=this.gl.getUniformLocation(this.shaderProgram,"textureData");this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.uniform1i(r,0);var i=this.gl.getUniformLocation(this.shaderProgram,"textureSize");i&&this.gl.uniform2f(i,a.width,a.height);var o=this.gl.getUniformLocation(this.shaderProgram,"u_outsize");this.gl.uniform2f(o,this.canvas.width,this.canvas.height);var s=this.gl.getUniformLocation(this.shaderProgram,"intensity");this.gl.uniform1f(s,e);var l=this.gl.getUniformLocation(this.shaderProgram,"filterID");this.gl.uniform1i(l,t);for(var c=0;c<n.length;c++){var u=this.gl.getUniformLocation(this.shaderProgram,"control".concat(c+1));this.gl.uniform2f(u,n[c][0],n[c][1])}this.gl.drawArrays(this.gl.TRIANGLES,0,6)}}}}]),e}(),js=function(){function e(t,n,a,r,i,o,s,l,u){Object(c.a)(this,e),this.doc=void 0,this.id=void 0,this.title=void 0,this.hasIntensity=void 0,this.intensityLabel=void 0,this.startIntensity=void 0,this.useTransparency=void 0,this.previewImgRef=void 0,this.deeplinkId=void 0,this.controlPoints=void 0,this.intensity=Vs,this.cachable=!0,this.progressDialogRef=void 0,this.canceled=!1,this.loginNeeded=!1,this.doc=t,this.id=n,this.title=a,this.hasIntensity=r,this.intensityLabel=i,this.startIntensity=o,o&&(this.intensity=o),this.useTransparency=s,this.deeplinkId=l,this.controlPoints=u}return Object(u.a)(e,[{key:"hasLoginNeeded",value:function(){return this.loginNeeded}},{key:"setIntensity",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.intensity=t,this.useTransparency&&(n=this.doc.getStage().getMaskCanvas())&&(n.style.opacity="".concat(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIntensity",value:function(){return this.intensity}},{key:"getId",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"hasIntensityEnabled",value:function(){return this.hasIntensity}},{key:"getIntensityLabel",value:function(){return this.intensityLabel}},{key:"getAriaIntensityValue",value:function(e){return"".concat(Math.round(100*e)," %")}},{key:"getDeepLinkId",value:function(){return this.deeplinkId}},{key:"getPreview",value:function(){return"/assets/filter/".concat(this.id,".jpg")}},{key:"getControlPoints",value:function(){return this.controlPoints?this.controlPoints:[]}},{key:"isExperimental",value:function(){return!1}},{key:"reset",value:function(){this.startIntensity&&(this.intensity=this.startIntensity)}},{key:"setControlPoints",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.controlPoints=t;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve(this.doc.getImageData()));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"useCache",value:function(){return this.cachable}},{key:"drawFilterImageData",value:function(e){if(this.useTransparency){this.doc.getStage().setImageData(this.doc.getImageData()),this.adaptSize(e),this.doc.getStage().setMaskData(e);var t=this.doc.getStage().getMaskCanvas();t&&(t.style.opacity="".concat(this.intensity))}else this.doc.getStage().setImageData(e),this.doc.getStage().setMaskData(void 0)}},{key:"adaptSize",value:function(e){var t=this.doc.getStage().getCanvas();if(t&&(e.width!==t.width||e.height!==t.height)){var n=M.resizeImageData(this.doc.getImageData(),e.width,e.height);n&&this.doc.getStage().setImageData(n),this.doc.getStage().centerContent()}}},{key:"getFinalImageData",value:function(){if(this.useTransparency){var e=this.doc.getStage().getCanvas(),t=this.doc.getStage().getMaskCanvas();if(!e||!t)return;return M.renderIntoImageData(e,t,this.intensity)}var n=this.doc.getStage().getCanvas(),a=null===n||void 0===n?void 0:n.getContext("2d");if(n&&a)return a.getImageData(0,0,null===n||void 0===n?void 0:n.width,null===n||void 0===n?void 0:n.height)}},{key:"showProgressDialog",value:function(){var e=this;this.progressDialogRef=new Os("Applying ".concat(this.title),(function(){e.canceled=!0,e.cancelFilterProcess()})),this.progressDialogRef.show()}},{key:"updateProgress",value:function(e){var t;null===(t=this.progressDialogRef)||void 0===t||t.setProgress(e.state,e.percentage)}},{key:"cancelFilterProcess",value:function(){}}],[{key:"getFilterType",value:function(){return _s.base}}]),e}();js.PREVIEW_IMAGE_SIZE=265;var _s,Ls=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a,r,i,o,s,l,u,d,h){var f;return Object(c.a)(this,n),(f=t.call(this,e,a,r,i,o,s,!1,l,d)).previewData=void 0,f.glCanvas=void 0,f.shaderCode=void 0,f.ariaFunction=void 0,f.shaderCode="\n// getTextureColorAt(vec2 position)\n//\n// sampler2D textureData - current texture\n// vec2 position - current pixel position\n// vec2 textureSize - current texture size\n// float intensity - intensity\n// int filterID\n\nvec4 processPixelAt(vec2 position) {\n    return vec4(1.0, 0.0, 0.0, 1.0);\n}\n",f.ariaFunction=h,f.cachable=!1,u&&(f.shaderCode=u),f}return Object(u.a)(n,null,[{key:"getFilterType",value:function(){return _s.gl}}]),Object(u.a)(n,[{key:"getPreview",value:function(){if(this.previewData)return this.previewData;var e=M.resizeImageDataToWidth(this.doc.getImageData(),n.PREVIEW_IMAGE_SIZE);if(e){var t=this.drawGL(e,this.id,this.startIntensity||ya);t&&(this.previewData=M.createDataUrl(t))}return this.previewData||M.createDataUrl(this.doc.getImageData())}},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.drawGL(this.doc.getImageData(),this.id,this.intensity))){e.next=3;break}return e.abrupt("return",Promise.resolve(t));case 3:return e.abrupt("return",Promise.reject(new Error("No input given")));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAriaIntensityValue",value:function(e){return this.ariaFunction?this.ariaFunction(e):Object(h.a)(Object(f.a)(n.prototype),"getAriaIntensityValue",this).call(this,e)}},{key:"setIntensity",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(h.a)(Object(f.a)(n.prototype),"setIntensity",this).call(this,t),e.next=3,this.apply();case 3:a=e.sent,this.drawFilterImageData(a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setControlPoints",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(h.a)(Object(f.a)(n.prototype),"setControlPoints",this).call(this,t),e.next=3,this.apply();case 3:a=e.sent,this.drawFilterImageData(a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"drawGL",value:function(e,t,n){return this.glCanvas||(this.glCanvas=new Ds(this.shaderCode)),this.glCanvas.canvas.width=e.width,this.glCanvas.canvas.height=e.height,this.glCanvas.setImageData(0,0,e,e.width,e.height),this.glCanvas.drawGL(n,t,this.controlPoints||[]),this.glCanvas.getImageData()}}]),n}(js),Ns=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a,r,i){var o;return Object(c.a)(this,n),(o=t.call(this,e,a,r,!0,Ze("FiltersView.Custom.Pixelate.Pixelsize","Pixel size"),.2,!1,i)).previewData=void 0,o.cachable=!1,o}return Object(u.a)(n,null,[{key:"getFilterType",value:function(){return _s.pixelate}}]),Object(u.a)(n,[{key:"isExperimental",value:function(){return!0}},{key:"getPreview",value:function(){if(this.previewData)return this.previewData;var e=M.resizeImageDataToWidth(this.doc.getImageData(),n.PREVIEW_IMAGE_SIZE);if(e){var t=this.pixelate(e,10);t&&(this.previewData=M.createDataUrl(t))}return this.previewData||M.createDataUrl(this.doc.getImageData())}},{key:"getAriaIntensityValue",value:function(e){return"".concat(Math.round(100*e))}},{key:"setIntensity",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(h.a)(Object(f.a)(n.prototype),"setIntensity",this).call(this,t),e.next=3,this.apply();case 3:a=e.sent,this.drawFilterImageData(a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.pixelate(this.doc.getImageData(),Math.round(100*this.intensity)))){e.next=3;break}return e.abrupt("return",Promise.resolve(t));case 3:return e.abrupt("return",Promise.reject(new Error("No input given")));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pixelate",value:function(e,t){if(0===t)return e;var n=e.width/t|0,a=e.height/t|0,r=M.createHTMLCanvasElementForSize(e.width,e.height).getContext("2d"),i=M.createHTMLCanvasElementForSize(n,a),o=i.getContext("2d");return r&&o?(r.imageSmoothingEnabled=!1,o.drawImage(M.createHTMLCanvasElement(e),0,0,n,a),r.drawImage(i,0,0,n,a,0,0,e.width,e.height),r.getImageData(0,0,e.width,e.height)):void 0}}]),n}(js);!function(e){e.base="base",e.psapi="psapi",e.pixelate="pixelate",e.gl="gl"}(_s||(_s={}));var Vs=1,Fs=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"getBaseListFilterIds",value:function(){return[1,2,3,4,5,6,7,8]}},{key:"getFilters",value:function(e){return Object(Ft.filter)([new Ls(e,1,Ze("FiltersView.GLFilter.InvertColor.Title","Invert color"),!1,void 0,void 0,"invertcolor","\nvec4 processPixelAt(vec2 position) {\n  vec4 col = getTextureColorAt(position);\n\n  return vec4(1.0 - col.rgb, col.a);\n}\n"),new Ns(e,2,Ze("FiltersView.Custom.Pixelate.Title","Pixelate"),"pixelate"),new Us(e,3,Ze("FiltersView.PSAction.OilPaint.Title","Oil Paint"),"https://raw.githubusercontent.com/kaiortmanns/test/master/OilPaint.atn",1,"oilpaint"),new Ls(e,4,Ze("Filters.GLFilter.Halftone","Halftone"),!0,Ze("FiltersView.GLFilter.Halftone.Intensity","Tone Amount"),.5,"halftone","\nconst float PI = 3.14159265358979323846264338327950288;\nconst float angle = 45.0;\nfloat offset = 3.0 + intensity * textureSize.x / 100.0;\n\nvec4 processPixelAt(vec2 position) {\n\n  vec4 fragColor = getTextureColorAt(position);\n\n  vec2 coord = vec2(position.x, position.y);\n  vec2 rot;\n  vec2 center;\n  float pLen = offset/sqrt(2.0);\n\n  rot.x = coord.x * cos(PI * angle/180.0) + coord.y * sin(PI * angle/180.0);\n  rot.y = coord.x * -sin(PI * angle/180.0) + coord.y * cos(PI * angle/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -angle/180.0) + center.y * sin(PI * -angle/180.0);\n  rot.y = center.x * -sin(PI * -angle/180.0) + center.y * cos(PI * -angle/180.0);\n\n  vec4 col = fragColor;\n  vec4 dst;\n\n  vec2 dist = coord - rot;\n\n  float light = 1.0 - (col.r + col.g + col.b)/3.0;\n\n  if (light * pLen < length(dist))\n\n      dst = vec4(1,1,1,col.a);\n  else\n      dst = vec4(0,0,0,col.a);\n\n  return dst;\n}\n"),new Ls(e,5,Ze("Filters.GLFilter.ColorHalftone","Color Halftone"),!0,Ze("FiltersView.GLFilter.ColorHalftone.Intensity","Color Halftone Amount"),.5,"colorhalftone","\nconst float PI = 3.14159265358979323846264338327950288;\nconst float angle = 45.0;\nfloat offset = 3.0 + intensity * textureSize.x / 100.0;\n\nvec4 processPixelAt(vec2 position) {\n\n  vec4 fragColor = getTextureColorAt(position);\n  vec2 coord = vec2(position.x, position.y);\n  vec4 col = fragColor;\n\n  vec2 rot;\n  vec2 center;\n  float pLen = offset/sqrt(2.0);\n  float a1 = angle;\n  float a2 = angle + 60.0;\n  float a3 = angle + 30.0;\n  float a4 = angle + 45.0;\n\n  rot.x = coord.x * cos(PI * a1/180.0) + coord.y * sin(PI * a1/180.0);\n  rot.y = coord.x * -sin(PI * a1/180.0) + coord.y * cos(PI * a1/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -a1/180.0) + center.y * sin(PI * -a1/180.0);\n  rot.y = center.x * -sin(PI * -a1/180.0) + center.y * cos(PI * -a1/180.0);\n  vec2 dist1 = coord - rot;\n\n  rot.x = coord.x * cos(PI * a2/180.0) + coord.y * sin(PI * a2/180.0);\n  rot.y = coord.x * -sin(PI * a2/180.0) + coord.y * cos(PI * a2/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -a2/180.0) + center.y * sin(PI * -a2/180.0);\n  rot.y = center.x * -sin(PI * -a2/180.0) + center.y * cos(PI * -a2/180.0);\n  vec2 dist2 = coord - rot;\n\n  rot.x = coord.x * cos(PI * a3/180.0) + coord.y * sin(PI * a3/180.0);\n  rot.y = coord.x * -sin(PI * a3/180.0) + coord.y * cos(PI * a3/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -a3/180.0) + center.y * sin(PI * -a3/180.0);\n  rot.y = center.x * -sin(PI * -a3/180.0) + center.y * cos(PI * -a3/180.0);\n  vec2 dist3 = coord - rot;\n\n  rot.x = coord.x * cos(PI * a4/180.0) + coord.y * sin(PI * a4/180.0);\n  rot.y = coord.x * -sin(PI * a4/180.0) + coord.y * cos(PI * a4/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -a4/180.0) + center.y * sin(PI * -a4/180.0);\n  rot.y = center.x * -sin(PI * -a4/180.0) + center.y * cos(PI * -a4/180.0);\n  vec2 dist4 = coord - rot;\n\n  float k = 0.1;\n  vec4 cmyk = vec4(0.0, 1.0 - col.r, 1.0 - col.g,1.0 - col.b);\n  cmyk[0] = cmyk[1] * k;\n  if (cmyk[2] * k < cmyk[0])\n      cmyk[0] = cmyk[2] * k;\n  if (cmyk[3] * k < cmyk[0])\n      cmyk[0] = cmyk[3] * k;\n  cmyk[1] -= cmyk[0];\n  cmyk[2] -= cmyk[0];\n  cmyk[3] -= cmyk[0];\n\n  vec4 v = vec4(1.0);\n  if (cmyk[0] * pLen < length(dist1))\n      v[0] = 0.0;\n\n  if (cmyk[1] * pLen < length(dist2))\n      v[1] = 0.0;\n  if (cmyk[2] * pLen < length(dist3))\n      v[2] = 0.0;\n  if (cmyk[3] * pLen < length(dist4))\n      v[3] = 0.0;\n\n  vec4 dst = col;\n  dst.r = 1.0 - clamp(v[0] + v[1], 0.0, 1.0);\n  dst.g = 1.0 - clamp(v[0] + v[2], 0.0, 1.0);\n  dst.b = 1.0 - clamp(v[0] + v[3], 0.0, 1.0);\n\n  return dst;\n}\n"),new Ls(e,6,Ze("Filters.GLFilter.Posterize","Posterize"),!0,Ze("FiltersView.GLFilter.Posterize.Intensity","Posterize Amount"),.25,"posterize","\nvec4 processPixelAt(vec2 position) {\n  vec4 col = getTextureColorAt(position);\n\n  mat4 YIQMatrix = mat4(\n      0.299,  0.596,  0.212, 0.000,\n      0.587, -0.275, -0.523, 0.000,\n      0.114, -0.321,  0.311, 0.000,\n      0.000,  0.000,  0.000, 1.000\n  );\n\n  mat4 inverseYIQ = mat4(\n      1.0,    1.0,    1.0,    0.0,\n      0.956, -0.272, -1.10,  0.0,\n      0.621, -0.647,  1.70,   0.0,\n      0.0,    0.0,    0.0,    1.0\n  );\n\n  float numColors = 1.0 + intensity * 20.0;\n  vec4 yiq = YIQMatrix * col;\n\n  yiq[0] = floor(yiq[0] * numColors + 0.5)/numColors + 0.1;\n\n  vec4 dst = inverseYIQ * yiq;\n  return dst;\n}\n"),new Ls(e,7,Ze("Filters.GLFilter.ColorCycle","Color Cycle"),!0,Ze("FiltersView.GLFilter.ColorCycle.Angle","Color Angle"),.25,"colorize","\n\nvec3 rgb2hsb( in vec3 c ){\n  vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p = mix(vec4(c.bg, K.wz),\n               vec4(c.gb, K.xy),\n               step(c.b, c.g));\n  vec4 q = mix(vec4(p.xyw, c.r),\n               vec4(c.r, p.yzx),\n               step(p.x, c.r));\n  float d = q.x - min(q.w, q.y);\n  float e = 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)),\n              d / (q.x + e),\n              q.x);\n}\n\nvec3 hsb2rgb( in vec3 c ){\n  vec3 rgb = clamp(abs(mod(c.x*6.0+vec3(0.0,4.0,2.0),\n                           6.0)-3.0)-1.0,\n                   0.0,\n                   1.0 );\n  rgb = rgb*rgb*(3.0-2.0*rgb);\n  return c.z * mix(vec3(1.0), rgb, c.y);\n}\n\nvec4 processPixelAt(vec2 position) {\n  vec4 col = getTextureColorAt(position);\n  \n  vec3 hsb = rgb2hsb(col.rgb);\n\n  // hsb.x = intensity;\n  hsb.x = mod(hsb.x + intensity, 1.0);\n  \n  col.rgb = hsb2rgb(hsb);\n  \n  return col;\n}\n",[],(function(e){return"".concat(Math.floor(360*e),"\xb0")})),new Ls(e,8,Ze("Filters.GLFilter.LensFlare","Lens Flare"),!0,Ze("FiltersView.GLFilter.LensFlare.Intensity","Intensity"),.95,"lensflare","\n\nconst float PI = 3.14159265358979323846264338327950288;\nconst int octaves = 3;\nconst float persistence = 0.5;\nfloat imageScale = min(textureSize.x, textureSize.y);\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n  return mod289(((x * 34.0) + 1.0) * x);\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v) {\n  const vec2 C = vec2(1.0 / 6.0, 1.0 / 3.0);\n  const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);\n  const float n_ = 1.0 / 7.0;\n  vec3 i = floor(v + dot(v, C.yyy));\n  vec3 x0 = v - i + dot(i, C.xxx);\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min(g.xyz, l.zxy);\n  vec3 i2 = max(g.xyz, l.zxy);\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy;\n  vec3 x3 = x0 - D.yyy;\n  i = mod289(i);\n  vec4 p = permute(permute(permute(i.z + vec4(0.0, i1.z, i2.z, 1.0)) + i.y + vec4(0.0, i1.y, i2.y, 1.0)) + i.x + vec4(0.0, i1.x, i2.x, 1.0));\n  vec3  ns = n_ * D.wyz - D.xzx;\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_);\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n  vec4 b0 = vec4(x.xy, y.xy);\n  vec4 b1 = vec4(x.zw, y.zw);\n  vec4 s0 = floor(b0) * 2.0 + 1.0;\n  vec4 s1 = floor(b1) * 2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n  vec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy;\n  vec4 a1 = b1.xzyw + s1.xzyw * sh.zzww;\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n  vec4 m = max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot(m * m, vec4(dot(p0, x0), dot(p1, x1), dot(p2, x2), dot(p3, x3)));\n}\n\nfloat onoise(vec3 v) {\n  float total = 0.0;\n  float frequency = 1.0;\n  float amplitude = 1.0;\n  float maxValue = 0.0;\n  for (int i = 0; i < octaves; i++) {\n    total += snoise(v * frequency) * amplitude;\n    maxValue += amplitude;\n    amplitude *= persistence;\n    frequency *= 2.0;\n  }\n  return total / maxValue;\n}\n\nfloat angleForVec(vec2 pos)\n{\n    if (pos.x == 0.0)\n        return (pos.y < 0.0) ? -(PI/2.0) : (PI/2.0);\n\n    if (pos.x < 0.0)\n        return PI - atan(pos.y/-pos.x);\n    else\n        return atan(pos.y/pos.x);\n}\n\nfloat glow(float val) {\n  return clamp(1.0 - pow(val, 0.2), 0.0, 1.0);\n}\n\nfloat rays(float angle, float len, float rand) {\n  return clamp(0.5 + onoise(vec3(angle * 3.9, len * 0.8, rand)), 0.0, 1.0);\n}\n\nvec3 flare(vec2 circlePos, vec2 position) {\n  vec2 circleVec = position - circlePos;\n  \n  float len = length(circleVec)/imageScale;\n  float angle = angleForVec(circleVec);\n\n  float rayLight = rays(angle, len, intensity);\n  float rayComp = rayLight * glow(len) * 0.5;\n  float glowComp = glow(len * 2.4) * 3.0 * pow(0.5, 0.1);\n\n  vec3 rayCol = vec3(1.0, 1.0, 0.5);\n  vec3 glowCol = vec3(1.0, 1.0, 0.8);\n\n  return clamp(rayComp * rayCol + glowComp * glowCol, 0.0, 1.0) * intensity;\n}\n\nvec3 spot(vec2 circlePos, vec3 color, float size, vec2 position) {\n  vec2 circleVec = position - circlePos;\n  \n  float len = length(circleVec)/imageScale;\n  float x = len / (size * 0.5);\n  float f = clamp(1.0 - pow(x, 0.2), 0.0, 1.0);\n  \n  return color * f * intensity;\n}\n\nvec3 circle(vec2 circlePos, vec3 color, float size, float amp, vec2 position) {\n  vec2 circleVec = position - circlePos;\n  \n  float len = length(circleVec)/imageScale;\n  float x = pow(len / (size * 0.5), amp);\n  \n  float f = clamp(1.2 * (pow(x, 2.0) - pow(x, 13.0) + 0.1), 0.0, 1.0);\n  \n  return color * f * intensity;\n}\n\nvec2 linePos(float pos) {\n  vec2 p1 = vec2(control1.x * textureSize.x, (1.0 - control1.y) * textureSize.y);\n  vec2 p2 = vec2(control2.x * textureSize.x, (1.0 - control2.y) * textureSize.y);\n\n  return mix(p1, p2, pos);\n}\n\nvec3 blendModeScreen(vec3 a, vec3 b) {\n  return 1.0 - (1.0 - a) * (1.0 - b);\n}\n\nvec4 processPixelAt(vec2 position) {\n  vec4 col = getTextureColorAt(position);\n\n  vec3 light = flare(linePos(0.0), position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = circle(linePos(0.3), vec3(1.0, 0.9, 0.2) * 0.15, 0.2, 3.0, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = circle(linePos(0.43), vec3(0.5, 0.9, 0.43) * 0.4, 0.12, 1.0, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = spot(linePos(0.6), vec3(1.0, 0.3, 0.0) * 2.5, 0.4, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = circle(linePos(0.82), vec3(1.0, 0.9, 0.6) * 0.4, 0.35, 2.0, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = circle(linePos(1.0), vec3(0.5, 0.7, 1.0) * 0.3, 0.5, 5.0, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  return col;\n}\n",[$e.e.fromValues(.35,.35),$e.e.fromValues(.65,.65)])])||[]}}]),e}(),Us=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a,r,i,o,s){var l;return Object(c.a)(this,n),(l=t.call(this,e,a,r,!0,Ze("FiltersView.PSAction.Intensity","Intensity"),o,!0,s)).psService=void 0,l.actionHref=void 0,l.actionHref=i,l.loginNeeded=!0,l}return Object(u.a)(n,null,[{key:"getFilterType",value:function(){return _s.psapi}}]),Object(u.a)(n,[{key:"isExperimental",value:function(){return!0}},{key:"isProcessing",value:function(){return void 0!==this.psService}},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,r,i,o,l=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.getInstance().isSignedInUser()){e.next=2;break}return e.abrupt("return",Promise.reject(new Error("Unauthenticated user.")));case 2:if(this.actionHref){e.next=4;break}return e.abrupt("return",Promise.reject(new Error("No filter url given")));case 4:if(this.isProcessing()){e.next=26;break}if(t=P.getInstance().getUserAccessToken()){e.next=8;break}return e.abrupt("return",Promise.reject(new Error("Unauthenticated user.")));case 8:if(this.psService=new Is(t),this.showProgressDialog(),n.input){e.next=15;break}return e.next=13,this.psService.createInput(this.doc.getImageData());case 13:(a=e.sent)&&(n.input=a);case 15:if(n.input){e.next=17;break}return e.abrupt("return",Promise.reject(new Error("No input given")));case 17:return r={href:this.actionHref,storage:"external"},e.next=20,this.psService.runAction(n.input,r,(function(e,t){console.debug(e,t),l.updateProgress({state:e,percentage:t})}));case 20:if(i=e.sent,this.psService=void 0,this.canceled||null===(o=this.progressDialogRef)||void 0===o||o.close(),this.progressDialogRef=void 0,!i){e.next=26;break}return e.abrupt("return",Promise.resolve(i));case 26:return e.abrupt("return",Promise.reject(new Error("Output error")));case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancelFilterProcess",value:function(){var e;null===(e=this.psService)||void 0===e||e.cancel(),this.psService=void 0}}],[{key:"resetInput",value:function(){n.input=void 0}}]),n}(js);Us.input=void 0;n(548);var Bs=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={params:e.controller.getParams()},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setParams",value:function(e){this.setState({params:e})}},{key:"refresh",value:function(){}},{key:"renderFilters",value:function(){var e=this.props.controller,t=this.state.params,n=[];return Fs.getBaseListFilterIds().forEach((function(t){var a=Object(Ft.find)(e.getFilters(),(function(e){return e.getId()===t}));!a||a.isExperimental()&&!Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_STORAGE_API_URL:"https://cc-api-storage-creativesdk.adobe.io",REACT_APP_PM_WASM_HASH:"a888ee0586ced614e2b443c111d9b1882cb0c3061b15b473ec822c76ad6f47c8",REACT_APP_IMS_ENV:"prod",REACT_APP_RUNNING_ENV:"production",REACT_APP_NAME:"frictionless-web",REACT_APP_PRIVACY_OTDOMAINID:"7a5eb705-95ed-4cc4-a11d-0cc5760e93db",REACT_APP_IMS_API_KEY:"ps-frictionless-web",REACT_APP_UTILITYNAV_CSS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.css",REACT_APP_UTILITYNAV_JS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.js",REACT_APP_USERTESTS:"agedashi:app:available_editors",REACT_APP_BUILD_SHA:"a095f6519961",REACT_APP_IMAGE_API_KEY:"FrictionlessPSWebApp1",REACT_APP_TARGET_CLIENT:"adobeinternalmobiles",REACT_APP_IMS_LIB_URL:"https://static.adobelogin.com/imslib/imslib.min.js",REACT_APP_CROP_FLIP_AXIS_REFERENCE:"cropbox",REACT_APP_BUILD_TIME:"Thu Oct 15 16:10:37 UTC 2020",REACT_APP_IMS_API_URL:"https://ims-na1.adobelogin.com",REACT_APP_AVAILABLE_EDITORS:"spotheal,crop,resize,adjust,cutout,effects",REACT_APP_CC_LEARN_MORE:"https://www.adobe.com/creativecloud/photography.html",REACT_APP_GLOBAL_TESTING_PROPERTY_TOKEN:"2bb70f5a-cc1f-79c3-a659-66e4e32dc3fc",REACT_APP_GLOBAL_TESTING_MBOXES:"agedashi:app:adjustments",REACT_APP_DUNAMIS_PROJECT:"ps-web-service",REACT_APP_IMAGE_API_URL:"https://image.adobe.io",REACT_APP_ANONYMOUS_USER_DOWNLOADS_EACH_MS:"31536000000",REACT_APP_ANONYMOUS_USER_DOWNLOADS:"1",REACT_APP_WHITELISTED_LANGUAGES:"cs,da,de,en,es,fi,fr,it,ja,ko,nb,nl,pl,pt,ru,sv,tr,zh_CN,zh_TW,zh_cn,zh_tw",REACT_APP_CROP_ROTATE_PIVOT:"cropcenter",REACT_APP_FREE_USER_DOWNLOADS_EACH_MS:"86400000",REACT_APP_DUNAMIS_ENV:"prod",REACT_APP_FREE_USER_DOWNLOADS:"1",REACT_APP_DUNAMIS_API_KEY:"ps-web-service",REACT_APP_PRIVACY_JS_URL:"https://www.adobe.com/etc/beagle/public/globalnav/adobe-privacy/latest/privacy.min.js",REACT_APP_CROP_ROTATE_WITH_CROPBOX:"true",REACT_APP_NEWRELIC_AGENT_FILE:"agedashi-prod",REACT_APP_VERSION:"0.1.0",REACT_APP_STORAGE_API_KEY:"FrictionlessPSWebApp1",REACT_APP_ADOBE_BASE_GOURL:"https://www.adobe.com/go/",REACT_APP_GLOBAL_TRACKING_ENV:"production",REACT_APP_CROP_RATIOCHANGE_REFERENCE:"cropbox",REACT_APP_DUNAMIS_API_URL:"https://cc-api-data.adobe.io"}).REACT_APP_SHOW_EXPERIMENTAL_FEATURES||n.push(a)})),n.map((function(n){return g.a.createElement(da.Card,{key:n.getId(),id:"".concat(n.getId()),allowsSelection:!1,className:t.filterId===n.getId()?"image-card selected":"image-card"},g.a.createElement("div",{className:"spectrum-Card-coverPhoto",onClick:function(){e.setFilter(n),ie("filters:".concat(Object(Ft.camelCase)(n.getTitle())))},role:"presentation",style:{backgroundImage:"url(".concat(n.getPreview(),")"),cursor:"pointer",width:"265px"}}),g.a.createElement(da.CardBody,{className:"presets-card-body",title:n.getTitle()},t.filterId===n.getId()&&n.hasIntensityEnabled()&&g.a.createElement("div",{className:"base-slider"},g.a.createElement(Be.a,{renderLabel:!0,label:n.getIntensityLabel(),min:0,max:1,step:.01,filled:!0,fillOffset:1,value:n.getIntensity(),onChange:function(t){return e.setIntensity(t,!1)},onChangeEnd:function(t){e.setIntensity(t,!0),ie("filters:".concat(Object(Ft.camelCase)(n.getTitle())))},getAriaValueText:function(e){return n.getAriaIntensityValue(e)}}))))}))}},{key:"render",value:function(){var e=this.props.controller;return g.a.createElement("div",{className:"editor-panel"},g.a.createElement("div",{className:"settings-right"},g.a.createElement("div",{className:"settings-scrolling-content"},g.a.createElement("div",{className:"settings-header"},g.a.createElement("div",{className:"title"},Ze("FiltersView.Title.ArtEffects","Art effects")),g.a.createElement("div",{className:"reset-button"},g.a.createElement(xe.a,{quiet:!0,variant:"action",onClick:function(){e.reset()},icon:g.a.createElement(na.a,null),disabled:!e.isDirty()},Ze("FiltersView.Button.Reset","Reset")))),g.a.createElement("div",{className:"filterlist"},this.renderFilters())),g.a.createElement("div",{className:"action-button-container"},g.a.createElement(xe.a,{onClick:function(){ie("filtersCancel"),e.cancel()}},Ze("FiltersView.Button.Cancel","Cancel")),g.a.createElement(xe.a,{quiet:!0,variant:"cta",onClick:function(){ie("effects"),e.apply()},disabled:!e.isDirty(),title:Ze("FiltersView.Button.Apply","Apply")},Ze("FiltersView.Button.Apply","Apply")))))}}]),n}(v.PureComponent),Hs=(n(549),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).filtersContainer=void 0,a.pointList=void 0,a.pointList=[],a.state={points:new Array},a.filtersContainer=g.a.createRef(),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),this.refresh()}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setFilterPoints",value:function(e){if(0===this.pointList.length)for(var t=0;t<e.length;t++)this.pointList.push(g.a.createRef());var n=this.state.points;e.length>0?n=e:n.splice(0,n.length),this.setState({points:n})}},{key:"refresh",value:function(){var e=this.state.points.slice();this.setState({points:e})}},{key:"render",value:function(){var e=this,t=this.state.points,n=this.props.controller.getEditor().getStage();return g.a.createElement("div",{id:"filtersContainer",className:"filters-container",ref:this.filtersContainer},t.map((function(t,a){var r=n.getCanvas(),i=r?r.width:100,o=r?r.height:100,s=$e.e.fromValues(t[0]*i,t[1]*o),l=n.pointFromStage(s);return l[0]-=8,l[1]-=8,g.a.createElement("div",{key:t[0]+t[1],className:"filters-point",style:{transform:"translate(".concat(l[0],"px, ").concat(l[1],"px)")},ref:e.pointList[a]})})))}}]),n}(v.PureComponent)),zs=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).editor=void 0,a.editor=e,a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Hs,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"getFiltersToolView",value:function(){return this.view}},{key:"getEditor",value:function(){return this.editor}},{key:"refresh",value:function(){var e;null===(e=this.getFiltersToolView())||void 0===e||e.refresh()}},{key:"move",value:function(){}}]),n}(F),Gs=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,T.effects,e)).filtersTool=void 0,a.undostack=void 0,a.filters=void 0,a.currentFilter=void 0,a.params=void 0,a.filterImageCache=void 0,a.trackPointData=void 0,a.filtersTool=new zs(Object(d.a)(a)),a.filters=Fs.getFilters(e),a.params={},a.filterImageCache=[],a.undostack=new ut(Object(Ft.clone)(a.params),50),a.checkDeepLinks(),a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Bs,{controller:this}),e);var t=this.doc.getStage().getToolLayer();t&&this.filtersTool.createView(t)}},{key:"destroyView",value:function(){this.filtersTool.destroyView(),this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"isDirty",value:function(){return this.canUndo()&&void 0!==this.params.filterId}},{key:"startEditor",value:function(e){if(Object(h.a)(Object(f.a)(n.prototype),"startEditor",this).call(this,e),this.params.filterId){var t=this.params.filterId,a=Object(Ft.find)(this.filters,(function(e){return e.getId()===t}));a&&this.setFilter(a)}}},{key:"endEditor",value:function(){this.doc.getStage().setMaskData(void 0),Us.resetInput(),Object(h.a)(Object(f.a)(n.prototype),"endEditor",this).call(this)}},{key:"hasUndoStack",value:function(){return!0}},{key:"undo",value:function(){var e;null===(e=this.undostack)||void 0===e||e.undo(),this.handleUndoRedo()}},{key:"redo",value:function(){var e;null===(e=this.undostack)||void 0===e||e.redo(),this.handleUndoRedo()}},{key:"handleUndoRedo",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.params=Object(Ft.clone)(this.undostack.getCurrent()),t=this.params.filterId,this.currentFilter=Object(Ft.find)(this.filters,(function(e){return e.getId()===t})),this.currentFilter){e.next=9;break}return null===(n=this.filtersTool.getFiltersToolView())||void 0===n||n.setFilterPoints([]),this.doc.getStage().setImageData(this.doc.getImageData()),this.doc.getStage().setMaskData(void 0),this.update(),e.abrupt("return");case 9:if(this.currentFilter.setIntensity(this.params.intensity||Vs),this.updateControlPoints((this.params.controlPoints||[]).slice()),!this.currentFilter.useCache()){e.next=15;break}a=this.loadFromCache(this.currentFilter.getId()),e.next=18;break;case 15:return e.next=17,this.currentFilter.apply();case 17:a=e.sent;case 18:a&&this.currentFilter.drawFilterImageData(a),this.update();case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"canUndo",value:function(){var e,t,n;return null!==(e=(null===(t=this.undostack)||void 0===t?void 0:t.canUndo())&&(null===(n=this.undostack)||void 0===n?void 0:n.getLength())>1)&&void 0!==e&&e}},{key:"canRedo",value:function(){var e,t;return null!==(e=null===(t=this.undostack)||void 0===t?void 0:t.canRedo())&&void 0!==e&&e}},{key:"canReset",value:function(){return this.canUndo()}},{key:"reset",value:function(){var e;this.isDirty()&&(this.params={},this.filters.forEach((function(e){return e.reset()})),this.addUndoStep(),null===(e=this.filtersTool.getFiltersToolView())||void 0===e||e.setFilterPoints([]),this.doc.getStage().setImageData(this.doc.getImageData()),this.doc.getStage().setMaskData(void 0),this.update())}},{key:"updateControlPoints",value:function(e){var t,n;null===(t=this.currentFilter)||void 0===t||t.setControlPoints(e),null===(n=this.filtersTool.getFiltersToolView())||void 0===n||n.setFilterPoints(e)}},{key:"addUndoStep",value:function(){this.undostack.add(Object(Ft.clone)(this.params))}},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty()){e.next=3;break}return this.cancel(),e.abrupt("return");case 3:if(this.currentFilter){e.next=5;break}return e.abrupt("return");case 5:if(n=null===(t=this.currentFilter)||void 0===t?void 0:t.getFinalImageData()){e.next=8;break}return e.abrupt("return");case 8:return this.doc.getStage().setImageData(n),e.next=11,this.doc.editorApply(n);case 11:this.doc.getStage().setMaskData(void 0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.doc.editorCancel()}},{key:"update",value:function(){var e;null===(e=this.getFiltersEditorView())||void 0===e||e.setParams(this.getParams()),this.doc.getDocActions().update(),this.filtersTool.refresh()}},{key:"getParams",value:function(){return{filterId:this.params.filterId,intensity:this.params.intensity,controlPoints:(this.params.controlPoints||[]).slice()}}},{key:"getFilters",value:function(){return this.filters}},{key:"setIntensity",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.params.intensity=t,null===(a=this.currentFilter)||void 0===a||a.setIntensity(t),n&&this.addUndoStep(),this.update();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setFilter",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===t||void 0===t?void 0:t.hasLoginNeeded())||P.getInstance().isSignedInUser()){e.next=3;break}return new os(Ze("SigninDialog.Message.PremiumSignin","This is a premium feature, please sign in for access."),T.effects).show(),e.abrupt("return");case 3:if(!this.isDirty()||this.params.filterId!==t.getId()){e.next=5;break}return e.abrupt("return");case 5:if(this.params.intensity=t.getIntensity(),this.params.filterId=t.getId(),this.params.controlPoints=t.getControlPoints().slice(),this.currentFilter=t,n=this.loadFromCache(t.getId())){e.next=23;break}return e.prev=11,e.next=14,t.apply();case 14:(n=e.sent)&&t.useCache()&&this.addToCache(t.getId(),n),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(11),console.error(e.t0),a=Ze("FiltersView.ModalDialog.Error.GenericErrorMessage","An error occured"),Object(E.error)(a,{timeout:3e3});case 23:n&&t.drawFilterImageData(n),this.addUndoStep(),this.updateControlPoints(t.getControlPoints()),this.update();case 27:case"end":return e.stop()}}),e,this,[[11,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"addToCache",value:function(e,t){this.filterImageCache.push({filterId:e,imageData:t})}},{key:"loadFromCache",value:function(e){var t;if(0!==this.filterImageCache.length)return null===(t=Object(Ft.find)(this.filterImageCache,{filterId:e}))||void 0===t?void 0:t.imageData}},{key:"checkDeepLinks",value:function(){var e,t,n=K.getParams();(null===(e=n.filters)||void 0===e?void 0:e.filter)&&(Object(Ft.find)(this.filters,(function(e){var t;return e.getDeepLinkId()===(null===(t=n.filters)||void 0===t?void 0:t.filter)}))&&(this.params.filterId=null===(t=this.currentFilter)||void 0===t?void 0:t.getId(),n.filters.filter=void 0,K.setParams(n)))}},{key:"getFiltersEditorView",value:function(){return this.view}},{key:"getStage",value:function(){return this.doc.getStage()}},{key:"onStageTransformChanged",value:function(){this.filtersTool.refresh()}},{key:"getControlPointIdxForPosition",value:function(e){for(var t,n=(null===(t=this.currentFilter)||void 0===t?void 0:t.getControlPoints())||[],a=0;a<n.length;a++){var r=$e.e.clone(n[a]),i=this.getStage().getCanvas();if(r[0]*=i?i.width:100,r[1]*=i?i.height:100,$e.e.distance(e,r)<=16)return a}return-1}},{key:"onPointerDown",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"onPointerDown",this).call(this,e);var t=this.getStage().eventToStage(e),a=this.getControlPointIdxForPosition(t);-1!==a&&(this.trackPointData={idx:a,startPoint:t})}},{key:"onPointerMove",value:function(e){if(Object(h.a)(Object(f.a)(n.prototype),"onPointerMove",this).call(this,e),this.trackPointData){var t,a=this.getStage().eventToStage(e),r=(null===(t=this.currentFilter)||void 0===t?void 0:t.getControlPoints().slice())||[],i=this.getStage().getCanvas(),o=i?i.width:100,s=i?i.height:100;r[this.trackPointData.idx]=$e.e.fromValues(a[0]/o,a[1]/s),this.updateControlPoints(r),this.update()}}},{key:"onPointerUp",value:function(e){if(Object(h.a)(Object(f.a)(n.prototype),"onPointerUp",this).call(this,e),this.trackPointData){var t,a=this.getStage().eventToStage(e),r=(null===(t=this.currentFilter)||void 0===t?void 0:t.getControlPoints().slice())||[],i=this.getStage().getCanvas(),o=i?i.width:100,s=i?i.height:100;r[this.trackPointData.idx]=$e.e.fromValues(a[0]/o,a[1]/s),this.updateControlPoints(r.slice()),this.params.controlPoints=r.slice(),this.addUndoStep(),this.update()}this.trackPointData=void 0}}]),n}(U),Ws=n(196);function Zs(){return(Zs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ys(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ks=g.a.createElement("style",{type:"text/css"},"\n\t.st0{fill:none;stroke:var(--spectrum-global-color-gray-700);stroke-linecap:round;}\n\t.st1{fill:var(--spectrum-global-color-gray-700);}\n"),Xs=g.a.createElement("g",{transform:"translate(-1125 -182)"},g.a.createElement("g",{transform:"translate(1125.5 182.5)"},g.a.createElement("line",{className:"st0",x1:0,y1:0,x2:14,y2:0}),g.a.createElement("line",{className:"st0",x1:14,y1:0,x2:14,y2:11})),g.a.createElement("g",{transform:"translate(1125.5 211.538)"},g.a.createElement("line",{className:"st0",x1:0,y1:19,x2:14,y2:19}),g.a.createElement("line",{className:"st0",x1:14,y1:8,x2:14,y2:19})),g.a.createElement("path",{className:"st1",d:"M1145,205.8h-0.5v-1c0-2.8-2.2-5-5-5s-5,2.2-5,5v1h-0.5c-0.3,0-0.5,0.2-0.5,0.5v8c0,0.3,0.2,0.5,0.5,0.5h11 c0.3,0,0.5-0.2,0.5-0.5v-8C1145.5,206,1145.3,205.8,1145,205.8z M1136.5,204.8c0-1.7,1.3-3,3-3s3,1.3,3,3v1h-6V204.8z  M1140.5,210.9v1.4c0,0.3-0.2,0.5-0.5,0.5h-1c-0.3,0-0.5-0.2-0.5-0.5v-1.4c-0.6-0.6-0.7-1.5-0.1-2.1c0.6-0.6,1.5-0.7,2.1-0.1 c0.6,0.6,0.7,1.5,0.1,2.1C1140.6,210.8,1140.5,210.8,1140.5,210.9z"})),qs=function(e){var t=e.svgRef,n=e.title,a=Ys(e,["svgRef","title"]);return g.a.createElement("svg",Zs({width:22,height:49.038,viewBox:"0 0 22 49.038",ref:t},a),n?g.a.createElement("title",null,n):null,Ks,Xs)},Js=g.a.forwardRef((function(e,t){return g.a.createElement(qs,Zs({svgRef:t},e))}));n.p;function Qs(){return(Qs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function $s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var el=g.a.createElement("style",{type:"text/css"},"\n\t.st0{fill:none;stroke:var(--spectrum-global-color-gray-700);stroke-width:1;stroke-linecap:round;stroke-miterlimit:3.9998;}\n\t.st1{fill:var(--spectrum-global-color-gray-700);}\n"),tl=g.a.createElement("line",{className:"st0",x1:.5,y1:.5,x2:14.5,y2:.5}),nl=g.a.createElement("line",{className:"st0",x1:14.5,y1:.5,x2:14.5,y2:11.5}),al=g.a.createElement("line",{className:"st0",x1:.5,y1:48.5,x2:14.5,y2:48.5}),rl=g.a.createElement("line",{className:"st0",x1:14.5,y1:37.5,x2:14.5,y2:48.5}),il=g.a.createElement("path",{className:"st1",d:"M19.8,23.8h-8.6v-2.8c0-1.7,1.3-3.1,3-3.2c0,0,0,0,0,0c1.2,0,2.2,0.7,2.8,1.7c0.2,0.3,0.1,0.6,0.4,0.6 c0,0,0.1,0,0.1,0l1.3-0.5c0.1,0,0.2-0.1,0.2-0.2c0-0.7-1.7-3.4-4.7-3.4c-2.8,0.1-5,2.3-5,5v2.9H8.8c-0.3,0-0.5,0.2-0.5,0.5v8 c0,0.3,0.2,0.5,0.5,0.5h11c0.3,0,0.5-0.2,0.5-0.5v-8C20.3,24,20,23.8,19.8,23.8z M15.3,28.9v1.4c0,0.3-0.2,0.5-0.5,0.5h-1 c-0.3,0-0.5-0.2-0.5-0.5v-1.4c-0.6-0.6-0.7-1.5-0.1-2.1c0.6-0.6,1.5-0.7,2.1-0.1c0.6,0.6,0.7,1.5,0.1,2.1 C15.3,28.8,15.3,28.8,15.3,28.9z"}),ol=function(e){var t=e.svgRef,n=e.title,a=$s(e,["svgRef","title"]);return g.a.createElement("svg",Qs({width:22,height:49.038,viewBox:"0 0 22 49.04",ref:t},a),n?g.a.createElement("title",null,n):null,el,tl,nl,al,rl,il)},sl=g.a.forwardRef((function(e,t){return g.a.createElement(ol,Qs({svgRef:t},e))})),ll=(n.p,n(74)),cl=n.n(ll),ul=n(43),dl=n.n(ul),hl=n(11),fl=(n(597),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={showMetricSystem:!O.hasUSEnglish()},a.toggleSystemInfo=a.toggleSystemInfo.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"toggleSystemInfo",value:function(){var e=this.state.showMetricSystem;this.setState({showMetricSystem:!e})}},{key:"render",value:function(){var e=this.state.showMetricSystem;return g.a.createElement("div",{className:"info-content"},e?g.a.createElement(hl.Table,{className:"table-content",quiet:!0},g.a.createElement(hl.THead,null,g.a.createElement(hl.TH,null,Ze("ResizeView.Help.PhotoSizes.Title","Common Photo Sizes")," (",g.a.createElement(dl.a,{href:"#",onClick:this.toggleSystemInfo},Ze("ResizeView.Help.PhotoSizes.Inches","Inches")),"/",g.a.createElement("strong",null,Ze("ResizeView.Help.PhotoSizes.Centimeters","cm")),")"),g.a.createElement(hl.TH,null,Ze("ResizeView.Help.PhotoSizes.GoodQuality","Good Quality")," (",Ze("ResizeView.Help.PhotoSizes.Pixels","Pixels"),")"),g.a.createElement(hl.TH,null,Ze("ResizeView.Help.PhotoSizes.BetterQuality","Better Quality")," (",Ze("ResizeView.Help.PhotoSizes.Pixels","Pixels"),")")),g.a.createElement(hl.TBody,null,g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"9 \xd7 13"),g.a.createElement(hl.TD,null,"630 \xd7 900"),g.a.createElement(hl.TD,null,"1050 \xd7 1500")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"10 \xd7 15"),g.a.createElement(hl.TD,null,"720 \xd7 1080"),g.a.createElement(hl.TD,null,"1200 \xd7 1800")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"13 \xd7 18"),g.a.createElement(hl.TD,null,"900 \xd7 1260"),g.a.createElement(hl.TD,null,"1500 \xd7 2100")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"15 \xd7 21"),g.a.createElement(hl.TD,null,"1080 \xd7 1530"),g.a.createElement(hl.TD,null,"1800 \xd7 2550")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"18 \xd7 24"),g.a.createElement(hl.TD,null,"1260 \xd7 1710"),g.a.createElement(hl.TD,null,"2100 \xd7 2850")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"20 \xd7 25"),g.a.createElement(hl.TD,null,"1400 \xd7 1770"),g.a.createElement(hl.TD,null,"2340 \xd7 2940")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"21 \xd7 30"),g.a.createElement(hl.TD,null,"1500 \xd7 2110"),g.a.createElement(hl.TD,null,"2490 \xd7 3510")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"30 \xd7 40"),g.a.createElement(hl.TD,null,"2160 \xd7 2850"),g.a.createElement(hl.TD,null,"3600 \xd7 4740")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"30 \xd7 45"),g.a.createElement(hl.TD,null,"2160 \xd7 3240"),g.a.createElement(hl.TD,null,"3600 \xd7 5400")))):g.a.createElement(hl.Table,{className:"table-content",quiet:!0},g.a.createElement(hl.THead,null,g.a.createElement(hl.TH,null,Ze("ResizeView.Help.PhotoSizes.Title","Common Photo Sizes")," (",g.a.createElement("strong",null,Ze("ResizeView.Help.PhotoSizes.Inches","Inches")),"/",g.a.createElement(dl.a,{href:"#",onClick:this.toggleSystemInfo},Ze("ResizeView.Help.PhotoSizes.Centimeters","cm")),")"),g.a.createElement(hl.TH,null,Ze("ResizeView.Help.PhotoSizes.GoodQuality","Good Quality")," (",Ze("ResizeView.Help.PhotoSizes.Pixels","Pixels"),")"),g.a.createElement(hl.TH,null,Ze("ResizeView.Help.PhotoSizes.BetterQuality","Better Quality")," (",Ze("ResizeView.Help.PhotoSizes.Pixels","Pixels"),")")),g.a.createElement(hl.TBody,null,g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"3.5 \xd7 5"),g.a.createElement(hl.TD,null,"630 \xd7 900"),g.a.createElement(hl.TD,null,"1050 \xd7 1500")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"4 \xd7 6"),g.a.createElement(hl.TD,null,"720 \xd7 1080"),g.a.createElement(hl.TD,null,"1200 \xd7 1800")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"5 \xd7 7"),g.a.createElement(hl.TD,null,"900 \xd7 1260"),g.a.createElement(hl.TD,null,"1500 \xd7 2100")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"6 \xd7 8"),g.a.createElement(hl.TD,null,"1080 \xd7 1440"),g.a.createElement(hl.TD,null,"1800 \xd7 2400")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"8 \xd7 10"),g.a.createElement(hl.TD,null,"1440 \xd7 1800"),g.a.createElement(hl.TD,null,"2400 \xd7 3000")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"8.5 \xd7 11"),g.a.createElement(hl.TD,null,"1530 \xd7 1980"),g.a.createElement(hl.TD,null,"2550 \xd7 3300")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"10 \xd7 14"),g.a.createElement(hl.TD,null,"1800 \xd7 2520"),g.a.createElement(hl.TD,null,"3000 \xd7 4200")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"11 \xd7 14"),g.a.createElement(hl.TD,null,"1980 \xd7 2520"),g.a.createElement(hl.TD,null,"3300 \xd7 4200")),g.a.createElement(hl.TR,null,g.a.createElement(hl.TD,null,"12 \xd7 18"),g.a.createElement(hl.TD,null,"2160 \xd7 3240"),g.a.createElement(hl.TD,null,"3600 \xd7 5400")))))}}]),n}(v.PureComponent)),pl=(n(598),99999),ml=99999,vl=1,gl=["-","+","e",".",","],bl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a,r,i;Object(c.a)(this,n),i=t.call(this,e);var o=K.getParams(),s=(null===(a=o.resize)||void 0===a?void 0:a.enlarger)||!1;return i.state={params:e.controller.getParams(),canReset:!1,showEnlargerTooltip:s},(null===(r=o.resize)||void 0===r?void 0:r.enlarger)&&(o.resize.enlarger=void 0,K.setParams(o)),i}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setParams",value:function(e,t){this.setState({params:e,canReset:t})}},{key:"handleInputKeyUp",value:function(e){var t=this.props.controller;"Enter"===e.key&&t.doResize(!0)}},{key:"refresh",value:function(){}},{key:"testNumberInput",value:function(e){gl.includes(e.key)&&e.preventDefault()}},{key:"hideTooltip",value:function(){this.setState({showEnlargerTooltip:!1})}},{key:"render",value:function(){var e=this,t=this.props.controller,n=this.state,a=n.params,r=n.canReset,i=n.showEnlargerTooltip;return g.a.createElement("div",{className:"editor-panel"},g.a.createElement("div",{className:"settings-right resize-settings-right"},g.a.createElement("div",{className:"settings-scrolling-content"},g.a.createElement("div",{className:"settings-header"},g.a.createElement("div",{className:"title"},Ze("ResizeView.Title.ResizeImage","Resize image")),g.a.createElement("div",{className:"reset-button"},g.a.createElement(xe.a,{quiet:!0,variant:"action",onClick:function(){t.reset()},icon:g.a.createElement(na.a,null),disabled:!r},Ze("ResizeView.Button.Reset","Reset")))),g.a.createElement("section",{style:{marginBottom:"0.5rem"}},g.a.createElement("div",{className:"size-params-left"},g.a.createElement("div",{className:"label-units-wrapper"},g.a.createElement(Se.a,{label:Ze("ResizeView.Controls.Field.Label.Width","Width")},g.a.createElement(cl.a,{id:"input-currentWidth",value:a.width,min:vl,max:pl,step:1,locale:O.getNormalizedCurrentLocale(),onChange:function(e){t.changeWidth(e)},onProgrammaticChange:function(){return t.doResize(!1)},onProgrammaticChangeStop:function(){return t.finishResize()},onBlur:function(e){t.changeWidth(Number(e.target.value).valueOf(),!0)},onKeyDown:this.testNumberInput,onKeyUp:function(t){return e.handleInputKeyUp(t)}})),g.a.createElement("div",{className:"label-units"},"px")),g.a.createElement("div",{className:"label-units-wrapper"},g.a.createElement(Se.a,{label:Ze("ResizeView.Controls.Field.Label.Height","Height")},g.a.createElement(cl.a,{id:"input-currentHeight",value:a.height,min:vl,max:pl,step:1,locale:O.getNormalizedCurrentLocale(),onChange:function(e){return t.changeHeight(e)},onProgrammaticChange:function(){return t.doResize(!1)},onProgrammaticChangeStop:function(){return t.finishResize()},onBlur:function(e){t.changeHeight(Number(e.target.value).valueOf(),!0)},onKeyDown:this.testNumberInput,onKeyUp:function(t){return e.handleInputKeyUp(t)}})),g.a.createElement("div",{className:"label-units"},"px")),g.a.createElement("div",{id:"aspect-ratio"},g.a.createElement(xe.a,{quiet:!0,variant:"action",onClick:function(){return t.toogleAspectRatio()},icon:a.hasAspectRatioFixed?g.a.createElement(Js,null):g.a.createElement(sl,null),tabIndex:-1,"aria-label":"Toggle Aspect Ratio",className:"aspect-ratio"}))),g.a.createElement("div",{className:"size-params-right"},g.a.createElement("div",{className:"label-units-wrapper"},g.a.createElement(je.a,{placement:"top",show:i,delayHide:100,onClick:function(){e.hideTooltip()},onHide:function(){e.hideTooltip()}},g.a.createElement(Se.a,{label:Ze("ResizeView.Controls.Field.Label.ScaleX","X-scale")},g.a.createElement(cl.a,{id:"input-scaleX",value:a.scaleX,min:vl,max:ml,step:1,locale:O.getNormalizedCurrentLocale(),onChange:function(e){t.changeScaleX(e)},onProgrammaticChange:function(){return t.doResize(!1)},onProgrammaticChangeStop:function(){t.finishResize()},onBlur:function(e){t.changeScaleX(Number(e.target.value).valueOf(),!0)},onKeyDown:this.testNumberInput,onKeyUp:function(t){return e.handleInputKeyUp(t)}})),g.a.createElement(Fe.a,{placement:"top"},Ze("ResizeView.Tooltip.Enlarger","Click arrow to desired enlargement"))),g.a.createElement("div",{className:"label-units"},"%")),g.a.createElement("div",{className:"label-units-wrapper"},g.a.createElement(Se.a,{label:Ze("ResizeView.Controls.Field.Label.ScaleY","Y-scale")},g.a.createElement(cl.a,{id:"input-scaleY",value:a.scaleY,min:vl,max:ml,step:1,locale:O.getNormalizedCurrentLocale(),onChange:function(e){return t.changeScaleY(e)},onProgrammaticChange:function(){return t.doResize(!1)},onProgrammaticChangeStop:function(){return t.finishResize()},onBlur:function(e){t.changeScaleY(Number(e.target.value).valueOf(),!0)},onKeyDown:this.testNumberInput,onKeyUp:function(t){return e.handleInputKeyUp(t)}})),g.a.createElement("div",{className:"label-units"},"%")))),g.a.createElement("section",null,g.a.createElement("div",{className:"image-size-container"},g.a.createElement("span",{className:"label"},Ze("ResizeView.Controls.ImageSize","Image size")),g.a.createElement("span",{className:"image-size"},a.imageSize))),g.a.createElement("div",{className:"settings-section-divider"}),g.a.createElement(fl,null)),g.a.createElement("div",{className:"action-button-container"},g.a.createElement(xe.a,{onClick:function(){ie("resizeCancel"),t.cancel()}},Ze("ResizeView.Button.Cancel","Cancel")),g.a.createElement(xe.a,{quiet:!0,variant:"cta",onClick:function(){ie("resize"),t.apply()},disabled:!r,title:Ze("ResizeView.Button.ResizeImage","Resize image")},Ze("ResizeView.Button.ResizeImage","Resize image")))))}}]),n}(v.PureComponent),yl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n),(a=t.call(this,T.resize,e)).maxEdgeLength=0,a.undostack=void 0,a.imageParams=void 0,a.originalImageParams=void 0,a.aspectRatio=void 0;var r=a.doc.getImageData();a.originalImageParams={width:r.width,height:r.height,scaleX:100,scaleY:100,hasAspectRatioFixed:!0,imageSize:O.humanFileSize(M.calcUncompressedImageSize(r.width,r.height))},a.aspectRatio=r.width/r.height,a.imageParams=Object(Ft.clone)(a.originalImageParams),a.undostack=new ut(Object(Ft.clone)(a.originalImageParams),50);var i=ct.getMaxCanvasSizes(),o=Object(Ws.a)(i,1)[0];return a.maxEdgeLength=o,a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(bl,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"startEditor",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"startEditor",this).call(this,e)}},{key:"endEditor",value:function(){Object(h.a)(Object(f.a)(n.prototype),"endEditor",this).call(this)}},{key:"hasUndoStack",value:function(){return!0}},{key:"canUndo",value:function(){return this.undostack.canUndo()}},{key:"canRedo",value:function(){return this.undostack.canRedo()}},{key:"isDirty",value:function(){return this.originalImageParams.width!==this.imageParams.width||this.originalImageParams.height!==this.imageParams.height}},{key:"canReset",value:function(){return this.isDirty()&&(this.canUndo()||this.canRedo())}},{key:"reset",value:function(){this.imageParams=Object(Ft.clone)(this.originalImageParams),this.aspectRatio=this.originalImageParams.width/this.originalImageParams.height,this.doc.getStage().setImageData(this.doc.getImageData()),this.doc.getStage().centerContent(),this.addUndoStep(),this.update()}},{key:"apply",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty()){e.next=3;break}return this.cancel(),e.abrupt("return");case 3:if(!(n=null===(t=this.doc.getStage().getCanvas())||void 0===t?void 0:t.getContext("2d"))){e.next=8;break}return e.next=7,this.doc.editorApply(n.getImageData(0,0,this.imageParams.width,this.imageParams.height),Ze("ResizeView.InfoToast.Message","Your image was resized"));case 7:(new Ee).showSurveyEditor("resize");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.isDirty()&&(new Ee).showSurveyEditor("resize"),this.doc.editorCancel()}},{key:"getParams",value:function(){return this.imageParams}},{key:"addUndoStep",value:function(){this.undostack.add(Object(Ft.clone)(this.imageParams)),this.update()}},{key:"undo",value:function(){this.undostack.undo(),this.imageParams=Object(Ft.clone)(this.undostack.getCurrent()),this.doResize(!1),this.update()}},{key:"redo",value:function(){this.undostack.redo(),this.imageParams=Object(Ft.clone)(this.undostack.getCurrent()),this.doResize(!1),this.update()}},{key:"changeWidth",value:function(e,t){if(e!==this.imageParams.width){var n=this.enforceEdgeLimits(e),a=this.imageParams.height;if(this.imageParams.hasAspectRatioFixed){a=this.calcHeight(n);var r=this.enforceEdgeLimits(a);r!==a&&(a=r,n=this.enforceEdgeLimits(this.calcWidth(a)))}this.imageParams.width=n,this.imageParams.height=a,this.imageParams.scaleX=this.calcScalePercent(this.imageParams.width,this.originalImageParams.width),this.imageParams.hasAspectRatioFixed&&(this.imageParams.scaleY=this.imageParams.scaleX),t&&this.doResize(!0),this.update()}}},{key:"changeHeight",value:function(e,t){if(e!==this.imageParams.height){var n=this.imageParams.width,a=this.enforceEdgeLimits(e);if(this.imageParams.hasAspectRatioFixed){n=this.calcWidth(a);var r=this.enforceEdgeLimits(n);r!==n&&(n=r,a=this.enforceEdgeLimits(this.calcHeight(n)))}this.imageParams.width=n,this.imageParams.height=a,this.imageParams.scaleY=this.calcScalePercent(this.imageParams.height,this.originalImageParams.height),this.imageParams.hasAspectRatioFixed&&(this.imageParams.scaleX=this.imageParams.scaleY),t&&this.doResize(!0),this.update()}}},{key:"changeScaleX",value:function(e,t){e!==this.imageParams.scaleX&&this.changeWidth(Math.floor(this.originalImageParams.width*e/100),t)}},{key:"changeScaleY",value:function(e,t){e!==this.imageParams.scaleY&&this.changeHeight(Math.floor(this.originalImageParams.height*e/100),t)}},{key:"toogleAspectRatio",value:function(){this.imageParams.hasAspectRatioFixed=!this.imageParams.hasAspectRatioFixed,this.imageParams.hasAspectRatioFixed&&(this.aspectRatio=this.imageParams.width/this.imageParams.height),this.update()}},{key:"calcWidth",value:function(e){return 0===this.imageParams.height||e<1?0:Math.max(1,Math.floor(this.aspectRatio*e))}},{key:"calcHeight",value:function(e){return 0===this.imageParams.width||e<1?0:Math.max(1,Math.floor(e/this.aspectRatio))}},{key:"calcScalePercent",value:function(e,t){return 0===t?0:Math.max(1,Math.round(e/t*100))}},{key:"update",value:function(){this.imageParams.imageSize=O.humanFileSize(M.calcUncompressedImageSize(this.imageParams.width,this.imageParams.height)),this.view.setParams(Object(Ft.clone)(this.imageParams),this.canReset()),this.doc.getDocActions().update()}},{key:"enforceEdgeLimits",value:function(e){return Math.max(Math.min(this.maxEdgeLength,e),32)}},{key:"doResize",value:function(e){var t=this.doc.getStage().getCanvas();if(this.imageParams.width!==(null===t||void 0===t?void 0:t.width)||this.imageParams.height!==(null===t||void 0===t?void 0:t.height)){var n=M.resizeImageData(this.doc.getImageData(),this.imageParams.width,this.imageParams.height);n&&(this.doc.getStage().setImageData(n),this.doc.getStage().centerContent(),e&&this.addUndoStep())}}},{key:"finishResize",value:function(){var e,t=null===(e=this.undostack)||void 0===e?void 0:e.getCurrent();t&&t.width===this.imageParams.width&&t.height===this.imageParams.height||(this.addUndoStep(),this.update())}}]),n}(U),El=(n(599),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).brushCursorPanelRef=void 0,a.state={params:e.controller.getParams()},a.brushCursorPanelRef=Object(v.createRef)(),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"getCursorView",value:function(){return this.brushCursorPanelRef.current}},{key:"updateView",value:function(e){this.setState({params:e})}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props.controller,t=this.state.params;return g.a.createElement("div",{className:"editor-panel"},(t.processing||!t.patchmatchReady)&&g.a.createElement(bt.a,{centered:!0}),g.a.createElement("div",{className:"settings-right spotheal-settings-right"},g.a.createElement("div",{className:"settings-scrolling-content"},g.a.createElement("div",{className:"settings-header"},g.a.createElement("div",{className:"title"},Ze("SpotHealView.Title.TouchUp","Touch Up")),g.a.createElement("div",{className:"reset-button"},g.a.createElement(xe.a,{quiet:!0,variant:"action",onClick:function(){e.reset()},icon:g.a.createElement(na.a,null),hidden:!0},Ze("SpotHealView.Button.Reset","Reset")))),g.a.createElement("section",null,g.a.createElement(Be.a,{renderLabel:!0,label:Ze("SpotHealView.Controls.Slider.Label.BrushSize","Brush size"),min:5,max:100,step:1,value:t.brushSize,onChange:function(t){return e.changeBrushSize(t)}})))))}}]),n}(v.PureComponent)),wl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,T.spotheal,e)).worker=void 0,a.isWorkerReady=void 0,a.isImageProcessing=void 0,a.hasDrawMask=void 0,a.brushSize=void 0,a.spotsHealed=void 0,a.cursor=void 0,a.alwaysPointerTracking=!0,a.isWorkerReady=!1,a.isImageProcessing=!1,a.hasDrawMask=!1,a.spotsHealed=0,a.brushSize=20,a.cursor=document.createElement("div"),a.cursor.id="brush-cursor",a.cursor.className="brush-cursor-panel",a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(El,{controller:this}),e),this.setCursor(),this.showCursor(!1);var t=this.doc.getStage().getToolLayer();t&&(t.appendChild(this.cursor),t.classList.add("cursor-none"))}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container);var e=this.doc.getStage().getToolLayer();e&&(e.removeChild(this.cursor),e.classList.remove("cursor-none")),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"startEditor",value:function(e){var t=this;Object(h.a)(Object(f.a)(n.prototype),"startEditor",this).call(this,e),this.doc.getStage().setMaskData(new ImageData(this.doc.getImageData().width,this.doc.getImageData().height)),this.worker=new Worker("/wasm/pm.worker.js"),this.worker.onmessage=function(e){if(t.worker&&t.worker===e.target){if("ready"===e.data.message){var n=e.data.binary;crypto.subtle.digest("SHA-256",n).then((function(e){"a888ee0586ced614e2b443c111d9b1882cb0c3061b15b473ec822c76ad6f47c8"!==Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("")?(console.debug("The WASM hash is incorrect"),t.worker&&t.worker.postMessage({type:"close"})):(console.debug("PM worker ready"),t.isWorkerReady=!0,t.updateViewParams())}))}if("spotheal_done"===e.data.message){var a=new ImageData(new Uint8ClampedArray(e.data.pixels),e.data.width,e.data.height);t.doc.addToUndoStack(a).then((function(){t.spotsHealed+=1,t.doc.getStage().setImageData(a),t.isImageProcessing=!1;var e=t.doc.getStage().getMaskCanvas();if(e){var n=null===e||void 0===e?void 0:e.getContext("2d");null===n||void 0===n||n.clearRect(0,0,e.width,e.height),e.style.opacity="1"}t.updateViewParams(),t.doc.getDocActions().update(),5===t.spotsHealed&&(new Ee).showSurveyEditor("spotheal")}))}}if("closed"===e.data.message){var r=e.target;r.onerror=null,r.onmessage=null,r.terminate(),console.debug("PM worker terminated")}},this.worker.onerror=function(e){t.doc.getDocActions().update(),console.error("PM worker failed: ".concat(e.message))}}},{key:"endEditor",value:function(){this.worker&&(this.worker.postMessage({type:"close"}),this.worker=void 0),this.isWorkerReady=!1,this.spotsHealed=0,this.resetParams(),this.doc.getStage().setMaskData(void 0),Object(h.a)(Object(f.a)(n.prototype),"endEditor",this).call(this)}},{key:"hasUndoStack",value:function(){return!1}},{key:"reset",value:function(){this.brushSize=20,this.updateViewParams()}},{key:"cancel",value:function(){this.isDirty()&&(new Ee).showSurveyEditor("spotheal"),this.doc.editorCancel()}},{key:"changeBrushSize",value:function(e){this.brushSize=e,this.setCursor(),this.updateViewParams()}},{key:"onPointerDown",value:function(e){if(Object(h.a)(Object(f.a)(n.prototype),"onPointerDown",this).call(this,e),this.doc.getStage().getZoomMode()===qe.NONE&&!this.isImageProcessing){var t=this.doc.getStage().getMaskCanvas();this.isWorkerReady&&t&&1===e.buttons&&(t.style.opacity="0.5",this.drawMask(e))}}},{key:"onPointerMove",value:function(e){if(Object(h.a)(Object(f.a)(n.prototype),"onPointerMove",this).call(this,e),this.updateCursorPos(e),1===e.buttons&&!this.doc.getStage().isPanningMode()&&this.doc.getStage().getZoomMode()===qe.NONE){if(this.isImageProcessing)return;if(!this.isWorkerReady)return;this.drawMask(e)}}},{key:"onPointerUp",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"onPointerUp",this).call(this,e),this.hasDrawMask&&this.applyMask()}},{key:"onPointerEnter",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"onPointerEnter",this).call(this,e);var t=this.doc.getStage().getMaskCanvas();t&&(t.style.zIndex="1",t.style.cursor="none"),this.showCursor(!0),this.updateCursorPos(e)}},{key:"onPointerLeave",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"onPointerLeave",this).call(this,e),this.hasDrawMask&&this.applyMask();var t=this.doc.getStage().getMaskCanvas();t&&(t.style.zIndex="auto",t.style.cursor="auto"),this.showCursor(!1)}},{key:"onGestureStart",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"onGestureStart",this).call(this,e)}},{key:"onGestureChange",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"onGestureChange",this).call(this,e)}},{key:"onGestureEnd",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"onGestureEnd",this).call(this,e)}},{key:"onZoomChange",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"onZoomChange",this).call(this,e),this.setCursor()}},{key:"onPanModeStart",value:function(){this.cursor.style.opacity="0"}},{key:"onPanModeEnd",value:function(){this.cursor.style.opacity="1"}},{key:"onZoomModeStart",value:function(){this.cursor.style.opacity="0"}},{key:"onZoomModeEnd",value:function(){this.cursor.style.opacity="1"}},{key:"getParams",value:function(){return{brushSize:this.brushSize,patchmatchReady:this.isWorkerReady,processing:this.isImageProcessing}}},{key:"resetParams",value:function(){this.isImageProcessing=!1,this.hasDrawMask=!1}},{key:"applyMask",value:function(){var e,t=this.doc.getStage().getMaskCanvas(),n=this.doc.getStage().getCanvas();if(n&&t&&this.isWorkerReady&&this.hasDrawMask){var a=t.getContext("2d"),r=n.getContext("2d");if(a&&r){this.hasDrawMask=!1,this.isImageProcessing=!0,this.doc.getDocActions().disableUndoRedo();var i=r.getImageData(0,0,this.doc.getImageData().width,this.doc.getImageData().height),o=a.getImageData(0,0,t.width,t.height),s=M.createBitmask(o);null===(e=this.worker)||void 0===e||e.postMessage({type:"spotheal",width:i.width,height:i.height,pixels:i.data.buffer,mask:s.buffer},[i.data.buffer,s.buffer]),this.updateViewParams()}}}},{key:"drawMask",value:function(e){var t=this.doc.getStage().getMaskCanvas();if(t){var n=this.doc.getStage().eventToStage(e),a=n[0],r=n[1],i=this.brushSize/2;if(!(a<0-i||r<0-i||a>(null===t||void 0===t?void 0:t.width)+i||r>(null===t||void 0===t?void 0:t.height)+i)){var o=t.getContext("2d");o&&(this.hasDrawMask||o.beginPath(),o.strokeStyle="rgba(48, 48, 48)",o.lineWidth=2*i,o.lineTo(a,r),o.stroke(),o.beginPath(),o.arc(a,r,i,0,2*Math.PI),o.fillStyle="rgba(48, 48, 48)",o.fill(),o.beginPath(),o.moveTo(a,r),this.hasDrawMask=!0)}}}},{key:"updateViewParams",value:function(){this.view.updateView(this.getParams())}},{key:"updateCursorPos",value:function(e){var t=this.doc.getStage().getZoomFactor(),n=this.doc.getStage().eventToLocal(e),a=n[0]-this.brushSize*t,r=n[1]-this.brushSize*t;this.cursor.style.left="".concat(a,"px"),this.cursor.style.top="".concat(r,"px")}},{key:"setCursor",value:function(){var e=this.doc.getStage().getZoomFactor(),t=2*this.brushSize*e+10,n=this.brushSize*e,a=3;this.brushSize<8&&(a=1),this.brushSize<10&&(a=2),this.cursor.innerHTML='<svg height="'.concat(t,'" width="').concat(t,'" xmlns="http://www.w3.org/2000/svg">      <circle cx="').concat(n,'" cy="').concat(n,'" r="').concat(n/2,'" stroke="#303030" stroke-width="1px" fill="none"></circle>      <circle cx="').concat(n,'" cy="').concat(n,'" r="').concat(n/2-1,'" stroke="#eeeeee" stroke-width="1px" fill="none"></circle>      <line x1="').concat(n,'" y1="').concat(n-a,'" x2="').concat(n,'" y2="').concat(n+a,'" stroke="#888888" stroke-width="1px"></line>      <line x1="').concat(n-a,'" y1="').concat(n,'" x2="').concat(n+a,'" y2="').concat(n,'" stroke="#888888" stroke-width="1px"></line>    </svg>')}},{key:"showCursor",value:function(e){this.cursor.style.visibility=e?"visible":"hidden"}}]),n}(U),xl=(n(600),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"handleClose",value:function(){this.props.controller.close()}},{key:"render",value:function(){var e=this;return g.a.createElement(fe.a,{title:"Settings"},g.a.createElement("div",{className:"dialog-close"},g.a.createElement(xe.a,{variant:"tool",onClick:function(){return e.handleClose()},icon:g.a.createElement(Oe.a,{style:{color:"var(--spectrum-global-color-gray-50)"}})})),g.a.createElement("div",null,g.a.createElement("span",null,"settings go here")))}}]),n}(v.PureComponent)),kl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).dialogId=void 0,e}return Object(u.a)(n,[{key:"show",value:function(){this.dialogId=j.a.show(g.a.createElement(xl,{controller:this}))}},{key:"close",value:function(){this.dialogId&&j.a.hide(this.dialogId)}}]),n}(F),Sl=n(191),Cl=n.n(Sl),Ol=n(58);function Pl(){return(Pl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Tl(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ml=g.a.createElement("path",{className:"fill",d:"M34,14a12,12,0,0,0-23.483-3.483,12.038,12.038,0,0,1,2.3-.457A10,10,0,1,1,25.94,23.185a12.038,12.038,0,0,1-.457,2.3A12,12,0,0,0,34,14Z"}),Il=g.a.createElement("rect",{className:"fill",x:14,y:12,width:2,height:2}),Al=g.a.createElement("rect",{className:"fill",x:12,y:14,width:2,height:2}),Rl=g.a.createElement("rect",{className:"fill",x:14,y:16,width:2,height:2}),Dl=g.a.createElement("rect",{className:"fill",x:12,y:18,width:2,height:2}),jl=g.a.createElement("rect",{className:"fill",x:14,y:20,width:2,height:2}),_l=g.a.createElement("rect",{className:"fill",x:16,y:22,width:2,height:2}),Ll=g.a.createElement("rect",{className:"fill",x:16,y:18,width:2,height:2}),Nl=g.a.createElement("rect",{className:"fill",x:16,y:14,width:2,height:2}),Vl=g.a.createElement("rect",{className:"fill",x:18,y:16,width:2,height:2}),Fl=g.a.createElement("rect",{className:"fill",x:18,y:20,width:2,height:2}),Ul=g.a.createElement("path",{className:"fill",d:"M24,25.817V24H22v2a11.986,11.986,0,0,1-2-.18V24H18v1.3a11.939,11.939,0,0,1-2-.922V24h-.628A11.886,11.886,0,0,1,14,22.926V22h-.926A12.173,12.173,0,0,1,12,20.628V20h-.381a11.856,11.856,0,0,1-.921-2H12V16H10.18A11.986,11.986,0,0,1,10,14h2V12H10.183a12.068,12.068,0,0,1,.334-1.482A12,12,0,1,0,25.483,25.482,12.128,12.128,0,0,1,24,25.817Z"}),Bl=g.a.createElement("rect",{className:"fill",x:20,y:22,width:2,height:2}),Hl=g.a.createElement("rect",{className:"fill",x:22,y:20,width:2,height:2}),zl=g.a.createElement("rect",{className:"fill",x:20,y:18,width:2,height:2}),Gl=g.a.createElement("rect",{className:"fill",x:22,y:16,width:2,height:2}),Wl=g.a.createElement("rect",{className:"fill",x:20,y:14,width:2,height:2}),Zl=g.a.createElement("rect",{className:"fill",x:18,y:12,width:2,height:2}),Yl=g.a.createElement("path",{className:"fill",d:"M26,22H24v2h1.817A11.881,11.881,0,0,0,26,22Z"}),Kl=g.a.createElement("path",{className:"fill",d:"M25.3,18H24v2h1.82A11.908,11.908,0,0,0,25.3,18Z"}),Xl=g.a.createElement("path",{className:"fill",d:"M24,15.372V16h.381C24.259,15.788,24.135,15.576,24,15.372Z"}),ql=g.a.createElement("path",{className:"fill",d:"M12,12h2V10a11.881,11.881,0,0,0-2,.183Z"}),Jl=g.a.createElement("path",{className:"fill",d:"M16,10.18V12h2V10.7A11.908,11.908,0,0,0,16,10.18Z"}),Ql=g.a.createElement("path",{className:"fill",d:"M20,11.619V12h.628C20.424,11.865,20.212,11.741,20,11.619Z"}),$l=g.a.createElement("path",{className:"fill",d:"M22,13.074V14h.926A11.9,11.9,0,0,0,22,13.074Z"}),ec=function(e){var t=e.svgRef,n=e.title,a=Tl(e,["svgRef","title"]);return g.a.createElement("svg",Pl({id:"spectrum-icon-18-Adjust",width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,Ml,Il,Al,Rl,Dl,jl,_l,Ll,Nl,Vl,Fl,Ul,Bl,Hl,zl,Gl,Wl,Zl,Yl,Kl,Xl,ql,Jl,Ql,$l)},tc=g.a.forwardRef((function(e,t){return g.a.createElement(ec,Pl({svgRef:t},e))}));n.p;function nc(){return(nc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ac(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var rc=g.a.createElement("path",{className:"fill",d:"M24,22h4V9a1,1,0,0,0-1-1H14v4H24Z"}),ic=g.a.createElement("path",{className:"fill",d:"M12,24V3a1,1,0,0,0-1-1H9A1,1,0,0,0,8,3V8H3A1,1,0,0,0,2,9v2a1,1,0,0,0,1,1H8V27a1,1,0,0,0,1,1H24v5a1,1,0,0,0,1,1h2a1,1,0,0,0,1-1V28h5a1,1,0,0,0,1-1V25a1,1,0,0,0-1-1Z"}),oc=function(e){var t=e.svgRef,n=e.title,a=ac(e,["svgRef","title"]);return g.a.createElement("svg",nc({id:"spectrum-icon-18-Crop",width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,rc,ic)},sc=g.a.forwardRef((function(e,t){return g.a.createElement(oc,nc({svgRef:t},e))}));n.p;function lc(){return(lc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function cc(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var uc=g.a.createElement("path",{className:"fill",d:"M29.912,22.12c0-.007.035-.028.026-.028A8.481,8.481,0,0,1,22.8,18.074c-.017-.028-.046-.047-.065-.074.019-.027.048-.046.065-.074a8.481,8.481,0,0,1,7.142-4.018c.009,0-.023-.021-.026-.028a5.917,5.917,0,1,0-3.93-1.588l-6.47,3.444-12.6-6.7a4,4,0,0,0-3.8.023L.822,10.313,15.26,18,.822,25.687l2.292,1.255a4,4,0,0,0,3.8.023l12.6-6.7,6.47,3.444a5.892,5.892,0,1,0,3.93-1.588Zm.367-18.038a3.933,3.933,0,1,1-4.2,3.641A3.932,3.932,0,0,1,30.279,4.082Zm0,27.836a3.933,3.933,0,1,1,3.641-4.2A3.933,3.933,0,0,1,30.279,31.918Z"}),dc=function(e){var t=e.svgRef,n=e.title,a=cc(e,["svgRef","title"]);return g.a.createElement("svg",lc({id:"spectrum-icon-18-Cutout",width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,uc)},hc=g.a.forwardRef((function(e,t){return g.a.createElement(dc,lc({svgRef:t},e))}));n.p;function fc(){return(fc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function pc(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var mc=g.a.createElement("path",{className:"fill",d:"M33,4H11a1,1,0,0,0-1,1V16H3a1,1,0,0,0-1,1V29a1,1,0,0,0,1,1H18a1,1,0,0,0,1-1V24H33a1,1,0,0,0,1-1V5A1,1,0,0,0,33,4ZM17,28H4V18h6v5a1,1,0,0,0,1,1h6Zm0-6H12V18h5Zm15,0H19V17a1,1,0,0,0-1-1H12V6H32Z"}),vc=g.a.createElement("path",{id:"arrow_fill","data-name":"arrow fill",className:"fill",d:"M20.49,16.1l5.131-5.132L23.646,8.99A.5.5,0,0,1,24,8.136h5.863V14a.5.5,0,0,1-.854.354l-1.975-1.975L21.9,17.511a.5.5,0,0,1-.707,0l-.7-.711A.5.5,0,0,1,20.49,16.1Z"}),gc=function(e){var t=e.svgRef,n=e.title,a=pc(e,["svgRef","title"]);return g.a.createElement("svg",fc({id:"spectrum-icon-18-Resize",width:36,height:36,viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,mc,vc)},bc=g.a.forwardRef((function(e,t){return g.a.createElement(gc,fc({svgRef:t},e))}));n.p;function yc(){return(yc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ec(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var wc,xc=g.a.createElement("path",{className:"fill",d:"M32.728,3.272a6,6,0,0,0-8.485,0L17.787,9.728,3.272,24.243a6,6,0,0,0,8.485,8.485L17.7,26.781,32.728,11.757a6,6,0,0,0,0-8.485ZM19,11a2,2,0,1,1-2,2A2,2,0,0,1,19,11ZM13,21a2,2,0,1,1,2-2A2,2,0,0,1,13,21Zm4,4a2,2,0,1,1,2-2A2,2,0,0,1,17,25Zm6-6a2,2,0,1,1,2-2A2,2,0,0,1,23,19Z"}),kc=g.a.createElement("path",{className:"fill",d:"M18.453,4.343l1.309-1.512A11.923,11.923,0,0,0,14.449.182l-.42,1.955A9.98,9.98,0,0,1,18.453,4.343ZM10.711,1.985,10.472,0h-.007A12.1,12.1,0,0,0,4.946,2.144l-.006,0,0,0L6.1,3.776A9.988,9.988,0,0,1,10.711,1.985ZM1.986,10.746A9.99,9.99,0,0,1,3.757,6.13L2.127,4.971A11.958,11.958,0,0,0,0,10.514Zm2.389,7.732a9.979,9.979,0,0,1-2.224-4.416L.2,14.49a11.933,11.933,0,0,0,2.671,5.3Z"}),Sc=function(e){var t=e.svgRef,n=e.title,a=Ec(e,["svgRef","title"]);return g.a.createElement("svg",yc({id:"spectrum-icon-18-SpotHeal",viewBox:"0 0 36 36",ref:t},a),n?g.a.createElement("title",null,n):null,xc,kc)},Cc=g.a.forwardRef((function(e,t){return g.a.createElement(Sc,yc({svgRef:t},e))})),Oc=(n.p,n(608),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={selectedEditorId:e.selectedEditorId},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setSelectedEditorId",value:function(e){e!==this.state.selectedEditorId&&this.setState({selectedEditorId:e})}},{key:"onSelect",value:function(e){e!==this.state.selectedEditorId&&this.props.controller.onSelect(e),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}},{key:"render",value:function(){var e=this,t=this.props,n=t.editorIds,a=t.controller,r=this.state.selectedEditorId;return g.a.createElement("div",{className:"nav-container"},g.a.createElement("nav",{className:"app-sidenav"},g.a.createElement("h2",{className:"leftNav-heading"},Ze("App.Navigation.Left.Headline.Label","Edit image")),g.a.createElement(Ol.SideNav,{onSelect:function(t){return e.onSelect(t)},value:r,className:"customSidebar"},n.map((function(e){switch(e){case T.spotheal:return g.a.createElement(Ol.SideNavItem,{key:e,value:e,icon:g.a.createElement(nr.a,null,g.a.createElement(Cc,null)),className:"sidenav-item"},Ze("App.Navigation.Left.TouchUp","Touch Up"));case T.crop:return g.a.createElement(Ol.SideNavItem,{key:e,value:e,icon:g.a.createElement(nr.a,null,g.a.createElement(sc,null)),className:"sidenav-item"},Ze("App.Navigation.Left.Crop","Crop and straighten"));case T.resize:return g.a.createElement(Ol.SideNavItem,{key:e,value:e,icon:g.a.createElement(nr.a,null,g.a.createElement(bc,null)),className:"sidenav-item"},Ze("App.Navigation.Left.Resize","Resize image"));case T.cutout:return g.a.createElement(Ol.SideNavItem,{key:e,value:e,icon:g.a.createElement(nr.a,null,g.a.createElement(hc,null)),className:"sidenav-item"},Ze("App.Navigation.Left.CutOut","Remove background"));case T.adjust:return g.a.createElement(Ol.SideNavItem,{key:e,value:e,icon:g.a.createElement(nr.a,null,g.a.createElement(tc,null)),className:"sidenav-item"},Ze("App.Navigation.Left.AdjustImage","Adjust image"));case T.effects:return g.a.createElement(Ol.SideNavItem,{key:e,value:e,icon:g.a.createElement(nr.a,null,g.a.createElement(Cl.a,null)),className:"sidenav-item"},Ze("App.Navigation.Left.Filters","Art effects"));default:throw new Error("unknown editor")}})))),g.a.createElement("div",{className:"legal-notice"},g.a.createElement(xe.a,{quiet:!0,variant:"action",onClick:function(){return a.toggleFooter()},className:"button-legal-notice"},Ze("Footer.title","Legal Notices"))))}}]),n}(v.PureComponent)),Pc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).doc=void 0,a.doc=e,a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Oc,{controller:this,editorIds:this.doc.getEditorIds()}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewDidMount",this).call(this,e)}},{key:"viewWillUnmount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewWillUnmount",this).call(this,e)}},{key:"setSelectedEditorId",value:function(e){var t;null===(t=this.getToolbarView())||void 0===t||t.setSelectedEditorId(e)}},{key:"onSelect",value:function(e){this.doc.setEditor(e)}},{key:"showSettings",value:function(){(new kl).show()}},{key:"toggleFooter",value:function(){this.doc.toggleFooter()}},{key:"getToolbarView",value:function(){return this.view}}]),n}(F),Tc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,a,r,i,o,s){var l;if(Object(c.a)(this,n),(l=t.call(this)).app=void 0,l.stage=void 0,l.toolbar=void 0,l.docActions=void 0,l.undostack=void 0,l.currentEditor=void 0,l.fileName=void 0,l.fileType=void 0,l.isSampleImage=void 0,l.hotkeys=void 0,l.hotkeysEnabled=void 0,l.app=e,l.fileName=r,l.fileType=r,l.isSampleImage=o,l.stage=new ct(Object(d.a)(l)),l.toolbar=new Pc(Object(d.a)(l)),l.docActions=new Mt(Object(d.a)(l)),l.hotkeys=new xa(Object(d.a)(l)),s)l.undostack=s;else{var u=new ft(10);u.add(a,r,i,o,!0);var h=new ut(a,10);l.undostack=new Qe(h,u)}return l.hotkeysEnabled=new Map(Object.values(Qn).map((function(e){return[e,!0]}))),l}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Vt,{controller:this,loading:!0}),e),this.app.getNavBar().setActionsController(this.docActions),this.hotkeys.addEventListener()}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this),this.hotkeys.removeEventListener()}},{key:"viewDidMount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewDidMount",this).call(this,e),this.createViews()}},{key:"viewWillUnmount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewWillUnmount",this).call(this,e)}},{key:"createViews",value:function(){this.toolbar.createView(this.ensureHTMLElement("toolbar-container")),this.stage.createView(this.ensureHTMLElement("stage-container"));var e=this;window.requestAnimationFrame((function(){e.stage.zoomFit(),e.stage.centerContent(),e.setLoading(!1)}))}},{key:"close",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getFileName",value:function(){return this.fileName}},{key:"getFileType",value:function(){return this.fileType}},{key:"isFileSampleImage",value:function(){return this.isSampleImage}},{key:"getStage",value:function(){return this.stage}},{key:"getDocActions",value:function(){return this.docActions}},{key:"getImageData",value:function(){return this.undostack.getCurrent()}},{key:"undo",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentEditor||!this.currentEditor.hasUndoStack()){e.next=4;break}return this.currentEditor.undo(),this.docActions.update(),e.abrupt("return");case 4:if(!this.canUndo()){e.next=10;break}return e.next=7,this.undostack.undo();case 7:this.stage.setImageData(this.undostack.getCurrent()),this.stage.centerContent(),this.docActions.update();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"redo",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentEditor||!this.currentEditor.hasUndoStack()){e.next=4;break}return this.currentEditor.redo(),this.docActions.update(),e.abrupt("return");case 4:if(!this.canRedo()){e.next=10;break}return e.next=7,this.undostack.redo();case 7:this.stage.setImageData(this.undostack.getCurrent()),this.stage.centerContent(),this.docActions.update();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"canUndo",value:function(){return this.currentEditor&&this.currentEditor.hasUndoStack()?this.currentEditor.canUndo():this.undostack.canUndo()}},{key:"canRedo",value:function(){return this.currentEditor&&this.currentEditor.hasUndoStack()?this.currentEditor.canRedo():this.undostack.canRedo()}},{key:"showSaveImage",value:function(){var e=this;if(this.currentEditor&&this.currentEditor.isDirty()){var t=this.currentEditor.getId();new Rt(t,(function(t){var n;t===wt.apply?null===(n=e.currentEditor)||void 0===n||n.apply().then((function(){new Je(e).show()})):t===wt.discard&&new Je(e).show()})).show()}else new Je(this).show()}},{key:"saveImage",value:function(e,t,n){var a=new R(this);return a.canDownload()?(a.download(e,t,n),!0):(ie("signInToTryMore"),new Nt(this,Ze("LoginDialog.UnlimitedDownloads.Message","Log in or create a free account to get access to unlimited downloads.")).show(),!1)}},{key:"showOpenImage",value:function(){var e,t=this,n=(null===(e=this.currentEditor)||void 0===e?void 0:e.isDirty())||this.undostack.canUndo()||this.undostack.canRedo();if(this.currentEditor&&n){var a=this.currentEditor.getId();new jt(a,(function(e){var n;e===wt.apply&&new Et(t.app,null===(n=t.currentEditor)||void 0===n?void 0:n.getId()).show()})).show()}else{var r;new Et(this.app,null===(r=this.currentEditor)||void 0===r?void 0:r.getId()).show()}}},{key:"openDragImage",value:function(e){var t,n=this,a=(null===(t=this.currentEditor)||void 0===t?void 0:t.isDirty())||this.undostack.canUndo()||this.undostack.canRedo();if(this.currentEditor&&a){var r=this.currentEditor.getId();new jt(r,(function(t){t===wt.apply&&Et.readFile(n.app,e,e.name,e.type,!1)})).show()}else Et.readFile(this.app,e,e.name,e.type,!1)}},{key:"showLogin",value:function(){var e=this;if(this.currentEditor&&this.currentEditor.isDirty()){var t=this.currentEditor.getId();new _t(t,(function(t){var n;if(t===wt.apply)null===(n=e.currentEditor)||void 0===n||n.apply().then((function(){var t;P.getInstance().loginUser(null===(t=e.currentEditor)||void 0===t?void 0:t.getId())}));else if(t===wt.discard){var a;P.getInstance().loginUser(null===(a=e.currentEditor)||void 0===a?void 0:a.getId())}})).show()}else{var n;P.getInstance().loginUser(null===(n=this.currentEditor)||void 0===n?void 0:n.getId())}}},{key:"addToUndoStack",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.undostack.add(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"editorApply",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.undostack.add(t);case 2:this.setEditor(null,!1),n&&n.length>0&&Object(E.info)(n,{timeout:3e3});case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"editorCancel",value:function(){this.setEditor(null,!1),this.stage.setImageData(this.getImageData()),this.stage.centerContent()}},{key:"getEditorIds",value:function(){return"".concat("spotheal,crop,resize,adjust,cutout,effects").split(",")}},{key:"setEditor",value:function(e){var t,n,a=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e!==this.currentEditor&&e!==(null===(t=this.currentEditor)||void 0===t?void 0:t.getId()))if(r&&(null===(n=this.currentEditor)||void 0===n?void 0:n.isDirty())){var i=this.currentEditor.getId();new Dt(i,(function(t){var n;if(t===wt.apply)null===(n=a.currentEditor)||void 0===n||n.apply().then((function(){a.switchEditor(e)}));else if(t===wt.discard){var r;null===(r=a.currentEditor)||void 0===r||r.cancel(),a.switchEditor(e)}})).show()}else this.switchEditor(e)}},{key:"switchEditor",value:function(e){var t,n,a;if(void 0!==this.currentEditor&&window.history.replaceState(null,"",e?"/".concat(T[e]):"/"),this.currentEditor&&(this.currentEditor.endEditor(),ce("editor:".concat(this.currentEditor.getId()))),this.currentEditor=null,e){var r;this.currentEditor=this.createEditor(e);var i=this.ensureHTMLElement("editor-container");null===(r=this.currentEditor)||void 0===r||r.startEditor(i)}this.docActions.update(),this.toolbar.setSelectedEditorId(null===(t=this.currentEditor)||void 0===t?void 0:t.getId()),this.getStage().setZoomMode(qe.NONE),null===(n=this.getDocView())||void 0===n||n.setEditorId(null===(a=this.currentEditor)||void 0===a?void 0:a.getId());var o=this;window.requestAnimationFrame((function(){o.stage.editorChanged()})),this.currentEditor&&(se("editor:".concat(this.currentEditor.getId())),pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Editor","event.type":"click","event.subtype":"editor","event.value":this.currentEditor.getId()}))}},{key:"createEditor",value:function(e){switch(e){case T.spotheal:return new wl(this);case T.crop:return new qo(this);case T.resize:return new yl(this);case T.adjust:return new Ea(this);case T.cutout:return new Ms(this);case T.effects:return new Gs(this);default:return null}}},{key:"getCurrentEditor",value:function(){return this.currentEditor||void 0}},{key:"evalDeeplinkActions",value:function(){var e,t,n=K.getParams();("convert"===(null===(e=n.globalAction)||void 0===e?void 0:e.action)||"compress"===(null===(t=n.globalAction)||void 0===t?void 0:t.action))&&(this.showSaveImage(),n.globalAction.action=void 0,K.setParams(n))}},{key:"toggleFooter",value:function(){this.app.getFooter().toggleFooter()}},{key:"getHotKeysEnabled",value:function(){var e=[];return this.hotkeysEnabled.forEach((function(t,n){t&&e.push(n)})),e}},{key:"setHotKeysEnabled",value:function(e){var t=this;this.hotkeysEnabled.forEach((function(n,a){e.includes(a)&&t.hotkeysEnabled.set(a,e.includes(a))}))}},{key:"setHotKeysDisabled",value:function(e){var t=this;this.hotkeysEnabled.forEach((function(n,a){t.hotkeysEnabled.set(a,!e.includes(a)),e.includes(a)&&t.hotkeysEnabled.set(a,!e.includes(a))}))}},{key:"setLoading",value:function(e){var t;null===(t=this.getDocView())||void 0===t||t.setLoading(e)}},{key:"onPointerDown",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerDown(e)}},{key:"onPointerMove",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerMove(e)}},{key:"onPointerUp",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerUp(e)}},{key:"onPointerEnter",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerEnter(e)}},{key:"onPointerOut",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerOut(e)}},{key:"onPointerLeave",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerLeave(e)}},{key:"onGestureStart",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onGestureStart(e)}},{key:"onGestureChange",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onGestureChange(e)}},{key:"onGestureEnd",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onGestureEnd(e)}},{key:"onZoomChange",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onZoomChange(e)}},{key:"onContainerSizeChanged",value:function(e,t){var n;null===(n=this.currentEditor)||void 0===n||n.onContainerSizeChanged(e,t)}},{key:"onPanModeStart",value:function(){var e;null===(e=this.currentEditor)||void 0===e||e.onPanModeStart()}},{key:"onPanModeEnd",value:function(){var e;null===(e=this.currentEditor)||void 0===e||e.onPanModeEnd()}},{key:"onZoomModeStart",value:function(){var e;null===(e=this.currentEditor)||void 0===e||e.onZoomModeStart()}},{key:"onZoomModeEnd",value:function(){var e;null===(e=this.currentEditor)||void 0===e||e.onZoomModeEnd()}},{key:"getDocView",value:function(){return this.view}}]),n}(F);!function(e){e.click="click",e.display="display"}(wc||(wc={}));var Mc=function(){function e(){Object(c.a)(this,e),this.tests=void 0}return Object(u.a)(e,[{key:"loadTests",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.tests=new Map,"".concat("agedashi:app:adjustments").split(",").forEach((function(e){var t;null===(t=a.tests)||void 0===t||t.set(e,void 0)})),t=Object(Ft.map)(Array.from(this.tests.keys()),(function(e,t){return{index:t+1,name:e}})),n=0;case 5:if(!(n<10)||void 0!==window.adobe&&void 0!==window.adobe.target){e.next=11;break}return e.next=8,O.wait(100);case 8:n+=1,e.next=5;break;case 11:if(void 0!==window.adobe&&void 0!==window.adobe.target){e.next=14;break}return console.error("target could not be loaded"),e.abrupt("return",Promise.resolve());case 14:return e.abrupt("return",new Promise((function(e,n){window.adobe.target.getOffers({request:{property:{token:"2bb70f5a-cc1f-79c3-a659-66e4e32dc3fc"},prefetch:{mboxes:t}},timeout:3e3}).then((function(t){console.log("getOffers",t),t.prefetch&&t.prefetch.mboxes.forEach((function(e){var t;e.options&&e.options.length>0&&"json"===e.options[0].type&&(null===(t=a.tests)||void 0===t||t.set(e.name,e))})),e()})).catch((function(t){console.error(t),e()}))})));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTestContent",value:function(e){if(!this.tests)throw new Error("load tests first!");var t=this.tests.get(e);return null===t||void 0===t?void 0:t.options[0].content}},{key:"sendNotification",value:function(e,t){if(!this.tests)throw new Error("load tests first!");var n=this.tests.get(e);n&&window.adobe.target.sendNotifications({request:{notifications:[{id:V.a.v4(),type:t,timestamp:Date.now(),tokens:n.options.map((function(e){return e.eventToken})),mbox:{name:n.name,state:n.state}}]}})}}],[{key:"getInstance",value:function(){return e.instance}}]),e}();Mc.instance=new Mc;var Ic=n(56),Ac=n.n(Ic),Rc=(n(619),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n),a=t.call(this,e);var r=K.getParam("theme")||"light",i=K.getParam("scale")||"medium";return a.state={theme:r,scale:i,loading:e.loading},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),se("editor:home")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),ce("editor:home")}},{key:"refresh",value:function(){}},{key:"setTheme",value:function(e){this.setState({theme:e})}},{key:"setLoading",value:function(e){this.setState({loading:e})}},{key:"render",value:function(){var e=this.state,t=e.theme,n=e.scale,a=e.loading;return g.a.createElement(Ac.a,{theme:t,scale:n,typekitId:"glm4yoq",className:"vars-provider"},a&&g.a.createElement(bt.a,{centered:!0}),g.a.createElement("div",{id:"navbar-container"}),g.a.createElement("div",{id:"app-container"}),g.a.createElement("div",{id:"footer-container"}))}}]),n}(v.PureComponent)),Dc=n(192),jc=n.n(Dc),_c=(n(622),"https://www.adobe.com/go/"),Lc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={footerVisible:e.controller.isFooterVisible()},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){this.setState({footerVisible:this.props.controller.isFooterVisible()})}},{key:"render",value:function(){var e=this.state.footerVisible,t=this.props.controller;return g.a.createElement("div",{className:"footer-layer",style:e?{bottom:"0px"}:{bottom:"-42px"}},g.a.createElement("div",{"aria-label":Ze("Footer.aria-label","Footer"),className:"footer-content",onClick:function(){return t.toggleFooter()}},g.a.createElement("ul",{className:"footer-left"},g.a.createElement("li",null,g.a.createElement(dl.a,{href:"".concat(_c).concat(Ze("Footer.tou.url","cc-home-legal-terms")),target:"_blank",rel:"noopener noreferrer","aria-label":Ze("Footer.tou.title","Terms of Use")},Ze("Footer.tou.title","Terms of Use"))),g.a.createElement("li",null,g.a.createElement(dl.a,{href:"".concat(_c).concat(Ze("Footer.privacyPolicy.url","cc-home-privacy-center")),target:"_blank",rel:"noopener noreferrer","aria-label":Ze("Footer.privacyPolicy.title","Privacy Policy")},Ze("Footer.privacyPolicy.title","Privacy Policy"))),g.a.createElement("li",null,g.a.createElement(dl.a,{href:"".concat(_c).concat(Ze("Footer.cookies.url","cc-home-privacy-cookies")),target:"_blank",rel:"noopener noreferrer","aria-label":Ze("Footer.cookies.title","Cookies")},Ze("Footer.cookies.title","Cookies"))),g.a.createElement("li",null,g.a.createElement("div",{className:"privacy-notice-link"},g.a.createElement(dl.a,{onClick:function(){return t.onClickCookiePref()},"aria-label":Ze("Footer.cookiePreferences.title","Cookie Preferences")},Ze("Footer.cookiePreferences.title","Cookie Preferences")),g.a.createElement("div",{className:"consent-link-hidden"})))),g.a.createElement("ul",{className:"footer-right"},g.a.createElement("li",{className:"footer-copyright"},"\xa9",Ze("Footer.copyright","2020 Adobe. All Rights Reserved.")),g.a.createElement("li",null,g.a.createElement(xe.a,{variant:"tool",icon:g.a.createElement(jc.a,{size:"S"}),style:{height:"18px",marginLeft:"10px"}})))))}}]),n}(v.PureComponent);window.fedsConfig=window.fedsConfig||{},window.fedsConfig.privacy=window.fedsConfig.privacy||{},window.fedsConfig.privacy.otDomainId="7a5eb705-95ed-4cc4-a11d-0cc5760e93db",window.fedsConfig.privacy.footerLinkSelector=".consent-link-hidden";var Nc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).app=void 0,a.actionsController=void 0,a.footerVisible=!1,a.app=e,a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Lc,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(e){var t;if(Object(h.a)(Object(f.a)(n.prototype),"viewDidMount",this).call(this,e),!O.isLocalhost()){var a=O.loadScript("privacyjs",null!==(t="https://www.adobe.com/etc/beagle/public/globalnav/adobe-privacy/latest/privacy.min.js")?t:"https://www.adobe.com/etc/beagle/public/globalnav/adobe-privacy/latest/privacy.min.js");Promise.all([a]).then((function(){console.debug("Privacy script loaded")})).catch((function(e){console.error(e)}))}}},{key:"viewWillUnmount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewWillUnmount",this).call(this,e)}},{key:"isFooterVisible",value:function(){return this.footerVisible}},{key:"toggleFooter",value:function(){var e;this.footerVisible=!this.footerVisible,null===(e=this.view)||void 0===e||e.refresh()}},{key:"onClickCookiePref",value:function(){window.adobePrivacy&&window.adobePrivacy.showConsentPopup&&window.adobePrivacy.showConsentPopup()}}]),n}(F),Vc=n(193),Fc=n.n(Vc);function Uc(){return(Uc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Bc(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Hc=g.a.createElement("defs",null,g.a.createElement("style",null,".cls-1{fill:#001e36;}.cls-2{fill:#31a8ff;}")),zc=g.a.createElement("title",null,"Asset 131"),Gc=g.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},g.a.createElement("g",{id:"Surfaces"},g.a.createElement("g",{id:"Photo_Surface","data-name":"Photo Surface"},g.a.createElement("g",{id:"Outline_no_shadow","data-name":"Outline no shadow"},g.a.createElement("rect",{className:"cls-1",width:240,height:234,rx:42.5})))),g.a.createElement("g",{id:"Outlined_Mnemonics_Logos","data-name":"Outlined Mnemonics & Logos"},g.a.createElement("g",{id:"PsX"},g.a.createElement("path",{className:"cls-2",d:"M81.01333,71.42888a31.83047,31.83047,0,0,0-12.09216-8.20669q-7.53095-3.055-18.53769-3.05709-4.056,0-8.1824.08064-4.12738.08219-7.82055.16024-3.69317.0822-6.87975.16128-3.18684.0822-5.50292.07961c-.5787,0-.86921.37839-.86921,1.12689V164.09738c0,.85913.337,1.28611,1.01421,1.28611h17.668q1.30342,0,1.3042-1.44739V132.7382q2.60763,0,3.91.08064,1.30343.0822,4.48949.07961a52.47429,52.47429,0,0,0,20.27585-3.78079A30.84641,30.84641,0,0,0,84.272,116.9689q5.35638-8.36487,5.35947-21.24146a41.409,41.409,0,0,0-2.02841-12.95413A32.0492,32.0492,0,0,0,81.01333,71.42888ZM67.11064,106.50842a15.57359,15.57359,0,0,1-7.38633,5.31088,31.01214,31.01214,0,0,1-10.354,1.6097h-4.78q-1.595,0-3.47529-.16128V79.9571a35.26634,35.26634,0,0,1,3.69239-.24088q2.67975-.0791,6.1558-.08064a24.45892,24.45892,0,0,1,10.57188,2.01187,13.9266,13.9266,0,0,1,6.29925,5.712,17.66748,17.66748,0,0,1,2.101,8.85078Q69.93538,102.81035,67.11064,106.50842Z"}),g.a.createElement("path",{className:"cls-2",d:"M136.33511,122.92633a60.58927,60.58927,0,0,0-13.83135-7.32172,58.06366,58.06366,0,0,1-6.37265-3.3,10.10386,10.10386,0,0,1-3.0408-2.65492,4.57229,4.57229,0,0,1-.86921-2.57429,5.48814,5.48814,0,0,1,.72421-2.73556,4.88082,4.88082,0,0,1,2.82473-2.01187,16.98789,16.98789,0,0,1,5.43-.7237,41.41966,41.41966,0,0,1,10.06607,1.28714,28.00184,28.00184,0,0,1,8.10335,3.37966.87006.87006,0,0,0,1.01343,0,1.12223,1.12223,0,0,0,.43525-.96562V89.05329a4.92326,4.92326,0,0,0-.14525-1.20753,1.39068,1.39068,0,0,0-.869-.885,21.38725,21.38725,0,0,0-7.01756-2.33339,63.60354,63.60354,0,0,0-11.15058-.885q-9.55935,0-15.93161,3.5399a23.05024,23.05024,0,0,0-9.41346,9.17231,25.02389,25.02389,0,0,0-3.04184,12.06915A24.24565,24.24565,0,0,0,95.3492,118.7413a23.91723,23.91723,0,0,0,6.80634,8.44862,51.52851,51.52851,0,0,0,12.81818,7.24108q6.65863,2.73867,8.83372,4.66679a5.4648,5.4648,0,0,1,2.17264,4.02271,4.61736,4.61736,0,0,1-2.39026,4.184q-2.38974,1.44842-7.45871,1.44842a41.6417,41.6417,0,0,1-10.57214-1.52906A31.98543,31.98543,0,0,1,95.275,142.31617a.64748.64748,0,0,0-.79658-.08064.9862.9862,0,0,0-.36081.885v17.379a2.12973,2.12973,0,0,0,1.01317,1.93123,29.24629,29.24629,0,0,0,8.32918,3.21838,53.24883,53.24883,0,0,0,12.23742,1.28714q9.70008,0,16.29242-3.21837a23.49634,23.49634,0,0,0,10.06582-8.93039,25.02838,25.02838,0,0,0,3.47606-13.27669,24.1285,24.1285,0,0,0-2.10079-10.29817A22.5497,22.5497,0,0,0,136.33511,122.92633Z"}),g.a.createElement("path",{className:"cls-2",d:"M218.68463,162.66309,193.08585,116.6115,216.9864,73.21162a1.63016,1.63016,0,0,0,.23013-1.63659,1.46389,1.46389,0,0,0-1.46091-.83165H198.78977a2.23891,2.23891,0,0,0-1.46708.37036,2.59759,2.59759,0,0,0-.70374,1.1753c-1.74446,3.77453-3.55056,7.14018-5.368,10.85306q-2.7893,5.69031-5.444,11.30509c-1.58316,3.34612-3.15811,6.79035-4.692,10.25667-1.502-3.42882-3.12831-6.83247-4.844-10.13441-1.98281-3.82282-3.92041-7.64409-5.75733-11.358-1.878-3.79045-3.61324-7.21825-5.22722-11.16281a2.56381,2.56381,0,0,0-2.50471-1.30526H144.51835A1.56111,1.56111,0,0,0,143.19,71.387a1.36123,1.36123,0,0,0,.08116,1.64892l24.179,45.0113-24.80976,44.73862a2.22962,2.22962,0,0,0-.28458,1.43061,1.22031,1.22031,0,0,0,1.25646,1.17941h17.7446a2.47073,2.47073,0,0,0,2.41841-1.66793c1.91706-3.7776,3.793-7.04318,5.57652-10.77147q2.7184-5.6826,5.50255-11.43865c1.63659-3.38,3.265-6.85456,4.84915-10.34553,1.69617,3.50022,3.44474,7.02715,5.20461,10.50015,1.91706,3.7884,3.76528,7.583,5.49536,11.27838,1.726,3.69388,3.45194,6.87007,5.19845,10.6487a3.48086,3.48086,0,0,0,3.31838,1.79635l18.512-.01079a1.60479,1.60479,0,0,0,1.44241-1.1491A2.32834,2.32834,0,0,0,218.68463,162.66309Z"})))),Wc=function(e){var t=e.svgRef,n=e.title,a=Bc(e,["svgRef","title"]);return g.a.createElement("svg",Uc({viewBox:"0 0 240 234",ref:t},a),Hc,void 0===n?zc:n?g.a.createElement("title",null,n):null,Gc)},Zc=g.a.forwardRef((function(e,t){return g.a.createElement(Wc,Uc({svgRef:t},e))})),Yc=(n.p,n(625),n(626),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={theme:K.getParam("theme")||"light"},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.setConfigInWindow();var t=O.loadScript("utilnavjs",("https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.js","https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.js")),n=O.loadCSS("utilnavcss",("https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.css","https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.css"));Promise.all([t,n]).then((function(){e.renderUtilityNav()})).catch((function(e){console.error(e)}))}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"setConfigInWindow",value:function(){var e=this,t=this.props.signedin,n=document.getElementById("utilNavParent");if(n){var a=this.state.theme.toLowerCase().startsWith("light")?"light":"dark",r=Object(S.getAppLocale)("utilitynav",O.getCurrentLanguage(),"en"),i=[{name:"help",attributes:{children:[{type:"LearnMore",title:Ze("GlobalNav.UtilityNav.Help.LearnMore","Learn more")}],callback:function(){e.learnMore(),ie("headerLearnMoreClick",{action:"headerClick"})}}}];t&&i.push({name:"nav-profile",events:{signin:function(){return ie("headerSignInClick",{action:"headerClick"})},signout:function(){return ie("headerSignOutClick",{action:"headerClick"})}}}),window.utilityNavConfig={theme:a,env:"prod",locale:r,target:n,analyticsContext:{consumer:{name:"frictionless-web",version:"0.1.0",platform:"Web",client_id:"ps-frictionless-web"}},children:i}}}},{key:"learnMore",value:function(){var e=O.getLocalizedURL("https://www.adobe.com/creativecloud/photography.html");O.openInNewTab(e)}},{key:"renderUtilityNav",value:function(){window.UtilityNav(window.utilityNavConfig)}},{key:"render",value:function(){var e=this.props.signedin;return g.a.createElement("div",{id:"utilNavParent",className:e?"global-utilnav-signin":"global-utilnav-signout"})}}]),n}(v.PureComponent)),Kc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.loggedIn;return g.a.createElement("div",{className:"navbar-row"},g.a.createElement("div",{className:"navbar-content"},g.a.createElement("div",{"aria-label":"Creative Cloud, link",className:"left-header"},g.a.createElement(xe.a,{quiet:!0,variant:"action",className:"navbar-title-link",onClick:function(){t.home(),ie("headerLogoClick",{action:"headerClick"})}},g.a.createElement("div",{className:"logo"},g.a.createElement(ar,{icon:g.a.createElement(Zc,null)})),g.a.createElement("div",{className:"navbar-title"},g.a.createElement("div",{className:"title"},g.a.createElement("span",null,"Adobe Photoshop Express"))))),g.a.createElement("div",{className:"actions"},g.a.createElement("div",{id:"actions-container"}),g.a.createElement("div",{className:"profile-container"},n?g.a.createElement("div",{className:"utilNavParent-placeholder-signin"},g.a.createElement(Yc,{signedin:!0})):g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:"utilNavParent-placeholder-signout"},g.a.createElement(Yc,{signedin:!1})),g.a.createElement(xe.a,{variant:"cta",icon:g.a.createElement(Fc.a,null),onClick:function(){ie("headerSignInClick",{action:"headerClick"}),t.login()}},Ze("GlobalNav.Button.SignIn","Sign in")))))))}}]),n}(v.PureComponent),Xc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this)).app=void 0,a.actionsController=void 0,a.app=e,a}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Kc,{controller:this,loggedIn:P.getInstance().isSignedInUser()}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewDidMount",this).call(this,e),this.createActionsControllerView()}},{key:"viewWillUnmount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewWillUnmount",this).call(this,e)}},{key:"home",value:function(){this.app.home()}},{key:"login",value:function(){this.app.login()}},{key:"setActionsController",value:function(e){this.actionsController&&this.actionsController.destroyView(),this.actionsController=e,this.createActionsControllerView()}},{key:"createActionsControllerView",value:function(){this.actionsController&&this.view&&this.actionsController.createView(this.ensureHTMLElement("actions-container"))}}]),n}(F),qc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).navbar=void 0,e.footer=void 0,e.doc=void 0,e.navbar=new Xc(Object(d.a)(e)),e.footer=new Nc(Object(d.a)(e)),ie("launch"),e}return Object(u.a)(n,[{key:"createView",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,e),y.a.render(g.a.createElement(Rc,{controller:this,loading:!0}),e)}},{key:"destroyView",value:function(){this.container&&y.a.unmountComponentAtNode(this.container),Object(h.a)(Object(f.a)(n.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var a,r,i,o,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(h.a)(Object(f.a)(n.prototype),"viewDidMount",this).call(this,t),e.prev=1,e.next=4,Promise.all([P.getInstance().load(),We.getInstance().init(),Mc.getInstance().loadTests()]);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:if(null===(a=this.getAppView())||void 0===a||a.setLoading(!1),pt.getInstance().track({"event.workflow":"Home","event.subcategory":"Launch","event.type":"render","event.subtype":"page"}),this.navbar.createView(this.ensureHTMLElement("navbar-container")),this.footer.createView(this.ensureHTMLElement("footer-container")),i=K.getParams(),o=new Et(this),"authorize"!==(null===(r=i.ims)||void 0===r?void 0:r.redirectAPI)){e.next=27;break}return e.prev=16,e.next=19,o.getPreviousDocument();case 19:return l=e.sent,e.next=22,o.restorePreviousDocument(l.sessionDBName);case 22:return e.abrupt("return",Promise.resolve());case 25:e.prev=25,e.t1=e.catch(16);case 27:return e.abrupt("return",o.createView(this.ensureHTMLElement("app-container")));case 28:case"end":return e.stop()}}),e,this,[[1,6],[16,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"viewWillUnmount",value:function(e){Object(h.a)(Object(f.a)(n.prototype),"viewWillUnmount",this).call(this,e)}},{key:"getNavBar",value:function(){return this.navbar}},{key:"getFooter",value:function(){return this.footer}},{key:"createDocument",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a,r,i){var o,l,c,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.doc){e.next=4;break}return e.next=3,this.doc.close();case 3:this.doc.destroyView();case 4:u=null!==(o=null===(l=this.doc)||void 0===l||null===(c=l.getCurrentEditor())||void 0===c?void 0:c.getId())&&void 0!==o?o:null,this.doc||u||(u=this.getInitialEditor()),this.doc=new Tc(this,t,n,n,r,i),this.doc.createView(this.ensureHTMLElement("app-container")),this.doc.setEditor(u),i&&this.doc.getDocActions().update(),this.doc.evalDeeplinkActions();case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r,i){return e.apply(this,arguments)}}()},{key:"home",value:function(){var e;null===(e=this.doc)||void 0===e||e.setEditor(null)}},{key:"login",value:function(){this.doc?this.doc.showLogin():P.getInstance().loginUser()}},{key:"hasDoc",value:function(){return void 0!==this.doc}},{key:"getInitialEditor",value:function(){var e,t=K.getParams();return(null===(e=t.ims)||void 0===e?void 0:e.lastEditor)?t.ims.lastEditor:K.getParams().editor||null}},{key:"getAppView",value:function(){return this.view}}]),n}(F),Jc=n(194),Qc=n.n(Jc),$c=n(92),eu=n.n($c),tu=(n(633),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n),a=t.call(this,e);var r=K.getParam("theme")||"light",i=K.getParam("scale")||"medium";return a.state={theme:r,scale:i},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),se("unsupportedBrowser")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),ce("unsupportedBrowser")}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.theme,n=e.scale;return g.a.createElement(Ac.a,{theme:t,scale:n,typekitId:"glm4yoq",className:"vars-provider unsupported-browser"},g.a.createElement("div",null,g.a.createElement(eu.a,{className:"browser-message",heading:Ze("UnsupportedBrowserApp.Recommendation.Header","The browser you are using is not supported."),description:Ze("UnsupportedBrowserApp.Recommendation.Description","You can still access the tool by downloading the latest version of any of the following browsers:"),illustration:g.a.createElement(Qc.a,{size:"XXL"})}),g.a.createElement(ss.Grid,{variant:"fixed"},g.a.createElement(ss.GridRow,{align:"center"},g.a.createElement(ss.GridColumn,{className:"browser-column chrome",size:2},g.a.createElement(dl.a,{className:"browser-link",key:"chrome",href:"https://www.google.com/chrome/browser/desktop/index.html",target:"_blank",rel:"noopener noreferrer","aria-label":Ze("UnsupportedBrowserApp.Recommendation.LinkText.Aria.Chrome","Chrome Browser Home")},Ze("UnsupportedBrowserApp.Recommendation.LinkText.Chrome","Chrome"))),g.a.createElement(ss.GridColumn,{className:"browser-column safari",size:2},g.a.createElement(dl.a,{className:"browser-link",key:"safari",href:"https://support.apple.com/downloads/safari",target:"_blank",rel:"noopener noreferrer","aria-label":Ze("UnsupportedBrowserApp.Recommendation.LinkText.Aria.Safari","Safari Browser Home")},Ze("UnsupportedBrowserApp.Recommendation.LinkText.Safari","Safari"))),g.a.createElement(ss.GridColumn,{className:"browser-column firefox",size:2},g.a.createElement(dl.a,{className:"browser-link",key:"firefox",href:"https://www.mozilla.org/firefox",target:"_blank",rel:"noopener noreferrer","aria-label":Ze("UnsupportedBrowserApp.Recommendation.LinkText.Aria.Firefox","Firefox Browser Home")},Ze("UnsupportedBrowserApp.Recommendation.LinkText.Firefox","Firefox"))),g.a.createElement(ss.GridColumn,{className:"browser-column edge",size:2},g.a.createElement(dl.a,{className:"browser-link",key:"edge",href:"https://www.microsoft.com/windows/microsoft-edge",target:"_blank",rel:"noopener noreferrer","aria-label":Ze("UnsupportedBrowserApp.Recommendation.LinkText.Aria.Edge","Edge Browser Home")},Ze("UnsupportedBrowserApp.Recommendation.LinkText.Edge","Edge")))))))}}]),n}(v.PureComponent)),nu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"createView",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,t),e.prev=1,e.next=4,We.getInstance().init();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:y.a.render(g.a.createElement(tu,{controller:this}),t);case 10:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"isUnSupportedBrowser",value:function(){var e=new i.UAParser;return void 0!==n.UNSUPPORTED_BROWSERS.find((function(t){return e.getBrowser().name===t.name&&(void 0===t.maxVersion||parseInt(e.getBrowser().version||"999",10)<=t.maxVersion)}))}}]),n}(F);function au(){return(au=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ru(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}nu.UNSUPPORTED_BROWSERS=[{name:"IE"},{name:"Edge",maxVersion:18}];var iu=g.a.createElement("circle",{className:"path circle",fill:"none",stroke:"#44b556",strokeWidth:8,strokeMiterlimit:10,cx:65,cy:65,r:60,transform:"rotate(-40 65 65)"}),ou=g.a.createElement("polyline",{className:"path check",fill:"none",stroke:"#44b556",strokeWidth:8,strokeLinecap:"round",strokeMiterlimit:10,points:"100,40 51,88 29,67 "}),su=function(e){var t=e.svgRef,n=e.title,a=ru(e,["svgRef","title"]);return g.a.createElement("svg",au({width:64,height:64,viewBox:"0 0 130 130",className:"CheckMarkIcon__icon___3BHDg",ref:t},a),n?g.a.createElement("title",null,n):null,iu,ou)},lu=g.a.forwardRef((function(e,t){return g.a.createElement(su,au({svgRef:t},e))}));n.p;function cu(){return(cu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function uu(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var du,hu=g.a.createElement("g",{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:10,strokeWidth:"3px"},g.a.createElement("path",{d:"M110.53,85.66,100.26,95.89a1.09,1.09,0,0,1-1.52,0L88.47,85.66"}),g.a.createElement("line",{x1:99.5,y1:95.5,x2:99.5,y2:58.5}),g.a.createElement("path",{d:"M105.5,73.5h19a2,2,0,0,0,2-2v-43"}),g.a.createElement("path",{d:"M126.5,22.5h-19a2,2,0,0,1-2-2V1.5h-31a2,2,0,0,0-2,2v68a2,2,0,0,0,2,2h19"}),g.a.createElement("line",{x1:105.5,y1:1.5,x2:126.5,y2:22.5}),g.a.createElement("path",{d:"M139.5,36.5H196A1.49,1.49,0,0,1,197.5,38V72A1.49,1.49,0,0,1,196,73.5H141A1.49,1.49,0,0,1,139.5,72V32A1.49,1.49,0,0,1,141,30.5H154a2.43,2.43,0,0,1,1.67.66l6,5.66"}),g.a.createElement("rect",{x:1.5,y:34.5,width:58,height:39,rx:2,ry:2}),g.a.createElement("path",{strokeWidth:"2px",d:"M47.93,50.49a5,5,0,1,0-4.83-5A4.93,4.93,0,0,0,47.93,50.49Z"}),g.a.createElement("path",{strokeWidth:"2px",d:"M36.6,65.93,42.05,60A2.06,2.06,0,0,1,45,60l12.68,13.2"}),g.a.createElement("path",{strokeWidth:"2px",d:"M3.14,73.23,22.42,53.76a1.65,1.65,0,0,1,2.38,0l19.05,19.7"})),fu=function(e){var t=e.svgRef,n=e.title,a=uu(e,["svgRef","title"]);return g.a.createElement("svg",cu({viewBox:"0 0 199 97.7",height:110,className:"spectrum-IllustratedMessage-illustration","aria-hidden":"true",ref:t},a),n?g.a.createElement("title",null,n):null,hu)},pu=g.a.forwardRef((function(e,t){return g.a.createElement(fu,cu({svgRef:t},e))})),mu=(n.p,n(634),function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n),(a=t.call(this,e)).inputFileRef=void 0,a.imgRef=Object(v.createRef)(),a.handleFileInputChange=function(e){var t=a.props.controller,n=e.target.files;if(n&&n[0]){if(!Et.isAllowedMimetype(n[0].type))return Object(E.error)(Ze("Importer.DragAndDrop.ErrorToast.Message","Sorry - this file type is currently not supported."),{timeout:5e3}),void ie("converter:imageUploadFailed",{action:"fileInput",error:"incorrectFileFormat",doc:{mimeType:n[0].type}});a.setState({loading:!0}),t.readFile(n[0])}},a.onDrop=function(e){var t=a.props,n=t.controller,r=t.sourceFormat;if(e.dataTransfer){var i=e.dataTransfer.files.item(0);if(i)return Et.isAllowedMimetype(i.type)?void(i.type===r&&(a.setState({loading:!0}),n.readFile(i),ie("converter:imageUploadSuccess",{action:"dragDrop",doc:{action:"store",mimeType:i.type,id:V()()}}))):(Object(E.error)(Ze("Importer.DragAndDrop.ErrorToast.Message","Sorry - this file type is currently not supported."),{timeout:5e3}),void ie("converter:imageUploadFailed",{action:"dragDrop",error:"incorrectFileFormat",doc:{mimeType:i.type}}))}},a.onFileInputClick=function(){ie("chooseFile"),null!==a.inputFileRef.current&&a.inputFileRef.current.click()};var r=K.getParam("theme")||"light",i=K.getParam("scale")||"medium";return a.state={theme:r,scale:i,mode:du.init,loading:!1},a.inputFileRef=g.a.createRef(),a}return Object(u.a)(n,[{key:"refresh",value:function(){}},{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),se("getConverterApp")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),ce("getConverterApp")}},{key:"setParams",value:function(e,t){this.setState({loading:e}),t&&this.setState({mode:t})}},{key:"getImporterTitleText",value:function(){var e=this.props,t=e.sourceFormat,n=e.targetFormat;return t===a.JPG&&n===r.PNG?Ze("Converter.Title.Jpeg2Png","Convert JPEG to PNG"):t===a.SVG&&n===r.PNG?Ze("Converter.Title.Svg2Png","Convert SVG to PNG"):t===a.PNG&&n===r.JPG?Ze("Converter.Title.Png2Jpeg","Convert PNG to JPEG"):t===a.SVG&&n===r.JPG?Ze("Converter.Title.Svg2Jpeg","Convert SVG to JPEG"):n===r.JPG?Ze("Converter.Title.Files2Jpeg","Convert image to JPEG"):Ze("Converter.Title.Files2Png","Convert image to PNG")}},{key:"getImporterSubtitleText",value:function(){var e=this.props,t=e.sourceFormat,n=e.targetFormat;return t===a.JPG&&n===r.PNG?Ze("Converter.Subtitle.Jpeg2Png","Drag and drop a JPEG image (JPEG or JPG) to convert to PNG, or select an image to upload below."):t===a.SVG&&n===r.PNG?Ze("Converter.Subtitle.Svg2Png","Drag and drop an SVG image to convert to PNG, or select an image to upload below."):t===a.PNG&&n===r.JPG?Ze("Converter.Subtitle.Png2Jpeg","Drag and drop a PNG image to convert to JPG, or select an image to upload below."):t===a.SVG&&n===r.JPG?Ze("Converter.Subtitle.Svg2Jpeg","Drag and drop an SVG image to convert to JPG, or select an image to upload below."):n===r.JPG?Ze("Converter.Subtitle.Files2Jpeg","Drag and drop an image to convert to JPG, or select an image to upload below."):Ze("Converter.Subtitle.Files2Png","Drag and drop an image to convert to PNG, or select an image to upload below.")}},{key:"getDownloaderTitleText",value:function(){return this.props.targetFormat===r.PNG?Ze("Converter.Download.Title.PNG","Your PNG is ready"):Ze("Converter.Download.Title.JPEG","Your JPEG is ready")}},{key:"getAcceptedFileExt",value:function(e){switch(e){case a.JPG:return".jpg,.jpeg";case a.PNG:return".png";case a.SVG:return".svg";default:return".jpg,.jpeg,.png,.svg"}}},{key:"loadImageData",value:function(e){var t=M.resizeImageDataToWidth(e,400);if(t){var n=document.createElement("canvas");n.width=t.width,n.height=t.height;var a=n.getContext("2d");if(a){a.putImageData(t,0,0);var r=n.toDataURL();this.imgRef&&this.imgRef.current&&(this.imgRef.current.style.backgroundImage="url(".concat(r,")"))}}}},{key:"renderUpload",value:function(){var e=this,t=this.props.sourceFormat,n=this.state.loading;return g.a.createElement(g.a.Fragment,null,g.a.createElement(vt.a,{onDrop:this.onDrop,className:"drop-zone"},g.a.createElement(eu.a,{heading:this.getImporterTitleText(),description:this.getImporterSubtitleText(),illustration:g.a.createElement(pu,null)}),g.a.createElement(xe.a,{variant:"cta",onClick:function(){e.onFileInputClick(),ie("converter:selectfile")},className:"button-selectfile",disabled:n},Ze("Converter.Button.SelectFile","Select a file")),g.a.createElement("input",{type:"file",id:"file-upload",accept:this.getAcceptedFileExt(t),ref:this.inputFileRef,onChange:this.handleFileInputChange,style:{display:"none"}})),n&&g.a.createElement(bt.a,{centered:!0}))}},{key:"renderDownload",value:function(){var e=this,t=this.props.controller,n=this.state,a=n.mode,r=n.loading;return g.a.createElement("div",{className:"download-containter"},g.a.createElement("div",{className:"left",ref:this.imgRef}),g.a.createElement("div",{className:"right"},g.a.createElement(lu,null),g.a.createElement("h1",null,this.getDownloaderTitleText()),g.a.createElement("section",null,g.a.createElement("div",{className:"action-buttons"},a===du.uploaded?g.a.createElement(xe.a,{disabled:r,onClick:function(){ie("converter:downloadimage"),t.download()},variant:"cta"},Ze("Converter.Button.Download","Download")):g.a.createElement(g.a.Fragment,null,g.a.createElement(xe.a,{onClick:function(){ie("converter:convertagain"),e.setState({mode:du.init})},variant:"cta"},Ze("Converter.Button.ConvertAgain","Convert again"))))),r&&g.a.createElement(bt.a,{className:"wait-download"})))}},{key:"render",value:function(){var e=this.state,t=e.theme,n=e.scale,a=e.mode;return g.a.createElement(Ac.a,{theme:t,scale:n,typekitId:"glm4yoq",className:"vars-provider"},g.a.createElement("div",{className:"converter-container"},a===du.init&&this.renderUpload(),a!==du.init&&this.renderDownload()))}}]),n}(v.PureComponent));!function(e){e[e.init=0]="init",e[e.uploaded=1]="uploaded",e[e.downloaded=2]="downloaded"}(du||(du={}));var vu,gu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,a;Object(c.a)(this,n),(a=t.call(this)).imageData=void 0,a.fileName=void 0,a.outputFormat=void 0;var i=K.getParams();return a.outputFormat=(null===(e=i.globalAction)||void 0===e?void 0:e.targetFormat)||r.JPG,a}return Object(u.a)(n,[{key:"createView",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,t),e.prev=1,e.next=4,We.getInstance().init();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:r=K.getParams(),y.a.render(g.a.createElement(mu,{controller:this,sourceFormat:null===(a=r.globalAction)||void 0===a?void 0:a.sourceFormat,targetFormat:this.outputFormat}),t);case 11:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(e,t){this.view.setParams(e,t)}},{key:"readFile",value:function(e){var t=this;Et.loadData(e,e.name,{onSuccess:function(e,n){t.imageData=e,t.fileName=n,t.update(!1,du.uploaded),t.view.loadImageData(e)},onEmptyData:function(){t.update(!1)},onError:function(){t.update(!1)}})}},{key:"download",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.imageData&&this.fileName&&this.outputFormat){e.next=2;break}return e.abrupt("return");case 2:return this.update(!0),e.next=5,R.downloadImageData(this.imageData,this.fileName,this.outputFormat,t);case 5:this.update(!1,du.downloaded);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(F);n(635);vu||(vu=!0,n(636)),window.NREUM,n(637);var bu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n),a=t.call(this,e);var r=K.getParam("theme")||"light",i=K.getParam("scale")||"medium";return a.state={theme:r,scale:i},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),se("getMobileApp")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),ce("getMobileApp")}},{key:"refresh",value:function(){}},{key:"getPSX",value:function(){ie("getPhotoshopExpress"),window.location.href="https://photoshopexpress.app.link/63TYhKmVL4"}},{key:"render",value:function(){var e=this,t=this.state,n=t.theme,a=t.scale;return g.a.createElement(Ac.a,{theme:n,scale:a,typekitId:"glm4yoq",className:"vars-provider"},g.a.createElement("div",{className:"landingpage-content"},g.a.createElement("div",{className:"teaser-text"},Ze("Mobile.Landingpage.Teasertext1","This web app is only available on desktops. But our free Adobe Photoshop Express mobile app offers an easy way to retouch your photos and edit them in fun ways \u2015 right from your smartphone or tablet.")),g.a.createElement(xe.a,{variant:"cta",onClick:function(){e.getPSX()}},Ze("Mobile.Landingpage.Button","Get Photoshop Express")),g.a.createElement("div",{className:"teaser-image"},g.a.createElement("img",{src:"/assets/photoshop_express_teaser.jpg",alt:"Photoshop Express"})),g.a.createElement("div",{className:"teaser-text"},Ze("Mobile.Landingpage.Teasertext2","Photoshop Express makes it easy to edit, get creative, and share photos so they stand out on social and everywhere else."))))}}]),n}(v.PureComponent),yu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"createView",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(h.a)(Object(f.a)(n.prototype),"createView",this).call(this,t),e.prev=1,e.next=4,We.getInstance().init();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:y.a.render(g.a.createElement(bu,{controller:this}),t);case 10:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(F),Eu=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function wu(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(console.debug("Service worker state changes to ".concat(n.state)),navigator.serviceWorker.controller?(Eu&&window.confirm("There is a newer version of the App available. Reload?")&&window.location.reload(),t&&t.onUpdate&&t.onUpdate(e)):t&&t.onSuccess&&t.onSuccess(e))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(638),n(639),n(640);var xu,ku,Su=document.getElementById("root");if(!Su)throw new Error("missing element root");K.parseParams();var Cu=K.getParams(),Ou=(new i.UAParser).getDevice(),Pu=!1;if(void 0!==Ou.type&&"tablet"!==Ou.type)(new yu).createView(Su);else if((null===(xu=Cu.globalAction)||void 0===xu?void 0:xu.isEmbed)&&"convert"===(null===(ku=Cu.globalAction)||void 0===ku?void 0:ku.action)){(new gu).createView(Su)}else if(nu.isUnSupportedBrowser()){(new nu).createView(Su)}else{(new qc).createView(Su),Pu=!0}Pu?function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Eu?("storage"in navigator&&"estimate"in navigator.storage&&navigator.storage.estimate().then((function(e){var t=e.usage,n=e.quota;if(t&&n){var a=Math.round(t/n*100),r=Math.round(t/1048576),i=Math.round(n/1048576);console.debug("".concat(r," out of ").concat(i," MiB used (").concat(a,"%)"))}})),function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||!Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_STORAGE_API_URL:"https://cc-api-storage-creativesdk.adobe.io",REACT_APP_PM_WASM_HASH:"a888ee0586ced614e2b443c111d9b1882cb0c3061b15b473ec822c76ad6f47c8",REACT_APP_IMS_ENV:"prod",REACT_APP_RUNNING_ENV:"production",REACT_APP_NAME:"frictionless-web",REACT_APP_PRIVACY_OTDOMAINID:"7a5eb705-95ed-4cc4-a11d-0cc5760e93db",REACT_APP_IMS_API_KEY:"ps-frictionless-web",REACT_APP_UTILITYNAV_CSS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.css",REACT_APP_UTILITYNAV_JS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.js",REACT_APP_USERTESTS:"agedashi:app:available_editors",REACT_APP_BUILD_SHA:"a095f6519961",REACT_APP_IMAGE_API_KEY:"FrictionlessPSWebApp1",REACT_APP_TARGET_CLIENT:"adobeinternalmobiles",REACT_APP_IMS_LIB_URL:"https://static.adobelogin.com/imslib/imslib.min.js",REACT_APP_CROP_FLIP_AXIS_REFERENCE:"cropbox",REACT_APP_BUILD_TIME:"Thu Oct 15 16:10:37 UTC 2020",REACT_APP_IMS_API_URL:"https://ims-na1.adobelogin.com",REACT_APP_AVAILABLE_EDITORS:"spotheal,crop,resize,adjust,cutout,effects",REACT_APP_CC_LEARN_MORE:"https://www.adobe.com/creativecloud/photography.html",REACT_APP_GLOBAL_TESTING_PROPERTY_TOKEN:"2bb70f5a-cc1f-79c3-a659-66e4e32dc3fc",REACT_APP_GLOBAL_TESTING_MBOXES:"agedashi:app:adjustments",REACT_APP_DUNAMIS_PROJECT:"ps-web-service",REACT_APP_IMAGE_API_URL:"https://image.adobe.io",REACT_APP_ANONYMOUS_USER_DOWNLOADS_EACH_MS:"31536000000",REACT_APP_ANONYMOUS_USER_DOWNLOADS:"1",REACT_APP_WHITELISTED_LANGUAGES:"cs,da,de,en,es,fi,fr,it,ja,ko,nb,nl,pl,pt,ru,sv,tr,zh_CN,zh_TW,zh_cn,zh_tw",REACT_APP_CROP_ROTATE_PIVOT:"cropcenter",REACT_APP_FREE_USER_DOWNLOADS_EACH_MS:"86400000",REACT_APP_DUNAMIS_ENV:"prod",REACT_APP_FREE_USER_DOWNLOADS:"1",REACT_APP_DUNAMIS_API_KEY:"ps-web-service",REACT_APP_PRIVACY_JS_URL:"https://www.adobe.com/etc/beagle/public/globalnav/adobe-privacy/latest/privacy.min.js",REACT_APP_CROP_ROTATE_WITH_CROPBOX:"true",REACT_APP_NEWRELIC_AGENT_FILE:"agedashi-prod",REACT_APP_VERSION:"0.1.0",REACT_APP_STORAGE_API_KEY:"FrictionlessPSWebApp1",REACT_APP_ADOBE_BASE_GOURL:"https://www.adobe.com/go/",REACT_APP_GLOBAL_TRACKING_ENV:"production",REACT_APP_CROP_RATIOCHANGE_REFERENCE:"cropbox",REACT_APP_DUNAMIS_API_URL:"https://cc-api-data.adobe.io"}).REACT_APP_DEBUG_SW||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){t&&t.onUnregister&&t.onUnregister(),window.location.reload()}))})):wu(e,t)})).catch((function(){console.debug("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.debug("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):wu(t,e)}))}}({onSuccess:function(){console.debug("Content is cached for offline use")},onUpdate:function(){console.debug("New content is available and cached")},onUnregister:function(){console.debug("Service Worker un-registred")}}):(console.debug("unregister SW"),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})))},74:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,i,o=j(n(32)),s=j(n(13)),l=n(46),c=j(n(550)),u=j(n(551)),d=n(83),h=j(n(15)),f=j(n(31)),p=j(n(35)),m=j(n(25)),v=j(n(552)),g=j(n(557)),b=n(54),y=j(n(14)),E=function(e){if(e&&e.__esModule)return e;var t=C();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r]}}n.default=e,t&&t.set(e,n);return n}(n(0)),w=j(n(12)),x=j(n(118)),k=0,S=null;function C(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return C=function(){return e},e}function O(e){return(O="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function T(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function M(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function I(e,t){return!t||"object"!==O(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){return e&&e.__esModule?e:{default:e}}var _={"cs-CZ":j(n(560)).default,"da-DK":j(n(561)).default,"de-DE":j(n(562)).default,"en-US":j(n(563)).default,"es-ES":j(n(564)).default,"fi-FI":j(n(565)).default,"fr-FR":j(n(566)).default,"hu-HU":j(n(567)).default,"it-IT":j(n(568)).default,"ja-JP":j(n(569)).default,"ko-KR":j(n(570)).default,"nb-NO":j(n(571)).default,"nl-NL":j(n(572)).default,"pl-PL":j(n(573)).default,"pt-BR":j(n(574)).default,"ru-RU":j(n(575)).default,"sv-SE":j(n(576)).default,"tr-TR":j(n(577)).default,"uk-UA":j(n(578)).default,"zh-Hans-CN":j(n(579)).default,"zh-Hant-TW":j(n(580)).default};n(581),n(582),n(583);var L=(0,f.default)(a=(0,o.default)((i=r=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=I(this,A(t).call(this,e));var a=e.id,r=e.value,i=e.defaultValue;return n.state={focused:!1,valueInvalid:!1,inputId:a||(0,p.default)(),value:n.getValue(r,i)},n}var n,a,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.textfield&&w.default.findDOMNode(this.textfield).addEventListener("wheel",this.handleInputScrollWheel,{passive:!1,bubbles:!1,cancelable:!0})}},{key:"componentWillUnmount",value:function(){this.textfield&&w.default.findDOMNode(this.textfield).removeEventListener("wheel",this.handleInputScrollWheel)}},{key:"getValue",value:function(e,t){return e||0===e?e:t||0===t?t:""}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){"value"in e&&this.setState({value:this.getValue(e.value),valueInvalid:this.isInputValueInvalid(e.value)}),"defaultValue"in e&&this.setState({valueInvalid:this.isInputValueInvalid(e.defaultValue)})}},{key:"onMouseDown",value:function(e){e.preventDefault(),!this.flagTouchStart&&this.textfield.focus()}},{key:"onTouchStart",value:function(){this.flagTouchStart=!0}},{key:"handleDecrementButtonClick",value:function(e){e.preventDefault(),this.decrementValue()}},{key:"handleIncrementButtonClick",value:function(e){e.preventDefault(),this.incrementValue()}},{key:"startCheckForIncrement",value:function(e){e.preventDefault(),0===k&&(k=Date.now()),this.runIncrement(100)}},{key:"runIncrement",value:function(e){var t=this,n=this.props,a=n.min,r=n.max,i=(n.step,this.state.value);Number.isInteger(i)&&i>=a&&i<r&&0!==k?(Date.now()>k+500&&this.incrementValue(),e=Math.max(5,e-2),setTimeout((function(){t.runIncrement(e)}),e)):(0,this.props.onProgrammaticChangeStop)()}},{key:"stopCheckForIncrement",value:function(e){e.preventDefault(),k=0}},{key:"startCheckForDecrement",value:function(e){e.preventDefault(),0===k&&(k=Date.now()),this.runDecrement(100)}},{key:"runDecrement",value:function(e){var t=this,n=this.props,a=n.min,r=n.max,i=(n.step,this.state.value),o=this.props.onProgrammaticChangeStop;Number.isInteger(i)&&i>a&&i<=r&&0!==k?(Date.now()>k+500&&this.decrementValue(),e=Math.max(5,e-2),setTimeout((function(){t.runDecrement(e)}),e)):o()}},{key:"stopCheckForDecrement",value:function(e){e.preventDefault(),k=0}},{key:"handleTextfieldFocus",value:function(){w.default.findDOMNode(this.textfield).select(),this.setState({focused:!0})}},{key:"handleFocus",value:function(){this.setState({focused:!0})}},{key:"handleBlur",value:function(){this.flagTouchStart=!1,this.setState({focused:!1}),g.default.clearMessage()}},{key:"handleInputKeyDown",value:function(e){switch(e.keyCode){case 13:e.preventDefault(),this.evalValue();break;case 38:case 33:e.preventDefault(),this.incrementValue();break;case 40:case 34:e.preventDefault(),this.decrementValue();break;case 35:e.preventDefault(),this.decrementToMinValue();break;case 36:e.preventDefault(),this.incrementToMaxValue()}}},{key:"handleInputKeyUp",value:function(e){var t=this.props.onProgrammaticChangeStop;switch(e.keyCode){case 38:case 33:e.preventDefault();case 40:case 34:e.preventDefault();case 35:e.preventDefault();case 36:e.preventDefault(),t()}}},{key:"handleInputScrollWheel",value:function(e){var t=this.props.onProgrammaticChangeStop;e.preventDefault(),this.isInactive()||(e.deltaY<0?this.incrementValue():this.decrementValue(),clearTimeout(S),S=setTimeout((function(){S=void 0,t()}),500))}},{key:"handleInputChange",value:function(e,t){t.stopPropagation();var n=""===e?null:+e,a=Number.isInteger(n),r=this.props.max;(a&&n<=r||""===e)&&this.setState({value:e})}},{key:"isInactive",value:function(){var e=this.props,t=e.disabled,n=e.readOnly,a=this.state.focused;return t||n||!a}},{key:"incrementValue",value:function(){var e=this.props,t=e.min,n=e.max,a=e.step,r=this.state.value;isNaN(a)&&(a=1);var i=+r;i=isNaN(i)?null!=n?Math.min(a,n):a:(0,d.clamp)((0,d.handleDecimalOperation)("+",i,a),t,n),this.triggerChange(i)}},{key:"incrementToMaxValue",value:function(){var e=this.props.max;this.isInactive()||null!=e&&this.triggerChange(e)}},{key:"decrementValue",value:function(){var e=this.props,t=e.min,n=e.max,a=e.step,r=this.state.value;isNaN(a)&&(a=1);var i=+r;i=isNaN(i)?null!=t?Math.max(-a,t):-a:(0,d.clamp)((0,d.handleDecimalOperation)("-",i,a),t,n),this.triggerChange(i)}},{key:"decrementToMinValue",value:function(){var e=this.props.min;this.isInactive()||null!=e&&this.triggerChange(e)}},{key:"triggerChange",value:function(e){var t=this.props.onChange,n=this.props.min,a=this.props.onProgrammaticChange,r=this.state.value;""===r&&(r=n),r!==e&&(g.default.announceAssertive(e.toString()),this.setState({value:e,valueInvalid:this.isInputValueInvalid(e)}),t(e),a(e))}},{key:"evalValue",value:function(){var e=this.state.value,t=this.props.onChange,n=""===e?null:+e;Number.isInteger(n)&&n>0&&t(n)}},{key:"isInputValueInvalid",value:function(e){var t=this.props,n=t.max,a=t.min;return""!==e&&isNaN(+e)||null!==n&&e>n||null!==a&&e<a}},{key:"render",value:function(){var e=this,t=this.props.locale;b.setLocale(t);var n=(0,b.messageFormatter)(_),a=this.props,r=a.defaultValue,i=a.placeholder,o=void 0===i?n("Enter a number"):i,d=a.min,f=a.max,p=a.minStepper,g=a.maxStepper,y=a.step,w=a.decrementTitle,k=void 0===w?n("Decrement"):w,S=a.incrementTitle,C=void 0===S?n("Increment"):S,O=a.invalid,M=a.disabled,I=a.quiet,A=a.className,R=a.readOnly,D=a["aria-label"],j=a["aria-labelledby"],L=T(a,["defaultValue","placeholder","min","max","step","decrementTitle","incrementTitle","invalid","disabled","quiet","className","readOnly","aria-label","aria-labelledby"]),N=this.state,V=N.focused,F=N.value,U=N.valueInvalid,B=N.inputId;return E.default.createElement(v.default,{focused:V,invalid:O,quiet:I,disabled:M,className:(0,h.default)("spectrum-Stepper","react-spectrum-Stepper",{"spectrum-Stepper--quiet":I},A),role:"group","aria-label":D||null,"aria-labelledby":j||null},E.default.createElement(x.default,P({},(0,m.default)(L),{ref:function(t){return e.textfield=t},className:"spectrum-Stepper-input",id:B,value:F,defaultValue:r,type:"number",autoComplete:"off","aria-label":D||null,"aria-labelledby":j||null,"aria-valuenow":F||null,"aria-valuetext":F||null,"aria-valuemin":d,"aria-valuemax":f,style:{textAlign:"right",paddingRight:"23px"},validationState:O||U?"invalid":null,step:y,placeholder:o,locale:t,disabled:M,readOnly:R,quiet:I,onKeyDown:(0,l.chain)(L.onKeyDown,this.handleInputKeyDown),onKeyUp:(0,l.chain)(L.onKeyUp,this.handleInputKeyUp),onFocus:(0,l.chain)(L.onFocus,this.handleTextfieldFocus),onBlur:(0,l.chain)(L.onBlur,this.handleBlur),onChange:this.handleInputChange})),E.default.createElement("span",{className:"spectrum-Stepper-buttons",role:"presentation",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchStart:this.onTouchStart},E.default.createElement(s.default,{className:"spectrum-Stepper-stepUp",type:"button",tabIndex:"-1","aria-controls":B,variant:"action",quiet:I,title:C,"aria-label":C,disabled:M||null!=g&&F>=g||R,onClick:this.handleIncrementButtonClick,onMouseDown:this.startCheckForIncrement,onMouseUp:this.stopCheckForIncrement,onMouseOut:this.stopCheckForIncrement,onFocus:this.handleFocus,onBlur:this.handleBlur},E.default.createElement(u.default,{size:null,className:"spectrum-Stepper-stepUpIcon"})),E.default.createElement(s.default,{className:"spectrum-Stepper-stepDown",type:"button",tabIndex:"-1","aria-controls":B,variant:"action",quiet:I,title:k,"aria-label":k,disabled:M||null!=p&&F<=p||R,onClick:this.handleDecrementButtonClick,onMouseDown:this.startCheckForDecrement,onMouseUp:this.stopCheckForDecrement,onMouseOut:this.stopCheckForDecrement,onFocus:this.handleFocus,onBlur:this.handleBlur},E.default.createElement(c.default,{size:null,className:"spectrum-Stepper-stepDownIcon"}))))}}])&&M(n.prototype,a),r&&M(n,r),t}(E.Component),D(r,"propTypes",{defaultValue:y.default.oneOfType([y.default.string,y.default.number]),value:y.default.oneOfType([y.default.string,y.default.number]),min:y.default.number,max:y.default.number,minStepper:y.default.number,maxStepper:y.default.number,placeholder:y.default.string,locale:y.default.string,step:y.default.oneOfType([y.default.number,y.default.oneOf(["any"])]),disabled:y.default.bool,invalid:y.default.bool,readOnly:y.default.bool,decrementTitle:y.default.string,incrementTitle:y.default.string,onChange:y.default.func,onProgrammaticChange:y.default.func,onProgrammaticChangeStop:y.default.func,quiet:y.default.bool}),D(r,"defaultProps",{placeholder:"",step:1,disabled:!1,invalid:!1,readOnly:!1,locale:"en-US",onChange:function(){},onProgrammaticChange:function(){},onProgrammaticChangeStop:function(){}}),a=i))||a)||a;t.default=L}},[[203,1,2]]]);
//# sourceMappingURL=main.2ea40211.chunk.js.map